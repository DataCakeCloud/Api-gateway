(window["webpackJsonp_datastudio-web"]=window["webpackJsonp_datastudio-web"]||[]).push([["chunk-b6251484"],{"01f5":function(t,e,n){"use strict";n("1556")},"0e59":function(t,e,n){"use strict";n("5f99")},"0feb":function(t,e,n){},"111c":function(t,e,n){"use strict";n("9710")},1556:function(t,e,n){},"17bc":function(t,e,n){},"19a1":function(t,e,n){},"1c2f":function(t,e,n){},"1dbd":function(t,e,n){"use strict";n("a3f9")},"2c1e":function(t,e,n){"use strict";n.r(e);var a,r,i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-card",{staticClass:"task-detail box-card-container"},[n("el-page-header",{staticClass:"header bg-white",on:{back:t.goBack}},[n("el-link",{staticClass:"header-name",attrs:{slot:"content",type:"primary",underline:!1,disabled:!t.templateCode},on:{click:t.edit},slot:"content"},[t._v(t._s(t.name))])],1),t._v(" "),n("el-tabs",{staticClass:"mt10 eltabs",attrs:{type:"card"},model:{value:t.tabItem,callback:function(e){t.tabItem=e},expression:"tabItem"}},[n("el-tab-pane",{attrs:{name:"instance",label:"实例信息"}},[n("div",{staticClass:"search-condition-wrap"},[n("search-condition",{attrs:{label:"运行状态"}},[n("el-select",{staticClass:"search-box",attrs:{placeholder:"请选择运行状态",clearable:""},model:{value:t.params.state,callback:function(e){t.$set(t.params,"state",e)},expression:"params.state"}},t._l(t.statusCodeList,(function(t,e){return n("el-option",{key:e,attrs:{label:t,value:e}})})),1)],1),t._v(" "),n("search-condition",{attrs:{label:"执行入参时间"}},[n("el-date-picker",{staticClass:"search-box",staticStyle:{width:"350px"},attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"]},on:{change:t.changeTime},model:{value:t.timeRange,callback:function(e){t.timeRange=e},expression:"timeRange"}})],1),t._v(" "),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.search}},[t._v("查询")]),t._v(" "),n("div",{staticClass:"right-btn"},[n("el-button",{attrs:{type:"primary",size:"small",disabled:!((t.isAdmin||t.isOwner)&&t.isOnline)},on:{click:t.batchClear}},[t._v("批量重算")]),t._v(" "),n("el-button",{attrs:{type:"danger",size:"small",disabled:!((t.isAdmin||t.isOwner)&&t.isOnline)},on:{click:t.batchStop}},[t._v("批量停止")])],1)],1),t._v(" "),n("div",{staticClass:"table-wrap"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticClass:"custom-table",staticStyle:{width:"100%"},attrs:{data:t.tableData,border:!0,stripe:"","cell-style":{padding:"0",height:"36px"},height:"calc(100vh - 300px)"},on:{"selection-change":t.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"50"}}),t._v(" "),n("el-table-column",{attrs:{type:"index",label:"序号",index:t.indexMethod,width:"50",align:"center"}}),t._v(" "),t.showId?n("el-table-column",{attrs:{prop:"genie_job_id",label:"实例ID","min-width":"180",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.genie_job_id?n("el-tooltip",{attrs:{content:e.row.genie_job_id,disabled:t.isTipDisabled}},[n("span",{staticClass:"ellipsis block jump",on:{click:function(n){return t.jumpLog(e.row)},mouseenter:t.isShowTooltip}},[t._v(t._s(e.row.genie_job_id))])]):[t._v(" - ")]]}}],null,!1,3227739721)}):t._e(),t._v(" "),n("el-table-column",{attrs:{prop:"state",label:"运行状态","min-width":"120",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tag",{attrs:{color:t.stateColorFn(t.statusCodeList[e.row.state]),effect:"dark"}},[t._v(t._s(t.statusCodeList[e.row.state]||e.row.state))])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"state",label:"运行次数","min-width":"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.try_number?n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.openRecord(e.row)}}},[t._v(t._s(e.row.try_number)+"次")]):n("span",[t._v("-")])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"execution_date",label:"执行入参时间","min-width":"180",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(e.row.execution_date?t.$utils.parseTime(e.row.execution_date,"{y}/{m}/{d} {h}:{i}:{s}.{b}"):"-")+"\n            ")]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"start_date",label:"任务开始时间","min-width":"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(e.row.start_date?t.$utils.parseTime(e.row.start_date):"-")+"\n            ")]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"end_date",label:"任务结束时间","min-width":"150",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n              "+t._s(e.row.end_date?t.$utils.parseTime(e.row.end_date):"-")+"\n            ")]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"duration",label:"任务耗时","min-width":"140",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{fixed:"right",label:"操作","min-width":"215",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{style:{color:t.isAdmin||t.isOwner?"#e6a23c":"#d1d7e6"},attrs:{type:"text",size:"mini",disabled:!(t.isAdmin||t.isOwner)},on:{click:function(n){return t.checkError(e.row)}}},[t._v("检查上游")]),t._v(" "),n("el-button",{attrs:{type:"text",size:"mini",disabled:"waiting"===e.row.state||!((t.isAdmin||t.isOwner)&&t.isOnline)},on:{click:function(n){return t.repeatCalc(e.row)}}},[t._v(t._s("termination"===e.row.state?"重新启动检查":"重算"))]),t._v(" "),n("el-button",{style:{color:(t.isAdmin||t.isOwner)&&t.isOnline?"#FF5656":"#d1d7e6"},attrs:{type:"text",size:"mini",disabled:"termination"===e.row.state||!((t.isAdmin||t.isOwner)&&t.isOnline)},on:{click:function(n){return t.stop(e.row)}}},[t._v("停止")]),t._v(" "),n("el-button",{attrs:{type:"text",size:"mini",disabled:!t.isScanSparkUI||"waiting"===e.row.state||"termination"===e.row.state||!(t.isAdmin||t.isOwner)||!e.row.spark_ui},on:{click:function(n){return t.getUI(e.row)}}},[t._v("Spark UI")]),t._v(" "),n("el-button",{attrs:{type:"text",size:"mini",disabled:!t.isScanSqlCmd},on:{click:function(n){return t.getSql(e.row)}}},[t._v(t._s("PythonShell"===t.templateCode?"脚本预览":"SQL预览"))])]}}])})],1),t._v(" "),n("el-pagination",{attrs:{background:"",total:t.total,"current-page":t.params.pageNum,"page-sizes":[10,20,30,50,100],"page-size":t.params.pageSize,layout:"total, sizes, prev, pager, next, jumper"},on:{"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}})],1)]),t._v(" "),n("el-tab-pane",{attrs:{name:"data",label:"数据血缘"}},["data"===t.tabItem?n("ConsanguinityMap",{ref:"ConsanguinityMap"}):t._e()],1),t._v(" "),n("el-tab-pane",{attrs:{name:"link",label:"链路分析"}},["link"===t.tabItem?n("LinkAnalysis"):t._e()],1)],1),t._v(" "),n("el-dialog",{attrs:{title:"停止",visible:t.dialogVisible,"close-on-click-modal":!1,width:"500px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("el-form",{attrs:{model:t.form,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"状态"}},[n("el-select",{attrs:{placeholder:"请选择状态",disabled:t.statusDisabled},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[n("el-option",{attrs:{label:"成功",value:1}}),t._v(" "),n("el-option",{attrs:{label:"失败",value:0}})],1)],1)],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("确 定")])],1)],1),t._v(" "),n("el-dialog",{attrs:{title:("PythonShell"===t.templateCode?"脚本预览":"SQL预览")+"-"+(0===t.version?"最新":"V"+t.version),visible:t.dialogVisibleSql,"close-on-click-modal":!1,width:"800px"},on:{"update:visible":function(e){t.dialogVisibleSql=e}}},[n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.sqlLoading,expression:"sqlLoading"}],staticClass:"monaco-editor-wrap"},[n("monaco-editor",{directives:[{name:"show",rawName:"v-show",value:t.content,expression:"content"}],ref:"monaco",attrs:{"read-only":!0},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),t._v(" "),n("el-empty",{directives:[{name:"show",rawName:"v-show",value:!t.content,expression:"!content"}],attrs:{"image-size":100}})],1)]),t._v(" "),n("el-dialog",{attrs:{title:"重算",visible:t.dialogVisibleClear,"close-on-click-modal":!1,width:"500px"},on:{"update:visible":function(e){t.dialogVisibleClear=e}}},[n("el-form",{attrs:{"label-width":"250px"}},[n("el-form-item",{attrs:{label:"重算任务是否在执行过程中检查上游:"}},[n("el-radio-group",{model:{value:t.isCheckUpstream,callback:function(e){t.isCheckUpstream=e},expression:"isCheckUpstream"}},[n("el-radio",{attrs:{label:!0}},[t._v("是")]),t._v(" "),n("el-radio",{attrs:{label:!1}},[t._v("否")])],1),t._v(" "),n("el-popover",{attrs:{placement:"bottom",trigger:"hover","popper-class":"tag-popper",width:"180"}},[n("div",[t._v("主要用于自依赖任务顺序执行")]),t._v(" "),n("i",{staticClass:"el-icon-info",staticStyle:{cursor:"pointer",color:"#409eff",position:"relative",left:"-366px"},attrs:{slot:"reference"},slot:"reference"})])],1)],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogVisibleClear=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.saveClear}},[t._v("确 定")])],1)],1),t._v(" "),n("el-dialog",{staticClass:"error-dialog",attrs:{title:"检查上游",visible:t.dialogVisibleCheck,width:"70%"},on:{"update:visible":function(e){t.dialogVisibleCheck=e}}},[n("div",{staticStyle:{"font-size":"$global-font-size-16"},attrs:{slot:"title"},slot:"title"},[t._v("\n      检查上游\n      "),n("el-tooltip",{attrs:{effect:"dark",content:"边框实线与虚线用以区分内部or外部数据；背景灰色代表任务下线；边框颜色用以区分当前实例状态",placement:"bottom"}},[n("i",{staticClass:"el-icon-info",staticStyle:{color:"#409eff"}})])],1),t._v(" "),n("div",{staticClass:"text-center mb10"},[t._v("当前实例："+t._s(t.currentCase.name)+"    "+t._s(t.currentCase.executionDate))]),t._v(" "),n("div",{staticClass:"legend"},[n("div",{staticStyle:{position:"absolute"}},[n("span",{staticClass:"inside-color"},[t._v("内部数据")]),t._v(" "),n("el-tooltip",{attrs:{effect:"dark",content:"代表非本平台产出的数据",placement:"bottom"}},[n("span",{staticClass:"outside-color"},[t._v("外部数据")])]),t._v(" "),n("span",{staticClass:"outline-color"},[t._v("下线")])],1),t._v(" "),n("span",{staticClass:"waiting-color"},[t._v("检查上游")]),t._v(" "),n("span",{staticClass:"waiting-queue"},[t._v("排队中")]),t._v(" "),n("span",{staticClass:"running-color"},[t._v("运行中")]),t._v(" "),n("span",{staticClass:"success-color"},[t._v("成功")]),t._v(" "),n("span",{staticClass:"failed-color"},[t._v("失败")]),t._v(" "),n("div",{staticStyle:{position:"absolute",right:"0",bottom:"0"}},[n("div",{staticClass:"dashed"}),t._v(" "),n("i",{staticClass:"el-icon-caret-right dash-caret"}),t._v("\n        中间有省略节点\n      ")])]),t._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:t.dialogLoading,expression:"dialogLoading"}]},[t.errorData.instance&&t.errorData.instance.length&&t.errorData.relation&&t.errorData.relation.length?n("DAG",{staticClass:"dag",attrs:{shapes:t.errorData.instance,relations:t.errorData.relation,options:{idKey:"nodeId",sourceKey:"source",targetKey:"target",titleKey:t.titleKey,jumpUrl:function(t){return t.recursion||t.external?"":"/task/detail"}},"node-class":t.nodeClass},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.data;return[n("el-tooltip",{attrs:{effect:"dark",placement:"bottom"}},[n("div",{staticClass:"data-tooltip",attrs:{slot:"content"},slot:"content"},[a.recursion?n("div",[t._v("该节点代表该依赖链路上被省略的中间实例")]):[a.external?t._e():n("div",[t._v("任务名称："+t._s(a.dagId))]),t._v(" "),n("div",[t._v(t._s(a.external?"数据":"实例")+"日期："+t._s(a.executionDate))]),t._v(" "),n("div",[t._v("数据集类型："+t._s(a.external?"外部":"内部"))]),t._v(" "),n("div",[t._v("数据集名称："+t._s(a.metadataId))]),t._v(" "),a.external?[n("div",[t._v("检查路径："+t._s(a.checkPath||"-"))]),t._v(" "),n("div",[t._v("完成时间："+t._s(a.successDate||"-"))])]:[n("div",[t._v("任务负责人："+t._s(a.owner||"-"))]),t._v(" "),n("div",[t._v("任务开始时间："+t._s(a.start_date||"-"))]),t._v(" "),n("div",[t._v("任务结束时间："+t._s(a.end_date||"-"))])]]],2),t._v(" "),n("i",{staticClass:"el-icon-info"})])]}}],null,!1,2326802157)}):n("div",{staticClass:"no-data"},[t._v("未检查到上游实例")])],1)]),t._v(" "),n("el-dialog",{attrs:{title:"运行记录",visible:t.dialogVisibleRecord,width:"1120px"},on:{"update:visible":function(e){t.dialogVisibleRecord=e}}},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.recordLoading,expression:"recordLoading"}],staticClass:"custom-table",staticStyle:{width:"100%"},attrs:{data:t.recordList,border:!0,stripe:"","cell-style":{padding:"10px 0"},"max-height":"380px"}},[n("el-table-column",{attrs:{type:"index",label:"运行次数",width:"85",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{prop:"genie_job_id",label:"实例ID","min-width":"160",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.genie_job_id?n("el-tooltip",{attrs:{content:e.row.genie_job_id,disabled:t.isTipDisabled}},[n("span",{staticClass:"ellipsis block jump",on:{click:function(n){return t.jumpLog(e.row)},mouseenter:t.isShowTooltip}},[t._v(t._s(e.row.genie_job_id))])]):[t._v(" - ")]]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"state",label:"运行状态","min-width":"110",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-tag",{attrs:{color:t.stateColorFn(t.statusCodeList[e.row.state]),effect:"dark"}},[t._v(t._s(t.statusCodeList[e.row.state]||e.row.state))])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"execution_date",label:"执行入参时间","min-width":"175",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.execution_date?t.$utils.parseTime(e.row.execution_date,"{y}/{m}/{d} {h}:{i}:{s}.{b}"):"-")+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"start_date",label:"任务开始时间","min-width":"135",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.start_date?t.$utils.parseTime(e.row.start_date):"-")+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"end_date",label:"任务结束时间","min-width":"135",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.end_date?t.$utils.parseTime(e.row.end_date):"-")+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"duration",label:"任务耗时","min-width":"120",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{prop:"task_type",label:"调度类型","min-width":"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return["backCalculation"===e.row.task_type?n("span",[t._v("补数")]):"clear_backCalculation"===e.row.task_type?n("span",[t._v("重算")]):"pipeline"===e.row.task_type?n("span",[t._v("正常调度")]):n("span",[t._v("-")])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"owner",label:"操作","min-width":"190",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text",size:"mini",disabled:!t.isScanSparkUI||"waiting"===e.row.state||"termination"===e.row.state||!(t.isAdmin||t.isOwner)||!e.row.spark_ui},on:{click:function(n){return t.getUI(e.row)}}},[t._v("Spark UI")]),t._v(" "),n("el-button",{attrs:{type:"text",size:"mini",disabled:"waiting"===e.row.state||"termination"===e.row.state||!(t.isAdmin||t.isOwner)||!t.isScanKibana},on:{click:function(n){return t.getLogs(e.row)}}},[t._v("Kibana日志")]),t._v(" "),n("el-button",{attrs:{type:"text",size:"mini",disabled:!t.isScanSqlCmd},on:{click:function(n){return t.getSql(e.row)}}},[t._v(t._s("PythonShell"===t.templateCode?"脚本预览":"SQL预览"))])]}}])})],1)],1)],1)},o=[],s=n("88c9"),l=n("6d5e"),c=n("b03b"),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"wrap",staticClass:"wrap"},[n("div",{staticClass:"search_top"},[n("div",{staticClass:"item"},[n("span",{staticClass:"lable"},[t._v("实例时间 : ")]),t._v(" "),n("el-select",{directives:[{name:"loadMore",rawName:"v-loadMore",value:{fn:t.loadMore,selector:".el-select-dropdown .el-select-dropdown__wrap"},expression:"{ fn: loadMore, selector: '.el-select-dropdown .el-select-dropdown__wrap' }"}],attrs:{disabled:t.loading,placeholder:"当前任务对应的实例时间"},on:{change:t.getData},model:{value:t.params.execution_date,callback:function(e){t.$set(t.params,"execution_date",e)},expression:"params.execution_date"}},t._l(t.options,(function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),t._v(" "),n("div",{staticClass:"item"},[n("el-radio-group",{attrs:{disabled:t.loading,size:"mini"},on:{change:t.getData},model:{value:t.params.upDown,callback:function(e){t.$set(t.params,"upDown",e)},expression:"params.upDown"}},[n("el-radio-button",{attrs:{label:1}},[t._v("上 游")]),t._v(" "),n("el-radio-button",{attrs:{label:2}},[t._v("下 游")])],1)],1),t._v(" "),n("div",{staticClass:"item"},[n("span",{staticClass:"lable"},[t._v("血缘深度 : ")]),t._v(" "),n("el-input-number",{attrs:{disabled:t.loading,min:1,max:10},on:{change:t.depthChange},model:{value:t.depth,callback:function(e){t.depth=e},expression:"depth"}})],1)]),t._v(" "),n("div",{staticClass:"content"},[n("div",{staticClass:"tool"},[n("div",{staticClass:"lf"},[n("el-tooltip",{attrs:{effect:"dark",content:"刷新",placement:"top"}},[n("i",{staticClass:"el-icon-refresh",on:{click:t.getData}})]),t._v(" "),n("span",{staticClass:"inner"},[t._v("内部数据")]),t._v(" "),n("span",{staticClass:"outer"},[t._v("外部数据")])],1),t._v(" "),n("div",{staticClass:"legend"},[n("i",t._l(t.btnsOptions,(function(t){return n("btns",{key:t.text,attrs:{info:t}})})),1)])]),t._v(" "),n("div",{staticClass:"content_box"},[t.errorData.instance&&t.errorData.instance.length?n("Diagram",{ref:"Diagram",attrs:{"graph-options":t.graphOptions,"relational-data":t.errorData,"node-style-fn":t.nodeClass},scopedSlots:t._u([{key:"node",fn:function(e){var a=e.node;return n("div",{},[n("el-tooltip",{attrs:{effect:"dark",placement:"top"}},[n("div",{staticClass:"data-tooltip",attrs:{slot:"content"},slot:"content"},[a.data.isExternal?t._e():n("div",[t._v("任务名称："+t._s(a.data.dagId))]),t._v(" "),n("div",[t._v("数据集类型："+t._s(a.data.isExternal?"外部":"内部"))]),t._v(" "),n("div",[t._v("数据集名称："+t._s(a.data.metadataId))]),t._v(" "),a.data.isExternal?[n("div",[t._v("检查路径："+t._s(a.data.checkPath||"-"))]),t._v(" "),n("div",[t._v("就绪时间："+t._s(a.data.successDate||"-"))])]:[n("div",[t._v("任务开始时间："+t._s(a.data.start_date||"-"))]),t._v(" "),n("div",[t._v("任务结束时间："+t._s(a.data.end_date||"-"))])]],2),t._v(" "),n("div",{staticClass:"DAG_box",on:{contextmenu:function(e){return e.preventDefault(),t.onContextmenu(e,a.data)}}},[a.data.recursion?n("div",[t._v("该节点代表该依赖链路上被省略的中间实例")]):[n("div",{staticClass:"title",on:{click:function(e){t.handelTitle(t.jumpUrl(a.data),a.data.task_id,a.data.dagId)}}},[n("span",[t._v(t._s(a.data.dagId||".... ...."))]),t._v(" "),n("svg-icon",t._b({},"svg-icon",t.titleIcon(a.data),!1))],1),t._v(" "),n("div",[t._v("\n                  任务id:\n                  "+t._s(a.data.task_id||"-")+"\n                  "),a.data.nodeId===t.errorData.coreTaskId?n("span",[t._v("(当前实例)")]):t._e()]),t._v(" "),n("div",[t._v(t._s(a.data.isExternal?"数据日期":"实例日期")+": "+t._s(a.data.executionDate||"-"))]),t._v(" "),n("div",[t._v(t._s(t.nodeState(a.data).title)+": "+t._s(t.nodeState(a.data).executionDate))]),t._v(" "),n("div",{staticClass:"ellipsis"},[t._v(t._s(a.data.isExternal?"数据集owner":"任务owner")+": "+t._s(a.data.owner||"-"))])]],2)])],1)}}],null,!1,1399947371)}):n("el-empty",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{description:"暂无数据"}})],1)])])},d=[],p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("RelationGraph",{ref:"seeksRelationGraph",staticClass:"seeksRelationGraph",class:[t.isFullscreen?"table-fullscreen":""],attrs:{options:t.graphOptions},scopedSlots:t._u([{key:"node",fn:function(e){var a=e.node;return n("div",{},[t._t("node",[n("div",{staticClass:"node"},[t._v(t._s(a.text))])],{node:a})],2)}}],null,!0)})},f=[],h=n("0491"),m=n.n(h),v={name:"Diagram",components:{RelationGraph:m.a},props:{graphOptions:{type:Object,default:function(){return{defaultJunctionPoint:"border",disableZoom:!0,layouts:[]}}},nodeOptions:{type:Object,default:function(){return{idKey:"nodeId",from:"source",to:"target",nodeWidth:"220",nodeHeight:"100",lineShape:5,nodeShape:1}}},relationalData:{type:Object,default:function(){return{coreTaskId:"",instance:[],relation:[]}}},nodeStyleFn:{type:Function,default:function(){return""}}},data:function(){return{isFullscreen:!1}},computed:{graphJsonData:function(){var t=this,e={},n=this.relationalData,a=n.coreTaskId,r=n.instance,i=void 0===r?[]:r,o=n.relation,s=void 0===o?[]:o;e.rootId=a;var l=[];s.forEach((function(e){l.push({from:e[t.nodeOptions.from],to:e[t.nodeOptions.to],lineShape:t.nodeOptions.lineShape})})),e.links=l;var c=[];return i.forEach((function(e){c.push({id:e[t.nodeOptions.idKey],nodeShape:t.nodeOptions.nodeShape,data:e,width:t.nodeOptions.nodeWidth,height:t.nodeOptions.nodeHeight,styleClass:t.nodeStyleFn(e)})})),e.nodes=c,e}},mounted:function(){var t=this.$refs.seeksRelationGraph.$el.querySelectorAll(".c-mini-toolbar .c-mb-button");t[0].style.display="none";var e=document.createElement("div");e.className="myFullscreen",e.innerHTML='\n      <i class="el-icon-full-screen rg-icon"></i>\n      <span class="c-mb-text">全屏</span>\n    ',e.onclick=this.fullscreenFn;var n=this.$refs.seeksRelationGraph.$el.querySelector(".c-mini-toolbar");n.insertBefore(e,t[1]),this.showSeeksGraph()},methods:{fullscreenFn:function(t){var e;this.isFullscreen=!this.isFullscreen,e="DIV"===t.target.nodeName?t.target:t.target.parentNode;var n=this.isFullscreen?"恢复":"全屏",a=e.querySelector(".c-mb-text");a.innerText=n},showSeeksGraph:function(){this.$refs.seeksRelationGraph.setJsonData(this.graphJsonData,(function(t){}))},refresh:function(){var t;null==(t=this.$refs.seeksRelationGraph)||t.refresh()}}},g=v,y=(n("9378"),n("2877")),b=Object(y["a"])(g,p,f,!1,null,"ffe6f0ae",null),_=b.exports,k={props:{info:{type:Object,default:function(){return{color:"#686868",text:"按钮",borderStyle:"solid"}}}},render:function(t){return t("span",{style:{"border-color":"".concat(this.info.color),"border-style":"".concat(this.info.borderStyle)}},[this.info.text])}},w=k,x=(n("cf58"),Object(y["a"])(w,a,r,!1,null,"4d98fde8",null)),S=x.exports,C=n("2f62"),O=n("7258");function L(t){return O["b"].get("/pipeline/task/dagid/count",{params:t})}function D(t){return O["b"].get("/pipeline/task/instance/dates",{params:t})}function E(t){return O["b"].get("/pipeline/task/data/lineage",{params:t,timeout:6e4})}function I(t){return O["b"].get("/pipeline/task/data/link/analysis",{params:t,timeout:6e4})}function j(t){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j(t)}function T(t){return $(t)||A(t)||N(t)||P()}function P(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function N(t,e){if(t){if("string"===typeof t)return F(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?F(t,e):void 0}}function A(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function $(t){if(Array.isArray(t))return F(t)}function F(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function M(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function q(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?M(Object(n),!0).forEach((function(e){H(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function H(t,e,n){return e=G(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function G(t){var e=U(t,"string");return"symbol"===j(e)?e:String(e)}function U(t,e){if("object"!==j(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!==j(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function R(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */R=function(){return e};var t,e={},n=Object.prototype,a=n.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function u(t,e,n,a){var i=e&&e.prototype instanceof g?e:g,o=Object.create(i.prototype),s=new I(a||[]);return r(o,"_invoke",{value:O(t,n,s)}),o}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var p="suspendedStart",f="suspendedYield",h="executing",m="completed",v={};function g(){}function y(){}function b(){}var _={};c(_,o,(function(){return this}));var k=Object.getPrototypeOf,w=k&&k(k(T([])));w&&w!==n&&a.call(w,o)&&(_=w);var x=b.prototype=g.prototype=Object.create(_);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function n(r,i,o,s){var l=d(t[r],t,i);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==j(u)&&a.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,o,s)}),(function(t){n("throw",t,o,s)})):e.resolve(u).then((function(t){c.value=t,o(c)}),(function(t){return n("throw",t,o,s)}))}s(l.arg)}var i;r(this,"_invoke",{value:function(t,a){function r(){return new e((function(e,r){n(t,a,e,r)}))}return i=i?i.then(r,r):r()}})}function O(e,n,a){var r=p;return function(i,o){if(r===h)throw new Error("Generator is already running");if(r===m){if("throw"===i)throw o;return{value:t,done:!0}}for(a.method=i,a.arg=o;;){var s=a.delegate;if(s){var l=L(s,a);if(l){if(l===v)continue;return l}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(r===p)throw r=m,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);r=h;var c=d(e,n,a);if("normal"===c.type){if(r=a.done?m:f,c.arg===v)continue;return{value:c.arg,done:a.done}}"throw"===c.type&&(r=m,a.method="throw",a.arg=c.arg)}}}function L(e,n){var a=n.method,r=e.iterator[a];if(r===t)return n.delegate=null,"throw"===a&&e.iterator.return&&(n.method="return",n.arg=t,L(e,n),"throw"===n.method)||"return"!==a&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+a+"' method")),v;var i=d(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function D(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(D,this),this.reset(!0)}function T(e){if(e||""===e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function n(){for(;++r<e.length;)if(a.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(j(e)+" is not iterable")}return y.prototype=b,r(x,"constructor",{value:b,configurable:!0}),r(b,"constructor",{value:y,configurable:!0}),y.displayName=c(b,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,l,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},S(C.prototype),c(C.prototype,s,(function(){return this})),e.AsyncIterator=C,e.async=function(t,n,a,r,i){void 0===i&&(i=Promise);var o=new C(u(t,n,a,r),i);return e.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},S(x),c(x,l,"Generator"),c(x,o,(function(){return this})),c(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var a in e)n.push(a);return n.reverse(),function t(){for(;n.length;){var a=n.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},e.values=T,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(a,r){return s.type="throw",s.arg=e,n.next=a,r&&(n.method="next",n.arg=t),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var l=a.call(o,"catchLoc"),c=a.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),E(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var a=n.completion;if("throw"===a.type){var r=a.arg;E(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,a){return this.delegate={iterator:T(e),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=t),v}},e}function K(t,e,n,a,r,i,o){try{var s=t[i](o),l=s.value}catch(c){return void n(c)}s.done?e(l):Promise.resolve(l).then(a,r)}function z(t){return function(){var e=this,n=arguments;return new Promise((function(a,r){var i=t.apply(e,n);function o(t){K(i,a,r,o,s,"next",t)}function s(t){K(i,a,r,o,s,"throw",t)}o(void 0)}))}}var V={components:{Diagram:_,btns:S},data:function(){return{graphOptions:{defaultJunctionPoint:"border",disableZoom:!0,layouts:[{label:"中心",layoutName:"tree",layoutClassName:"seeks-layout-center",from:"left",max_per_width:370,min_per_height:160,centerOffset_x:0}],defaultLineShape:2,defaultNodeShape:1,defaultLineWidth:2,defaultLineColor:"#5f95ff"},name:this.$route.query.name,taskId:this.$route.query.id,isCheckUpstream:!0,params:{execution_date:"",upDown:1},depth:3,options:[],btnsOptions:[{text:"检查上游",color:"#d7bdf2"},{text:"排队中",color:"#87e0f0"},{text:"运行中",color:"#3782ff"},{text:"成功",color:"#67c23a"},{text:"失败",color:"#f10d15"}],errorData:{},debounceDepthFn:null,loading:!1,execution_date:"",endDateType:!1,contentWidth:0}},watch:{treeNodeWidth:{handler:function(t){this.graphOptions.layouts[0].centerOffset_x=t;this.$refs.Diagram},immediate:!0}},created:function(){var t=z(R().mark((function t(){var e,n=this;return R().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.debounceDepthFn=this.$utils.debounce(this.getData,500),!this.taskPageOptions["data".concat(this.name)]){t.next=5;break}Object.keys(this.taskPageOptions["data".concat(this.name)]).forEach((function(t){"debounceDepthFn"!==t&&"loading"!==t&&(n[t]=n.taskPageOptions["data".concat(n.name)][t],"errorData"===t&&!n.taskPageOptions["data".concat(n.name)][t].coreTaskId&&n.options.length&&n.getData())})),t.next=13;break;case 5:return t.next=7,this.getSnapshotList();case 7:return t.next=9,t.sent;case 9:if(e=t.sent,e&&0!==e.length){t.next=12;break}return t.abrupt("return");case 12:this.getData();case 13:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),mounted:function(){var t,e=this;this.contentWidth=(null==(t=this.$refs.wrap)?void 0:t.clientWidth)||0,window.onresize=function(){var t;e.contentWidth=(null==(t=e.$refs.wrap)?void 0:t.clientWidth)||e.contentWidth||0}},destroyed:function(){this.SET_TASKPAGEOPTIONS(q({tabs:"data".concat(this.name)},this._data))},computed:q(q({},Object(C["c"])(["taskPageOptions"])),{},{treeNodeWidth:function(){var t=0;if(1===this.params.upDown){var e=this.contentWidth?this.contentWidth/20*13:800;t=e}else t=50;return t}}),methods:q(q({},Object(C["d"])(["SET_TASKPAGEOPTIONS"])),{},{jumpUrl:function(t){return t.recursion||t.isExternal?"":"/task/detail"},executeTaxk:function(t,e){var n=this,a={name:t.dagId,executionDate:t.executionDate,status:e};Object(l["t"])(a).then((function(a){n.dialogVisible=!1,n.$message({type:"success",message:"执行成功"});var r=e?"success":"failed";t.state=r,n.$refs.Diagram.showSeeksGraph()}))},repeatCalc:function(t){var e=this;this.$confirm("确定重算?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.saveClear(t)})).catch((function(){}))},saveClear:function(t){var e=this;Object(l["e"])({name:t.dagId,executionDate:this.$utils.parseTime(t.executionDate),isCheckUpstream:this.isCheckUpstream}).then((function(n){e.$message({type:"success",message:"执行成功"}),e.dialogVisibleClear=!1,t.state="waiting",e.$refs.Diagram.showSeeksGraph()}))},onContextmenu:function(t,e){var n=this,a=[{label:"重算",disabled:"waiting"===e.state||"waiting_queue"===e.state,onClick:function(){n.repeatCalc(e)}},{label:"置为成功",onClick:function(){n.executeTaxk(e,1)}},{label:"置为失败",onClick:function(){n.executeTaxk(e,0)}}];this.$contextmenu({items:a,event:t,zIndex:2200,minWidth:50}),t.preventDefault()},handelTitle:function(t,e,n){if(e&&n){var a=this.$router.resolve({path:t,query:{id:e,name:n}}).href;window.open(a,"_blank")}},loadMore:function(){this.execution_date=this.options.length>0?this.options[this.options.length-1]:"",this.getSnapshotList()},getSnapshotList:function(){var t=this;if(!this.endDateType){var e={name:this.name,execution_date:this.execution_date};return D(e).then((function(e){var n,a=e.data;return t.execution_date?((n=t.options).push.apply(n,T(a)),t.execution_date=a[a.length-1],a&&a.length<20&&(t.endDateType=!0),a):(t.options=a||[],t.params.execution_date=t.options[0],a&&a.length<20&&(t.endDateType=!0),a)}))}},depthChange:function(){0!==this.options.length&&this.debounceDepthFn&&this.debounceDepthFn()},titleIcon:function(t){var e={};return"failed"===t.state||"termination"===t.state?e={"icon-class":"taskError",style:"color:#f10d15"}:"success"===t.state?e={"icon-class":"taskSuccess",style:"color:#67c23a"}:"waiting"===t.state?e={"icon-class":"taskWaiting",style:"color:#d7bdf2"}:"waiting_queue"===t.state?e={"icon-class":"taskWaiting",style:"color:#87e0f0"}:"running"!==t.state&&"up_for_retry"!==t.state||(e={"icon-class":"taskInfo",style:"color:$c-primary"}),e},nodeState:function(t){var e={title:"-",executionDate:"-"};return"waiting"===t.state||"waiting_queue"===t.state?(e.title=t.isExternal?"未就绪 ":"检查上游",e.executionDate=t.duration||"-"):"running"===t.state||"up_for_retry"===t.state?(e.title="运行中",e.executionDate=t.duration||"-"):"success"===t.state?(e.title=t.isExternal?"已就绪 ":"执行成功",e.executionDate=t.duration||"-"):"failed"!==t.state&&"termination"!==t.state||(e.title="执行失败",e.executionDate=t.duration||"-"),e},nodeClass:function(t){var e;return"waiting"===t.state?e="waiting-color":"waiting_queue"===t.state?e="waiting-queue":"running"===t.state||"up_for_retry"===t.state?e="running-color":"success"===t.state?e="success-color":"failed"!==t.state&&"termination"!==t.state||(e="failed-color"),t.nodeId===this.errorData.coreTaskId&&(e+=" bold"),t.isExternal&&(e+=" dash-border"),e},getData:function(){var t=this;this.loading=!0,this.errorData={},E(q(q({name:this.name},this.params),{},{depth:this.depth})).then((function(e){var n,a=e.data;t.errorData=a||{},null==(n=t.$refs.Diagram)||n.showSeeksGraph()})).finally((function(){var e;t.loading=!1,null==(e=t.$refs.dag)||e.format()}))}})},W=V,B=(n("dc43"),n("fc84"),Object(y["a"])(W,u,d,!1,null,"7df7ceaa",null)),J=B.exports,Q=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrap"},[n("div",{staticClass:"content"},[n("el-card",[n("div",{attrs:{slot:"header"},slot:"header"},[n("div",{staticClass:"title"},[t._v("实例运行表视图")])]),t._v(" "),n("div",{staticClass:"search_top"},[n("div",{staticClass:"type"},[n("el-tooltip",{attrs:{effect:"dark",content:"刷新",placement:"top"}},[n("span",{staticClass:"el-icon-refresh",on:{click:t.getData}})]),t._v(" "),n("span",{staticClass:"inner"},[n("i"),t._v("内部数据")]),t._v(" "),n("span",{staticClass:"outer"},[n("i"),t._v("外部数据")])],1),t._v(" "),n("div",{staticClass:"legend"},t._l(t.btnsOptions,(function(t){return n("btns",{key:t.text,attrs:{info:t}})})),1),t._v(" "),n("div",{staticClass:"search"},[n("div",{staticClass:"item"},[n("span",{staticClass:"label"},[t._v("实例时间 : ")]),t._v(" "),n("el-select",{directives:[{name:"loadMore",rawName:"v-loadMore",value:{fn:t.loadMore,selector:".el-select-dropdown .el-select-dropdown__wrap"},expression:"{ fn: loadMore, selector: '.el-select-dropdown .el-select-dropdown__wrap' }"}],attrs:{placeholder:"当前任务对应的实例时间",disabled:t.loading},on:{change:t.searchDateChange},model:{value:t.params.execution_date,callback:function(e){t.$set(t.params,"execution_date",e)},expression:"params.execution_date"}},t._l(t.options,(function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),t._v(" "),n("div",{staticClass:"item"},[n("span",{staticClass:"label"},[t._v("最近N个 : ")]),t._v(" "),n("el-select",{attrs:{placeholder:"请选择",disabled:t.loading},on:{change:t.searchDateChange},model:{value:t.params.num,callback:function(e){t.$set(t.params,"num",e)},expression:"params.num"}},t._l(t.comNumOptions,(function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1)])]),t._v(" "),t.analysisData&&t.analysisData.tree?n("histogram",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"histogram",attrs:{data:t.analysisData},on:{"click-item":t.handelItem}}):n("el-empty",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{description:"暂无数据"}})],1),t._v(" "),n("el-card",[n("div",{attrs:{slot:"header"},slot:"header"},[n("div",{staticClass:"title"},[t._v("实例运行甘特图")])]),t._v(" "),n("div",{staticClass:"search_top"},[n("div",{staticClass:"type"},[n("el-tooltip",{attrs:{effect:"dark",content:"刷新",placement:"top"}},[n("span",{staticClass:"el-icon-refresh",on:{click:t.getGanttData}})]),t._v(" "),n("span",{staticClass:"inner"},[n("i"),t._v("内部数据")]),t._v(" "),n("span",{staticClass:"outer"},[n("i"),t._v("外部数据")])],1),t._v(" "),n("div",{staticClass:"legend"},t._l(t.btnsOptions,(function(t){return n("btns",{key:t.text,attrs:{info:t}})})),1),t._v(" "),n("div",{staticClass:"search"},[n("div",{staticClass:"item"},[n("span",{staticClass:"label"},[t._v("实例时间 : ")]),t._v(" "),n("el-select",{directives:[{name:"loadMore",rawName:"v-loadMore",value:{fn:t.loadMore,selector:".el-select-dropdown .el-select-dropdown__wrap"},expression:"{ fn: loadMore, selector: '.el-select-dropdown .el-select-dropdown__wrap' }"}],attrs:{placeholder:"当前任务对应的实例时间",disabled:t.ganttLoading},on:{change:t.ganttDateChange},model:{value:t.ganttExecutionDate,callback:function(e){t.ganttExecutionDate=e},expression:"ganttExecutionDate"}},t._l(t.options,(function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1)])]),t._v(" "),t.ganttData&&t.ganttData.tree?n("ganttChart",{directives:[{name:"loading",rawName:"v-loading",value:t.ganttLoading,expression:"ganttLoading"}],attrs:{data:t.ganttData},on:{"click-item":t.handelItem}}):n("el-empty",{directives:[{name:"loading",rawName:"v-loading",value:t.ganttLoading,expression:"ganttLoading"}],attrs:{description:"暂无数据"}})],1)],1),t._v(" "),n("el-dialog",{attrs:{title:"停止",visible:t.dialogVisible,"close-on-click-modal":!1,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("el-form",{attrs:{model:t.form,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"状态"}},[n("el-select",{attrs:{placeholder:"请选择状态"},model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},[n("el-option",{attrs:{label:"成功",value:1}}),t._v(" "),n("el-option",{attrs:{label:"失败",value:0}})],1)],1)],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("确 定")])],1)],1),t._v(" "),n("el-dialog",{attrs:{title:"SQL预览-V"+t.version,visible:t.dialogVisibleSql,"close-on-click-modal":!1,width:"800px"},on:{"update:visible":function(e){t.dialogVisibleSql=e}}},[n("div",{staticClass:"monaco-editor-wrap"},[n("monaco-editor",{directives:[{name:"loading",rawName:"v-loading",value:t.sqlLoading,expression:"sqlLoading"}],ref:"monaco",attrs:{"read-only":!0},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}})],1)])],1)},Y=[],Z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"content_box"},[n("div",{ref:"treeDom",staticClass:"content_left",style:{marginTop:t.titleMaxheight+4+"px"}},[t.data.tree?n("treeMap",{staticClass:"treeMap",attrs:{trees:t.data.tree}}):t._e()],1),t._v(" "),n("div",{staticClass:"container"},[n("div",{staticClass:"top"},t._l(t.topData.dataItemCom.listCom,(function(e,a){return n("div",{key:a,staticClass:"item"},[n("div",{staticClass:"item_box"},t._l(e.list,(function(e,r){return n("el-tooltip",{key:r,attrs:{effect:"dark",content:"执行时间: "+t.formatTime(t.topData.dataItemCom.list[a][r]),placement:"right",enterable:!1}},[n("span",{staticClass:"block",style:{height:e+"px",marginTop:t.titleMaxheight-e+"px",display:"inline-block"}})])})),1),t._v(" "),n("div",{staticClass:"shadow",class:e.endTime||a!==t.topData.dataItemCom.listCom.length-1?"":"delEndLine"},[n("span",{staticClass:"date_start"},[t._v(t._s(e.startTime))]),t._v(" "),e.endTime?n("span",{staticClass:"date_end"},[t._v(t._s(e.endTime))]):t._e()]),t._v(" "),n("div",{staticClass:"medianline",style:[{bottom:t.topData.avgTimeM+"px",display:"0"===t.topData.avgTimeM?"none":"block"}]},[a===t.topData.dataItemCom.listCom.length-1?n("span",{staticClass:"value"},[t._v(t._s(t.topData.avgTime||" "))]):t._e()])])})),0),t._v(" "),n("div",{staticClass:"content_item_right"},t._l(t.data.list,(function(e,a){return n("div",{key:a,staticClass:"right_row"},t._l(e,(function(a,r){return n("div",{key:r,staticClass:"item",class:r===e.length-1&&a.length<5?"delLine":""},t._l(a,(function(e,a){return n("el-tooltip",{key:a,attrs:{effect:"dark",placement:"right","popper-class":"task_tootip",disabled:!e.state},scopedSlots:t._u([{key:"content",fn:function(){return[n("div",{staticClass:"tootip-content"},[n("div",[n("span",[t._v("I D:")]),t._v(" "),n("span",[t._v(t._s(e.task_id||"-"))])]),t._v(" "),n("div",[n("span",[t._v("名称:")]),t._v(" "),n("span",[t._v(t._s(e.dagId||"-"))])]),t._v(" "),n("div",[n("span",[t._v("实例时间:")]),t._v(" "),n("span",[t._v(t._s(e.executionDate||"-"))])]),t._v(" "),n("div",[n("span",[t._v("开始时间:")]),t._v(" "),n("span",[t._v(t._s(e.start_date?t.$utils.parseTime(e.start_date,"{y}-{m}-{d} {h}:{i}:{s}"):"-"))])]),t._v(" "),n("div",[n("span",[t._v("结束时间:")]),t._v(" "),n("span",[t._v(t._s(e.end_date?t.$utils.parseTime(e.end_date,"{y}-{m}-{d} {h}:{i}:{s}"):"-"))])])]),t._v(" "),n("div",{staticClass:"tootip-footer",staticStyle:{margintop:"10px"},attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary",disabled:"waiting"===e.state||"waiting_queue"===e.state},on:{click:function(n){return t.$emit("click-item","repeatCalc",e,1)}}},[t._v("重 算")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(n){return t.$emit("click-item","stop",e,1)}}},[t._v("停 止")]),t._v(" "),n("el-button",{attrs:{disabled:!t.template_code_list.includes(e.template_code),type:"primary"},on:{click:function(n){return t.$emit("click-item","getSql",e,1)}}},[t._v("SQL")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(n){return t.$emit("click-item","getLogs",e,1)}}},[t._v("日 志")])],1)]},proxy:!0}],null,!0)},[t._v(" "),n("span",{staticClass:"block",style:t.nodeStyle(e)})])})),1)})),0)})),0)])])},X=[],tt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",{staticClass:"ui_tree"},[n("li",{staticStyle:{"list-style":"none"}},[n("div",{staticClass:"node_item"},[n("div",{staticClass:"tree-node-name-title"},[t._v(t._s(t.trees.name))]),t._v(" "),n("div",{staticClass:"node-icon1",class:t.trees.isExternal?"border_dotted":""})]),t._v(" "),t.trees.children?n("Tree",{attrs:{trees:t.trees.children}}):t._e()],1)])},et=[],nt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",t._l(t.trees,(function(e){return n("li",{key:e.name},[n("div",{staticClass:"node_item tree-node"},[n("div",{staticClass:"tree-node-name-title"},[t._v(t._s(e.name))]),t._v(" "),n("div",{staticClass:"node-icon1",class:e.isExternal?"border_dotted":""})]),t._v(" "),e.children?n("Tree",{class:[e.children.length?e.children.length<2?"half":"helf":""],attrs:{trees:e.children}}):t._e()],1)})),0)},at=[],rt={name:"Tree",components:{Tree:st},props:{trees:{type:Array,required:!0}}},it=rt,ot=(n("1dbd"),Object(y["a"])(it,nt,at,!1,null,"3e597f9e",null)),st=ot.exports,lt={name:"",components:{Tree:st},props:{trees:{type:Object,required:!0}}},ct=lt,ut=(n("b373"),Object(y["a"])(ct,tt,et,!1,null,"7391e094",null)),dt=ut.exports;function pt(t){return vt(t)||mt(t)||ht(t)||ft()}function ft(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ht(t,e){if(t){if("string"===typeof t)return gt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gt(t,e):void 0}}function mt(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function vt(t){if(Array.isArray(t))return gt(t)}function gt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}var yt={components:{treeMap:dt},props:{titleMaxheight:{type:Number,default:150},data:{type:Object,default:function(){return{tree:{},list:[]}}}},data:function(){return{template_code_list:["Hive2Hive","Hive2Mysql","Hive2Clickhouse","SPARKJAR"]}},computed:{topData:function(){var t=this,e=JSON.parse(JSON.stringify(this.data)),n=e.list||[];if(0===n.length)return{avgTime:0,dataItemCom:{}};var a={dataItemCom:{}},r=this.data.time_column.flat(1/0),i=Math.min.apply(Math,pt(r)),o=Math.max.apply(Math,pt(r)),s=o?this.titleMaxheight/o:1;a.minData=i,a.maxData=o,a.dataItemCom.list=this.data.time_column;var l=JSON.parse(JSON.stringify(this.data.time_column)),c=this.data.histogram_start;a.dataItemCom.listCom=l.map((function(e,n,a){for(var r=0;r<e.length;r++)e[r]=e[r]*s;var i={list:e,startTime:c[n]};return n===a.length-1&&t.data.endTime&&(i.endTime=t.data.endTime),i}));var u=a.dataItemCom.listCom.flat(1/0),d=a.dataItemCom.list.flat(1/0).length,p=u.reduce((function(t,e){for(var n=0;n<e.list.length;n++)t+=e.list[n];return t}),0);return a.dataItemCom.histogram_start=this.data.histogram_start,a.avgTimeM=(p/d).toFixed(0),a.avgTime=this.data.time_median,a}},methods:{formatTime:function(t){var e=this.$utils.formatSecondToHHmmss(1e3*t,!0),n="";return e.split(":").forEach((function(t,e){"00"!==t&&(0===e?(t.startsWith("0")&&(t=t.slice(1)),n=n+t+" Hours "):1===e?(t.startsWith("0")&&(t=t.slice(1)),n=n+t+" Min "):2===e&&(t.startsWith("0")&&(t=t.slice(1)),n=n+t+" Sec "))})),n},nodeStyle:function(t){var e={};return e="waiting"===t.state?{backgroundColor:"#d7bdf2"}:"waiting_queue"===t.state?{backgroundColor:"#87e0f0"}:"running"===t.state||"up_for_retry"===t.state?{backgroundColor:"$c-primary"}:"success"===t.state?{backgroundColor:"#67c23a"}:"failed"===t.state||"termination"===t.state?{backgroundColor:"#f10d15"}:{backgroundColor:"transparent",cursor:"default"},e}}},bt=yt,_t=(n("111c"),Object(y["a"])(bt,Z,X,!1,null,"2a2c4255",null)),kt=_t.exports,wt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ganttChart_box"},[n("div",{staticClass:"map"},[t.data.tree?n("treeMap",{staticClass:"treeMap",attrs:{trees:t.data.tree}}):t._e(),t._v(" "),n("div",{staticClass:"ganteMap"},[n("div",{staticClass:"axis-scroll-wrapper"},[t.data.internal?n("Axis",{staticClass:"ganttChart_axis",attrs:{"start-time":t.data.start_date,"end-time":t.data.end_date,scale:1===t.data.internal?t.data.internal:t.data.internal/60,"min-unit":10},on:{unitsChange:t.unitsChange}}):t._e(),t._v(" "),t.data.internal?n("Waterfall",{style:{width:t.axisWidth+"px"},attrs:{"start-time":t.data.start_date,"end-time":t.data.end_date,instances:t.mapList,scale:1===t.data.internal?t.data.internal:t.data.internal/60},on:{"click-item":t.clickItem}}):t._e()],1)])],1)])},xt=[],St=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",{staticClass:"axis"},t._l(t.units,(function(e){return n("li",{key:e},[1===e?n("div",{staticClass:"axis-start-number"},[t._v(t._s(t.getUnitLabel(0)))]):t._e(),t._v(" "),n("div",{staticClass:"axis-number"},[t._v(t._s(t.getUnitLabel(e)))]),t._v(" "),n("div",{staticClass:"axis-unit"})])})),0)},Ct=[],Ot=n("ed08"),Lt={name:"Axis",props:{startTime:{type:Number,required:!0},endTime:{type:Number,required:!0},scale:{type:Number,default:30},unitPixel:{type:Number,default:150},minUnit:{type:Number,default:6}},computed:{units:function(){var t=Math.ceil((this.endTime-this.startTime)/6e4/this.scale);return t<this.minUnit?this.minUnit:t}},watch:{units:{handler:function(t){this.$emit("unitsChange",t,this.unitPixel)},immediate:!0}},methods:{getUnitLabel:function(t){return Object(Ot["parseTime"])(this.startTime+t*this.scale*6e4,"{h}:{i}")}}},Dt=Lt,Et=(n("cac8"),Object(y["a"])(Dt,St,Ct,!1,null,null,null)),It=Et.exports,jt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("ul",{staticClass:"waterfall"},t._l(t.instances,(function(e,a){return n("li",{key:e.id,staticClass:"task-state"},[e&&e.start_date?n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",placement:"right","popper-class":"task_tootip"},scopedSlots:t._u([{key:"content",fn:function(){return[n("div",{staticClass:"tootip-content"},[n("div",[n("span",[t._v("I D:")]),t._v(" "),n("span",[t._v(t._s(e.task_id||"-"))])]),t._v(" "),n("div",[n("span",[t._v("名称:")]),t._v(" "),n("span",[t._v(t._s(e.dagId||"-"))])]),t._v(" "),n("div",[n("span",[t._v("实例时间:")]),t._v(" "),n("span",[t._v(t._s(e.executionDate||"-"))])]),t._v(" "),n("div",[n("span",[t._v("开始时间:")]),t._v(" "),n("span",[t._v(t._s(e.start_date?t.$utils.parseTime(e.start_date,"{y}-{m}-{d} {h}:{i}:{s}"):"-"))])]),t._v(" "),n("div",[n("span",[t._v("结束时间:")]),t._v(" "),n("span",[t._v(t._s(e.end_date?t.$utils.parseTime(e.end_date,"{y}-{m}-{d} {h}:{i}:{s}"):"-"))])])]),t._v(" "),n("div",{staticClass:"tootip-footer",staticStyle:{margintop:"10px"},attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary",disabled:"waiting"===e.state||"waiting_queue"===e.state},on:{click:function(n){return t.$emit("click-item","repeatCalc",e)}}},[t._v("重 算")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(n){return t.$emit("click-item","stop",e)}}},[t._v("停 止")]),t._v(" "),n("el-button",{attrs:{type:"primary",disabled:!t.template_code_list.includes(e.template_code)},on:{click:function(n){return t.$emit("click-item","getSql",e)}}},[t._v("SQL")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(n){return t.$emit("click-item","getLogs",e)}}},[t._v("日 志")])],1)]},proxy:!0}],null,!0)},[t._v(" "),n("div",{class:["instance","bar","task-state",e.state],style:{left:t.getInstanceShitf(e.start_date)+"px",width:t.getInstanceWidth(e.start_date,e.end_date)+"px"},on:{click:function(e){return t.handleInstance(a)}}})]):t._e()],1)})),0)])},Tt=[],Pt={name:"Waterfall",props:{id:{type:String,default:""},executionDate:{type:String,default:""},instances:{type:Array,required:!0},startTime:{type:Number,required:!0},endTime:{type:Number,required:!0},scale:{type:Number,default:30},unitPixel:{type:Number,default:150},status:{type:String,default:"no_status"},name:{type:String,default:""},cb:{type:Function,default:function(){}}},data:function(){return{minCircleWidth:20,minStartTime:0,index:0,workflowDialogVisible:!1,template_code_list:["Hive2Hive","Hive2Mysql","Hive2Clickhouse","SPARKJAR"]}},computed:{instanceName:function(){var t,e;return null==(t=this.instances[this.index])||null==(e=t.taskInstance)?void 0:e.name},instanceTime:function(){var t,e;return this.formatTime(null==(t=this.instances[this.index])||null==(e=t.taskInstance)?void 0:e.start_date)}},watch:{instances:{handler:function(){for(var t=0,e=0;e<this.instances.length;++e)this.instances[e].taskInstance&&this.instances[e].taskInstance.start_date&&(0===e||this.instances[e].taskInstance.start_date<t)&&(t=this.instances[e].taskInstance.start_date);this.minStartTime=t},immediate:!0}},mounted:function(){var t=document.documentElement.querySelector(".task-state .instance.bar");null==t||t.scrollIntoView({inline:"start"})},methods:{getInstanceShitf:function(t){return((t-this.startTime)/this.scale/6e4).toFixed(1)*this.unitPixel},getInstanceWidth:function(t,e){e=e||Date.now();var n=((e-t)/this.scale/6e4).toFixed(1)*this.unitPixel;return n=n<this.minCircleWidth?this.minCircleWidth:n,n},formatTime:function(t){return t?Object(Ot["parseTime"])(t,"{y}-{m}-{d} {h}:{i}:{s}"):""},handleInstance:function(t){this.index=t},handleWorkflow:function(){this.workflowDialogVisible=!0}}},Nt=Pt,At=(n("3f67"),n("ac7f"),Object(y["a"])(Nt,jt,Tt,!1,null,"01f054c2",null)),$t=At.exports,Ft={components:{treeMap:dt,Waterfall:$t,Axis:It},props:{data:{type:Object,default:function(){return{tree:{},list:[]}}}},data:function(){return{axisWidth:0}},computed:{mapList:function(){var t=this.data.list||[],e=JSON.parse(JSON.stringify(t)),n=e.flat(1/0)||[];return n}},methods:{unitsChange:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.axisWidth=t*e},clickItem:function(t,e){this.$emit("click-item",t,e,2)}}},Mt=Ft,qt=(n("01f5"),Object(y["a"])(Mt,wt,xt,!1,null,"307e5986",null)),Ht=qt.exports;function Gt(t){return Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gt(t)}function Ut(t){return Vt(t)||zt(t)||Kt(t)||Rt()}function Rt(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Kt(t,e){if(t){if("string"===typeof t)return Wt(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wt(t,e):void 0}}function zt(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Vt(t){if(Array.isArray(t))return Wt(t)}function Wt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function Bt(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Bt=function(){return e};var t,e={},n=Object.prototype,a=n.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function u(t,e,n,a){var i=e&&e.prototype instanceof g?e:g,o=Object.create(i.prototype),s=new I(a||[]);return r(o,"_invoke",{value:O(t,n,s)}),o}function d(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=u;var p="suspendedStart",f="suspendedYield",h="executing",m="completed",v={};function g(){}function y(){}function b(){}var _={};c(_,o,(function(){return this}));var k=Object.getPrototypeOf,w=k&&k(k(j([])));w&&w!==n&&a.call(w,o)&&(_=w);var x=b.prototype=g.prototype=Object.create(_);function S(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function n(r,i,o,s){var l=d(t[r],t,i);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==Gt(u)&&a.call(u,"__await")?e.resolve(u.__await).then((function(t){n("next",t,o,s)}),(function(t){n("throw",t,o,s)})):e.resolve(u).then((function(t){c.value=t,o(c)}),(function(t){return n("throw",t,o,s)}))}s(l.arg)}var i;r(this,"_invoke",{value:function(t,a){function r(){return new e((function(e,r){n(t,a,e,r)}))}return i=i?i.then(r,r):r()}})}function O(e,n,a){var r=p;return function(i,o){if(r===h)throw new Error("Generator is already running");if(r===m){if("throw"===i)throw o;return{value:t,done:!0}}for(a.method=i,a.arg=o;;){var s=a.delegate;if(s){var l=L(s,a);if(l){if(l===v)continue;return l}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(r===p)throw r=m,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);r=h;var c=d(e,n,a);if("normal"===c.type){if(r=a.done?m:f,c.arg===v)continue;return{value:c.arg,done:a.done}}"throw"===c.type&&(r=m,a.method="throw",a.arg=c.arg)}}}function L(e,n){var a=n.method,r=e.iterator[a];if(r===t)return n.delegate=null,"throw"===a&&e.iterator.return&&(n.method="return",n.arg=t,L(e,n),"throw"===n.method)||"return"!==a&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+a+"' method")),v;var i=d(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function D(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(D,this),this.reset(!0)}function j(e){if(e||""===e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function n(){for(;++r<e.length;)if(a.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(Gt(e)+" is not iterable")}return y.prototype=b,r(x,"constructor",{value:b,configurable:!0}),r(b,"constructor",{value:y,configurable:!0}),y.displayName=c(b,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===y||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,c(t,l,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},S(C.prototype),c(C.prototype,s,(function(){return this})),e.AsyncIterator=C,e.async=function(t,n,a,r,i){void 0===i&&(i=Promise);var o=new C(u(t,n,a,r),i);return e.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},S(x),c(x,l,"Generator"),c(x,o,(function(){return this})),c(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var a in e)n.push(a);return n.reverse(),function t(){for(;n.length;){var a=n.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},e.values=j,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(a,r){return s.type="throw",s.arg=e,n.next=a,r&&(n.method="next",n.arg=t),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var l=a.call(o,"catchLoc"),c=a.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),E(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var a=n.completion;if("throw"===a.type){var r=a.arg;E(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,a){return this.delegate={iterator:j(e),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=t),v}},e}function Jt(t,e,n,a,r,i,o){try{var s=t[i](o),l=s.value}catch(c){return void n(c)}s.done?e(l):Promise.resolve(l).then(a,r)}function Qt(t){return function(){var e=this,n=arguments;return new Promise((function(a,r){var i=t.apply(e,n);function o(t){Jt(i,a,r,o,s,"next",t)}function s(t){Jt(i,a,r,o,s,"throw",t)}o(void 0)}))}}function Yt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function Zt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Yt(Object(n),!0).forEach((function(e){Xt(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Yt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Xt(t,e,n){return e=te(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function te(t){var e=ee(t,"string");return"symbol"===Gt(e)?e:String(e)}function ee(t,e){if("object"!==Gt(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!==Gt(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var ne={components:{btns:S,histogram:kt,ganttChart:Ht,MonacoEditor:c["a"]},data:function(){return{ganttExecutionDate:"",ganttLoading:!1,loading:!1,maxNum:null,name:this.$route.query.name,taskId:this.$route.query.id,content:"",version:"",sqlLoading:!1,dialogVisibleSql:!1,dialogVisible:!1,form:{flinkUrl:"",status:1},taskItem:{},params:{execution_date:"",num:10},options:[],numOptions:[5,10,25,50,100],btnsOptions:[{text:"检查上游",color:"#d7bdf2"},{text:"排队中",color:"#87e0f0"},{text:"运行中",color:"#3782ff"},{text:"成功",color:"#67c23a"},{text:"失败",color:"#f10d15"}],execution_date:"",endDateType:!1,isCheckUpstream:!0,analysisData:{},ganttData:{},mapStatus:1,stopData:{}}},computed:Zt(Zt({},Object(C["c"])(["taskPageOptions"])),{},{comNumOptions:function(){var t=this.maxNum||0,e=JSON.parse(JSON.stringify(this.numOptions));return e.forEach((function(e,n,a){t>e?n===a.length-1&&a.push(t):(a.length=n+1,a.splice(n,1,t))})),e}}),watch:{comNumOptions:{handler:function(t){t.length<=2&&(this.params.num=t[t.length-1])},deep:!0}},mounted:function(){var t=Qt(Bt().mark((function t(){var e,n=this;return Bt().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.taskPageOptions["link".concat(this.name)]){t.next=4;break}Object.keys(this.taskPageOptions["link".concat(this.name)]).forEach((function(t){n[t]=n.taskPageOptions["link".concat(n.name)][t],"analysisData"===t&&!n.taskPageOptions["link".concat(n.name)][t].list&&n.options.length&&n.getData(),"ganttData"===t&&!n.taskPageOptions["link".concat(n.name)][t].list&&n.options.length&&n.getGanttData()})),t.next=15;break;case 4:return t.next=6,this.getTaskHisNum();case 6:return t.next=8,this.getSnapshotList();case 8:return t.next=10,t.sent;case 10:if(e=t.sent,e&&0!==e.length){t.next=13;break}return t.abrupt("return");case 13:this.getData(),this.getGanttData();case 15:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),destroyed:function(){this.SET_TASKPAGEOPTIONS(Zt({tabs:"link".concat(this.name)},this._data))},methods:Zt(Zt({},Object(C["d"])(["SET_TASKPAGEOPTIONS"])),{},{changeDataFn:function(t,e,n,a,r){if(Array.isArray(t))return t.forEach((function(t){t.forEach((function(t){t.forEach((function(t){t[n]===e&&(t[r]=a)}))}))})),t},searchDateChange:function(){0!==this.options.length&&this.getData()},ganttDateChange:function(){this.getGanttData()},loadMore:function(){this.execution_date=this.options.length>0?this.options[this.options.length-1]:"",this.getSnapshotList()},getSnapshotList:function(){var t=this;if(!this.endDateType){var e={name:this.name,execution_date:this.execution_date};return D(e).then((function(e){var n,a=e.data;return t.execution_date?((n=t.options).push.apply(n,Ut(a)),t.execution_date=a[a.length-1],a&&a.length<20&&(t.endDateType=!0),a):(t.options=a||[],t.params.execution_date=t.options[0],t.ganttExecutionDate=t.options[0],a&&a.length<20&&(t.endDateType=!0),a)}))}},getTaskHisNum:function(){var t=this;return L({name:this.name}).then((function(e){var n=e.data;t.maxNum=n||0}))},save:function(){var t=this,e=1===this.mapStatus?this.analysisData.list:this.ganttData.list,n=Zt({name:this.stopData.dagId,executionDate:this.stopData.executionDate},this.form);Object(l["t"])(n).then((function(n){t.dialogVisible=!1,t.$message({type:"success",message:"执行成功"});var a=t.form.status?"success":"failed",r=t.changeDataFn(e,t.stopData.nodeId,"nodeId",a,"state");1===t.mapStatus?t.analysisData.list=r:t.ganttData.list=r}))},getLogs:function(t){Object(l["h"])({id:t.task_id,executionDate:t.executionDate}).then((function(t){var e=t.data,n=e;window.open(n)}))},getSql:function(t){var e=this;this.dialogVisibleSql=!0,this.version=t.version||1,this.sqlLoading=!0,Object(l["g"])({taskId:t.task_id,executionDate:t.executionDate,version:t.version}).then((function(t){var n=t.data;n&&(e.content=n,e.$refs.monaco.setCode(e.content))})).finally((function(){e.sqlLoading=!1}))},stop:function(t){this.stopData=t,this.dialogVisible=!0},repeatCalc:function(t){var e=this;this.$confirm("确定重算?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.saveClear(t)})).catch((function(){}))},saveClear:function(t){var e=this,n=1===this.mapStatus?this.analysisData.list:this.ganttData.list;Object(l["e"])({name:t.dagId,executionDate:t.executionDate,isCheckUpstream:this.isCheckUpstream}).then((function(a){e.$message({type:"success",message:"执行成功"});var r=e.changeDataFn(n,t.nodeId,"nodeId","waiting","state");1===e.mapStatus?e.analysisData.list=r:e.ganttData.list=r}))},handelItem:function(t,e,n){switch(this.taskItem=e,this.mapStatus=n,t){case"repeatCalc":this.repeatCalc(e);break;case"stop":e.flink_url?this.form.flinkUrl=e.flink_url:this.form.flinkUrl="",this.stop(e);break;case"getSql":this.getSql(e);break;case"getLogs":this.getLogs(e);break}},getGanttData:function(){var t=this;this.ganttLoading=!0,this.ganttData={};var e={name:this.name,gantt:1,num:1,execution_date:this.ganttExecutionDate};I(e).then((function(e){var n=e.data;t.ganttData=n})).catch((function(t){console.log(t)})).finally((function(){t.ganttLoading=!1}))},getData:function(){var t=this;this.loading=!0,this.analysisData={};var e=Zt({name:this.name,gantt:0},this.params);I(e).then((function(e){var n=e.data;t.analysisData=n})).catch((function(t){console.log(t)})).finally((function(){t.loading=!1}))}})},ae=ne,re=(n("845a"),Object(y["a"])(ae,Q,Y,!1,null,"48e04fed",null)),ie=re.exports,oe=n("a8c0"),se=n("b893");function le(t){return le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},le(t)}function ce(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function ue(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ce(Object(n),!0).forEach((function(e){de(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ce(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function de(t,e,n){return e=pe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pe(t){var e=fe(t,"string");return"symbol"===le(e)?e:String(e)}function fe(t,e){if("object"!==le(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!==le(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var he={components:{SearchCondition:s["a"],MonacoEditor:c["a"],DAG:oe["a"],ConsanguinityMap:J,LinkAnalysis:ie},data:function(){return{tabItem:"instance",taskId:this.$route.query.id,name:this.$route.query.name,timeRange:[],params:{start_date:"",end_date:"",state:"",pageNum:1,pageSize:30,userId:this.$store.getters["userInfo"].id},total:0,loading:!1,tableData:[],statusCodeList:se["i"],dialogVisible:!1,form:{name:"",executionDate:"",flinkUrl:"",status:1},statusDisabled:!1,multipleSelection:[],dialogVisibleCheck:!1,dialogLoading:!1,errorData:{},isTipDisabled:!1,costLoading:!1,costUrl:"",isShow:!1,isOwner:!0,isOnline:!0,isScanSqlCmd:!0,isScanKibana:!0,isScanSparkUI:!0,templateCode:"",workflowId:0,dialogVisibleClear:!1,isCheckUpstream:!0,execution_date:"",showId:!0,dialogVisibleSql:!1,content:"",version:1,currentCase:{name:this.$route.query.name,executionDate:""},sqlLoading:!1,dialogVisibleRecord:!1,recordLoading:!1,recordList:[]}},computed:ue({},Object(C["c"])(["isAdmin","userInfo"])),created:function(){var t=this;clearTimeout(this.initTimer),this.init(),this.loading=!0,this.params.instanceId=this.$route.query.instanceId,this.getList(),this.initTimer=setInterval((function(){t.getList()}),2e4),this.$nextTick((function(){document.addEventListener("visibilitychange",t.handelGetList)}))},destroyed:function(){document.removeEventListener("visibilitychange",this.handelGetList),clearTimeout(this.initTimer),this.REMOVE_TASKPAGEOPTIONS()},methods:ue(ue({},Object(C["d"])(["REMOVE_TASKPAGEOPTIONS"])),{},{stateColorFn:function(t){var e;switch(t){case"检查上游":e="rgb(215, 189, 242)";break;case"排队中":e="rgb(135, 224, 240)";break;case"运行中":e="rgb(55, 130, 255)";break;case"成功":e="rgb(103, 194, 58)";break;case"失败":e="rgb(241, 13, 21)";break;case"终止检查上游":e="rgb(241, 13, 21)";break;case"等待重试":e="#e6a23c";break;default:break}return e},jumpLog:function(t){if(t.genie_job_url){var e=t.genie_job_url,n=e.startsWith("ks3://"),a=e.startsWith("s3://");n?window.open("/api-gateway/ds_task/task/instanceLog?url="+e,"_blank"):a?window.open("https://joblog.datacake.cloud/"+e.split("pipeline_log/")[1],"_blank"):window.open(e,"_blank")}},handelGetList:function(){var t=this;document.hidden?clearTimeout(this.initTimer):(clearTimeout(this.initTimer),this.getList(),this.initTimer=setInterval((function(){t.getList()}),2e4))},init:function(){},goBack:function(){this.workflowId?this.$router.push("/task/workflow"):this.$router.push("/task/list")},titleKey:function(t){var e=t.recursion?"... ...":t.dagId+"<br/>"+t.executionDate;return t.nodeId===this.errorData.coreTaskId&&(e+="(当前实例)"),t.taskId&&(e=t.taskId+"<br/>"+e),e},nodeClass:function(t){var e;return"waiting"===t.state||"waiting_queue"===t.state?e="waiting-color":"waiting_queue"===t.state?e="waiting-queue":"running"===t.state||"up_for_retry"===t.state?e="running-color":"success"===t.state?e="success-color":"failed"!==t.state&&"termination"!==t.state||(e="failed-color"),!1===t.online&&(e+=" outline-color"),t.nodeId===this.errorData.coreTaskId&&(e+=" bold"),t.recursion&&(e+=" width100"),t.external&&(e+=" dash-border"),e},edit:function(){if(this.workflowId)this.$router.push({path:"/workflow/add",query:{id:this.workflowId,version:this.$route.query.version,taskId:this.taskId}});else{var t=se["n"][this.templateCode];this.$router.push({path:"/task/".concat(t),query:{id:this.taskId}})}},clickPermission:function(){var t=this;Object(l["q"])().then((function(e){t.isShow=!0,localStorage.setItem("permission","1")}))},getList:function(){var t=this;Object.keys(this.params).forEach((function(e){t.params[e]||delete t.params[e]})),Object(l["n"])(ue({taskId:this.taskId,name:this.name},this.params)).then((function(e){var n=e.data;t.loading=!1,t.total=n.result.total,t.tableData=n.result.list,t.isOwner=n.isOwnerOrCollaborator,t.isOnline=n.online,t.templateCode=n.templateCode,t.isScanSqlCmd=n.isScanSqlCmd,t.isScanKibana=n.isScanKibana,t.isScanSparkUI=n.isScanSparkUI,t.workflowId=n.workflowId,n.taskId&&(t.taskId=n.taskId),t.tableData&&t.tableData[0]&&t.tableData[0].flink_url?t.showId=!1:t.showId=!0;var a=t.multipleSelection.map((function(t){return t.execution_date}));t.tableData.forEach((function(e,n){a.includes(e.execution_date)&&t.$nextTick((function(){t.$refs.multipleTable.toggleRowSelection(t.tableData[n],!0)}))}))}))},indexMethod:function(t){return(this.params.pageNum-1)*this.params.pageSize+t+1},handleSelectionChange:function(t){this.multipleSelection=t},reset:function(){this.timeRange=[],this.params={start_date:"",end_date:"",state:"",pageNum:1,pageSize:10},this.getList()},search:function(){this.params.pageNum=1,this.loading=!0,this.getList()},handleCurrentChange:function(t){this.params.pageNum=t,this.loading=!0,this.getList()},handleSizeChange:function(t){this.params.pageSize=t,this.params.pageNum=1,this.loading=!0,this.getList()},changeTime:function(t){t?(this.params.start_date=t[0],this.params.end_date=t[1]):(this.params.start_date="",this.params.end_date="")},isShowTooltip:function(t){var e=t.target.clientWidth,n=t.target.scrollWidth;this.isTipDisabled=!(n>e)},openRecord:function(t){var e=this;this.dialogVisibleRecord=!0,this.recordLoading=!0,Object(l["k"])({taskName:t.name,executionDate:this.$utils.parseTime(t.execution_date,"{y}/{m}/{d} {h}:{i}:{s}.{b}")}).then((function(t){var n=t.data;e.recordList=n,e.recordLoading=!1}))},getSql:function(t){var e=this;this.dialogVisibleSql=!0,this.getList(),this.version=t.version,this.sqlLoading=!0,Object(l["g"])({taskId:this.taskId,executionDate:this.$utils.parseTime(t.execution_date,"{y}/{m}/{d} {h}:{i}:{s}.{b}"),version:t.version}).then((function(t){var n=t.data;e.content=n,e.$refs.monaco.setCode(e.content),e.sqlLoading=!1}))},getUI:function(t){this.$report({userId:this.userInfo&&this.userInfo.userId,time:Date.now(),event:{type:"查看SparkUI"}}),this.getList(),window.open(t.spark_ui)},getLogs:function(t){this.$report({userId:this.userInfo&&this.userInfo.userId,time:Date.now(),event:{type:"查看日志"}}),this.getList(),Object(l["h"])({id:this.taskId,executionDate:this.$utils.parseTime(t.execution_date,"{y}/{m}/{d} {h}:{i}:{s}.{b}")}).then((function(t){var e=t.data,n=e;window.open(n)}))},batchClear:function(){var t=this;if(this.multipleSelection.length){var e=this.multipleSelection.map((function(e){return t.$utils.parseTime(e.execution_date,"{y}/{m}/{d} {h}:{i}:{s}.{b}")})).join(",");this.execution_date=e,this.$confirm("确定批量重算?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.saveClear()})).catch((function(){}))}else this.$message({type:"warning",message:"请至少选择一个任务实例"})},batchStop:function(){var t=this;if(this.multipleSelection.length){var e=[],n=[];this.multipleSelection.forEach((function(a){e.push(t.$utils.parseTime(a.execution_date,"{y}/{m}/{d} {h}:{i}:{s}.{b}")),a.flink_url&&n.push(a.flink_url)})),this.form.name=this.name,this.form.executionDate=e.join(","),this.form.flinkUrl=n.join(","),this.dialogVisible=!0}else this.$message({type:"warning",message:"请至少选择一个任务实例"})},repeatCalc:function(t){var e=this;this.execution_date=this.$utils.parseTime(t.execution_date,"{y}/{m}/{d} {h}:{i}:{s}.{b}"),this.$confirm("确定重算?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.saveClear()})).catch((function(){}))},saveClear:function(){var t=this;Object(l["e"])({name:this.name,executionDate:this.execution_date,isCheckUpstream:this.isCheckUpstream}).then((function(e){t.$message({type:"success",message:"执行成功"}),t.dialogVisibleClear=!1,t.loading=!0,t.$refs.multipleTable.clearSelection(),t.getList()}))},checkError:function(t){var e=this;this.getList(),this.dialogVisibleCheck=!0,this.dialogLoading=!0,this.currentCase={name:t.name,executionDate:this.$utils.parseTime(t.execution_date,"{y}/{m}/{d} {h}:{i}:{s}.{b}")},Object(l["f"])({name:t.name,executionDate:this.$utils.parseTime(t.execution_date,"{y}/{m}/{d} {h}:{i}:{s}.{b}"),state:t.state}).then((function(t){var n=t.data;e.errorData=n,e.dialogLoading=!1}))},gotoOrder:function(){var t=this.$router.resolve({path:"/admin/order/create"}),e=t.href;window.open(e,"_blank")},gotoDetail:function(t){var e=this.$router.resolve({path:"/task/detail",query:{name:t}}),n=e.href;window.open(n,"_blank")},stop:function(t){t.flink_url?this.form.flinkUrl=t.flink_url:this.form.flinkUrl="",this.form.name=t.name,this.form.executionDate=this.$utils.parseTime(t.execution_date,"{y}/{m}/{d} {h}:{i}:{s}.{b}"),this.dialogVisible=!0},save:function(){var t=this;Object(l["t"])(this.form).then((function(e){t.dialogVisible=!1,t.$message({type:"success",message:"执行成功"}),t.loading=!0,t.$refs.multipleTable.clearSelection(),t.getList()}))}})},me=he,ve=(n("3c2b"),n("fcc7"),Object(y["a"])(me,i,o,!1,null,"5c2440b4",null));e["default"]=ve.exports},"2e35":function(t,e,n){},"3c2b":function(t,e,n){"use strict";n("6689")},"3f67":function(t,e,n){"use strict";n("81e4")},"4d2c":function(t,e,n){"use strict";n("2e35")},"4ef0":function(t,e,n){},"5f99":function(t,e,n){},6689:function(t,e,n){},"6d5e":function(t,e,n){"use strict";n.d(e,"n",(function(){return r})),n.d(e,"e",(function(){return i})),n.d(e,"t",(function(){return o})),n.d(e,"o",(function(){return s})),n.d(e,"i",(function(){return l})),n.d(e,"h",(function(){return c})),n.d(e,"l",(function(){return u})),n.d(e,"p",(function(){return d})),n.d(e,"m",(function(){return p})),n.d(e,"r",(function(){return f})),n.d(e,"s",(function(){return h})),n.d(e,"d",(function(){return m})),n.d(e,"a",(function(){return v})),n.d(e,"f",(function(){return g})),n.d(e,"q",(function(){return y})),n.d(e,"g",(function(){return b})),n.d(e,"k",(function(){return _})),n.d(e,"j",(function(){return k})),n.d(e,"b",(function(){return w})),n.d(e,"c",(function(){return x}));var a=n("7258");function r(t){return a["b"].get("/ds_task/taskinstance/page",{params:t})}function i(t){return a["b"].post("/ds_task/taskinstance/clear",null,{params:t})}function o(t){return a["b"].patch("/ds_task/taskinstance/stop",null,{params:t})}function s(t){return a["b"].get("/ds_task/tasksnapshot/page",{params:t})}function l(t){return a["b"].get("/ds_task/task/metricsui",{params:t})}function c(t){return a["b"].get("/ds_task/task/logsui",{params:t})}function u(t){return a["b"].get("/ds_task/task/serviceui",{params:t})}function d(t){return a["b"].get("/ds_task/taskversion/list",{params:t})}function p(t){return a["b"].get("/ds_task/tasksnapshot/list",{params:t})}function f(t){return a["b"].patch("/ds_task/task/start",null,{params:t,timeout:3e5})}function h(t){return a["b"].patch("/ds_task/task/stop",null,{params:t})}function m(t){return a["b"].patch("/ds_task/task/cancel",null,{params:t})}function v(t){return a["b"].post("/ds_task/tasksnapshot/trigger",t)}function g(t){return a["b"].get("/ds_task/taskinstance/diagnose",{params:t})}function y(t){return a["b"].post("/ds_task/dashboard/permission",t)}function b(t){return a["b"].get("/ds_task/taskinstance/exeSql/get",{params:t})}function _(t){return a["b"].post("/pipeline/taskinstance/record",t)}function k(t){return a["b"].get("/ds_task/taskinstance/offline_pages",{params:t})}function w(t){return a["b"].post("/ds_task/taskinstance/batch_clear",t)}function x(t){return a["b"].post("/ds_task/taskinstance/batch_stop",t)}},7809:function(t,e,n){"use strict";n("ae01")},"7ea2":function(t,e,n){"use strict";n.d(e,"m",(function(){return i})),n.d(e,"a",(function(){return o})),n.d(e,"t",(function(){return s})),n.d(e,"l",(function(){return l})),n.d(e,"g",(function(){return c})),n.d(e,"o",(function(){return u})),n.d(e,"p",(function(){return d})),n.d(e,"q",(function(){return p})),n.d(e,"r",(function(){return f})),n.d(e,"s",(function(){return h})),n.d(e,"n",(function(){return m})),n.d(e,"b",(function(){return v})),n.d(e,"f",(function(){return g})),n.d(e,"c",(function(){return y})),n.d(e,"d",(function(){return b})),n.d(e,"e",(function(){return _})),n.d(e,"i",(function(){return k})),n.d(e,"k",(function(){return w})),n.d(e,"j",(function(){return x})),n.d(e,"h",(function(){return S}));var a=n("7258"),r="/ds_task/flinkcluster";function i(t){return a["b"].get("".concat(r,"/page?"),{params:t})}function o(t){return a["b"].post("".concat(r,"/add"),t)}function s(t){return a["b"].put("".concat(r,"/update"),t)}function l(t){return a["b"].get("".concat(r,"/get?id=").concat(t))}function c(t){return a["b"].delete("".concat(r,"/delete"),{params:{id:t}})}function u(t){return a["b"].post("/cluster-service/cloud/resource/add",t,{timeout:6e5})}function d(t){return a["b"].delete("/cluster-service/cloud/resource/delete/".concat(t))}function p(t){return a["b"].get("/cluster-service/cloud/resource/getOne",{params:t})}function f(t){return a["b"].get("/cluster-service/cloud/resource/search",{params:t})}function h(t){return a["b"].post("/cluster-service/cloud/resource/update",t,{timeout:6e5})}function m(t){return a["b"].get("/cluster-service/cloud/resource/getRegion",{params:t})}function v(t){return a["b"].post("/cluster-service/cloud/data/add",t,{timeout:6e5})}function g(t){return a["b"].post("/cluster-service/cloud/data/update",t,{timeout:6e5})}function y(t){return a["b"].delete("/cluster-service/cloud/data/delete",{params:t})}function b(t){return a["b"].get("/cluster-service/cloud/data/getOne",{params:t})}function _(t){return a["b"].get("/cluster-service/cloud/data/search",{params:t})}function k(t){return a["b"].get("/cluster-service/cluster/service/roles",{params:t})}function w(t){return a["b"].get("/cluster-service/cluster/vpcs",{params:t})}function x(t){return a["b"].get("/cluster-service/cluster/subnets",{params:t})}function S(t){return a["b"].get("/cluster-service/cluster/security/groups",{params:t})}},"81e4":function(t,e,n){t.exports={globalFont:"Helvetica Neue,Helvetica,PingFang SC,Avenir,Segoe UI,Arial,sans-serif,Hiragino Sans GB,Microsoft YaHei",navbarHeight:"45px",menuText:"#445782",menuActiveText:"#3782ff",subMenuActiveText:"#3782ff",menuBg:"#f7f9ff",menuHover:"#dfebff",subMenuBg:"#1f2d3d",subMenuHover:"#dfebff",sideBarWidth:"244px"}},"845a":function(t,e,n){"use strict";n("cc23")},"8f46":function(t,e,n){"use strict";n("c834")},9378:function(t,e,n){"use strict";n("9e17")},9710:function(t,e,n){},"9dba":function(t,e,n){t.exports={globalFont:"Helvetica Neue,Helvetica,PingFang SC,Avenir,Segoe UI,Arial,sans-serif,Hiragino Sans GB,Microsoft YaHei",navbarHeight:"45px",menuText:"#445782",menuActiveText:"#3782ff",subMenuActiveText:"#3782ff",menuBg:"#f7f9ff",menuHover:"#dfebff",subMenuBg:"#1f2d3d",subMenuHover:"#dfebff",sideBarWidth:"244px"}},"9e17":function(t,e,n){},a3f9:function(t,e,n){},a8c0:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.shapes&&t.relations?n("div",{ref:"middleCanvas",staticClass:"middleCanvas",on:{dragover:function(t){return t.preventDefault()},pointermove:t.moveLine,pointerup:function(e){return t.endLine()}}},[n("div",{staticClass:"tools"},[n("el-button",{staticClass:"tool",attrs:{size:"mini",type:"primary"},on:{click:t.format}},[t._v("复原")]),t._v(" "),n("el-input-number",{staticClass:"tool",attrs:{size:"mini",placeholder:"缩放",min:10,max:300,step:10},model:{value:t.layerPos.z,callback:function(e){t.$set(t.layerPos,"z",e)},expression:"layerPos.z"}})],1),t._v(" "),n("Layer",{attrs:{x:t.layerPos.x,y:t.layerPos.y,z:t.layerPos.z},on:{"update:x":function(e){return t.$set(t.layerPos,"x",e)},"update:y":function(e){return t.$set(t.layerPos,"y",e)},"update:z":function(e){return t.$set(t.layerPos,"z",e)}}},[t._l(t.depTree,(function(e,a){return n("Shape",{key:a,staticClass:"shape",attrs:{x:e.x,y:e.y},on:{"update:x":function(n){return t.$set(e,"x",n)},"update:y":function(n){return t.$set(e,"y",n)},endonshape:function(n){return t.endLine(e)}}},[n("Task",{class:t.nodeClass(e),attrs:{id:"string"===typeof t.options.titleKey?e[t.options.titleKey]:"function"===typeof t.options.titleKey?t.options.titleKey(e):e[t.options.idKey],url:t.options.jumpUrl(e)}}),t._v(" "),n("div",{staticClass:"port"}),t._v(" "),n("div",{staticClass:"shape-actions",on:{pointerdown:function(t){t.stopPropagation(),t.preventDefault()}}},[t._t("default",null,{data:e,dep:t.depTree})],2)],1)})),t._v(" "),t._l(t.lines,(function(t,e){return n("VLine",{key:"line-"+e,attrs:{start:t.start,end:t.end,dashed:t.dashed}})}))],2)],1):t._e()},r=[],i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("g",[n("path",{attrs:{d:t.d,"marker-end":"url(#normalTriangle)",fill:"none",stroke:"#5f95ff","stroke-width":"2","stroke-dasharray":t.dashed?"3 2":""}}),t._v(" "),t.dragging?n("path",{attrs:{d:t.dd,"marker-end":"url(#normalTriangle)",fill:"none",stroke:"#5f95ff","stroke-width":"2","stroke-dasharray":"3 2"}}):t._e()])},o=[];function s(t,e){return p(t)||d(t,e)||c(t,e)||l()}function l(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(t,e){if(t){if("string"===typeof t)return u(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,e):void 0}}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function d(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var a,r,i,o,s=[],l=!0,c=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=i.call(n)).done)&&(s.push(a.value),s.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return s}}function p(t){if(Array.isArray(t))return t}var f={},h={imLine:f,props:{start:{required:!0,type:Object,default:function(){return{x:0,y:0}}},end:{required:!0,type:Object,default:function(){return{x:0,y:0}}},dashed:{type:Boolean,default:!1},darggable:{type:Boolean,default:!0}},data:function(){return{dragging:!1}},computed:{d:function(){var t=Math.max(30,Math.abs(this.end.x-this.start.x)/3),e=0;return"M".concat(this.start.x," ").concat(this.start.y," C").concat(this.start.x+t,",").concat(this.start.y+e," ").concat(this.end.x-t,",").concat(this.end.y-e," ").concat(this.end.x,",").concat(this.end.y)},dd:function(){var t=Math.max(30,Math.abs(this.end.x-this.start.x)/3),e=0;return"M".concat(this.start.x," ").concat(this.start.y," C").concat(this.start.x+t,",").concat(this.start.y+e," ").concat(this.end.x-t,",").concat(this.end.y-e," ").concat(this.end.x,",").concat(this.end.y)}},methods:{pointerDown:function(t){this.dragging=!0},pointerMove:function(t){var e=s(this.startPos,2),n=e[0],a=e[1];this.$emit("update:x",this.x+t.x-n),this.$emit("update:y",this.y+t.y-a),this.startPos=[t.x,t.y]},pointerUp:function(t){this.dragging=!1}}},m=h,v=(n("0e59"),n("2877")),g=Object(v["a"])(m,i,o,!1,null,"41cb56fe",null),y=g.exports,b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"shape",class:{active:t.active,disabled:t.disabled},style:t.styl,on:{pointerdown:function(e){return e.stopPropagation(),e.preventDefault(),t.chooseShape(e)},pointerup:function(e){return e.stopPropagation(),e.preventDefault(),t.endOnShape(e)}}},[t._t("default")],2)},_=[];function k(t,e){return O(t)||C(t,e)||x(t,e)||w()}function w(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function x(t,e){if(t){if("string"===typeof t)return S(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(t,e):void 0}}function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function C(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var a,r,i,o,s=[],l=!0,c=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=i.call(n)).done)&&(s.push(a.value),s.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return s}}function O(t){if(Array.isArray(t))return t}var L={target:null},D={props:{x:{type:Number,required:!0,default:0},y:{type:Number,required:!0,default:0},disabled:{type:Boolean,default:!1}},data:function(){return{currShape:L,tx:0,ty:0}},computed:{styl:function(){return"top:".concat(this.y,"px;left:").concat(this.x,"px;")},active:function(){return L.target===this}},beforeDestroy:function(){L.target===this&&(L.target=null)},methods:{endOnShape:function(){this.disabled||(L.target===this?this.releaseShape():this.$emit("endonshape"))},chooseShape:function(t){this.disabled||(this.addEvts(),L.target=this,this.startPos=[t.x,t.y])},moveShape:function(t){var e=k(this.startPos,2),n=e[0],a=e[1];this.$emit("update:x",this.x+t.x-n),this.$emit("update:y",this.y+t.y-a),this.startPos=[t.x,t.y]},releaseShape:function(){this.freeEvts(),L.target=null,this.startPos=null},addEvts:function(){document.addEventListener("pointermove",this.moveShape,!0),document.addEventListener("pointerup",this.releaseShape,!0)},freeEvts:function(){document.removeEventListener("pointermove",this.moveShape,!0),document.removeEventListener("pointerup",this.releaseShape,!0)}}},E=D,I=(n("8f46"),Object(v["a"])(E,b,_,!1,null,"55b5b8fc",null)),j=I.exports,T=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"task"},[t.url?n("a",{staticClass:"label url",domProps:{innerHTML:t._s(t.id)},on:{click:t.jump}}):n("span",{staticClass:"label",domProps:{innerHTML:t._s(t.id)}})])},P=[],N={props:{id:{required:!0,type:String,default:function(){return""}},url:{type:String,default:""}},computed:{logo:function(){return"https://gw.alipayobjects.com/zos/bmw-prod/2010ac9f-40e7-49d4-8c4a-4fcf2f83033b.svg"}},methods:{jump:function(){var t=this.id.split("<br")[0],e=this.id.split("<br/>")[1],n=this.$router.resolve({path:this.url,query:{id:t,name:e}}).href;window.open(n,"_blank")}}},A=N,$=(n("e935"),Object(v["a"])(A,T,P,!1,null,"4e702724",null)),F=$.exports,M=n("2638"),q=n.n(M);function H(t,e){return z(t)||K(t,e)||U(t,e)||G()}function G(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function U(t,e){if(t){if("string"===typeof t)return R(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?R(t,e):void 0}}function R(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function K(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var a,r,i,o,s=[],l=!0,c=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(a=i.call(n)).done)&&(s.push(a.value),s.length!==e);l=!0);}catch(t){c=!0,r=t}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw r}}return s}}function z(t){if(Array.isArray(t))return t}var V,W,B={props:{x:{required:!0,type:Number,default:0},y:{required:!0,type:Number,default:0},z:{required:!0,type:Number,default:0}},beforeDestroy:function(){this.freeEvts()},methods:{scroll:function(t){var e=t.deltaY,n=t.deltaX;t.preventDefault(),t.stopPropagation(),this.$emit("update:x",this.x-n),this.$emit("update:y",this.y-e)},pointerdown:function(t){this.disabled||(this.addEvts(),this.startPos=[t.x,t.y])},pointermove:function(t){var e=H(this.startPos,2),n=e[0],a=e[1];this.$emit("update:x",this.x+t.x-n),this.$emit("update:y",this.y+t.y-a),this.startPos=[t.x,t.y]},pointerup:function(){this.freeEvts(),this.startPos=null},addEvts:function(){document.addEventListener("pointermove",this.pointermove,!0),document.addEventListener("pointerup",this.pointerup,!0)},freeEvts:function(){document.removeEventListener("pointermove",this.pointermove,!0),document.removeEventListener("pointerup",this.pointerup,!0)}},render:function(t){var e,n=[],a=[];return null==(e=this.$slots.default)||e.forEach((function(t){t.componentOptions&&t.componentOptions.Ctor===y._Ctor[0]?n.push(t):a.push(t)})),t("div",q()([{class:"layer"},{on:{wheel:this.scroll.bind(this),pointerdown:this.pointerdown.bind(this)}}]),[t("svg",{attrs:{version:"1.1",xmlns:"http://www.w3.org/2000/svg",transform:"scale(".concat(this.z/100,") translate(").concat(this.x,", ").concat(this.y,")")},class:"lines-painter"},[t("defs",[t("marker",{attrs:{id:"normalTriangle",viewBox:"0 0 20 20",refX:"0",refY:"10",markerWidth:"3.5",markerHeight:"3.5",orient:"auto"}},[t("path",{attrs:{d:"M 0 0 L 20 10 L 0 20 z",fill:"#5f95ff"}})])]),n]),t("div",{class:"inner",style:{transform:"scale(".concat(this.z/100,") translate(").concat(this.x,"px, ").concat(this.y,"px)")}},[a]),t("div",{class:"map"},[t("div",{class:"inner",style:{transform:"scale(.5) translate(".concat(this.x,"px, ").concat(this.y,"px)")}},[a])])])}},J=B,Q=(n("4d2c"),Object(v["a"])(J,V,W,!1,null,"23b5a7a6",null)),Y=Q.exports;function Z(t){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Z(t)}function X(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function tt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?X(Object(n),!0).forEach((function(e){et(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function et(t,e,n){return e=nt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nt(t){var e=at(t,"string");return"symbol"===Z(e)?e:String(e)}function at(t,e){if("object"!==Z(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var a=n.call(t,e||"default");if("object"!==Z(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var rt=105,it={components:{Shape:j,Task:F,Layer:Y,VLine:y},props:{relations:{type:Array,reauired:!0,default:function(){return[]}},shapes:{type:Array,reauired:!0,default:function(){return[]}},options:{type:Object,default:function(){return{idKey:"id",sourceKey:"source",targetKey:"target",titleKey:"id",jumpUrl:""}}},nodeClass:{type:Function,default:function(){}}},data:function(){return{root:null,layerPos:{x:0,y:0,z:100}}},computed:{name2Shape:function(){var t=this;return this.shapes.reduce((function(e,n){return tt(tt({},e),{},et({},n[t.options.idKey],n[t.options.idKey]in e?e[n[t.options.idKey]]:n))}),{})},depTree:function(){var t=this,e=105,n=40,a=40,r=200,i={},o={},s={};this.shapes.forEach((function(e){s[e[t.options.idKey]]=e})),this.relations.forEach((function(e){var n=e[t.options.sourceKey],a=e[t.options.targetKey];e.type;i[n]=s[a],o[a]=o[a]||[],o[a].push(s[n])}));for(var l,c=new Set(Object.keys(i)),u=Object.keys(s),d=0;d<u.length;++d)c.has(u[d])||(l=u[d]);var p,f,h,m,v,g=0,y=[s[l]],b=[],_=[];while(y.length>0){for(var k=0;k<y.length;++k)if(f=y[k],f.level=g,o[f[this.options.idKey]]){for(var w=[],x=o[f[this.options.idKey]],S=0;S<x.length;++S)o[x[S][this.options.idKey]]?b.push(x[S]):w.push(x[S]);b=b.concat(w)}_=y.concat(_),p=y,y=b,b=p,b.length=0,++g}for(var C=0;C<_.length;++C)f=_[C],h=(g-f.level-1)*(e+r),m=this.getPositionY(f,o),0!==C&&f.level===_[C-1].level||(v=0),void 0===m&&(m=v+n+a),v=m,f.x=h,f.y=m;return this.root=s[l],s},lines:function(){var t=this;return this.relations.map((function(e){var n=e[t.options.sourceKey],a=e[t.options.targetKey],r=e.type,i=t.depTree[n],o=t.depTree[a];if(i&&o){var s=i.x+rt,l=o.x-rt-4;return{start:{x:s,y:i.y},end:{x:l,y:o.y},dashed:!1===r}}})).filter((function(t){return!!t}))}},mounted:function(){this.format()},methods:{format:function(){var t=this;this.$nextTick((function(){var e=t.$refs.middleCanvas;e&&e.clientWidth>0&&e.clientHeight>0&&(t.layerPos.x=.75*e.clientWidth-t.root.x,t.layerPos.y=.5*e.clientHeight-t.root.y),t.layerPos.z=100}))},endLine:function(t){if(t&&"task"===t.type&&this.startPort&&!this.depTree[this.startPort.name].deps[t.name]&&!this.depTree[this.startPort.name].des[t.name]){var e=this.getDataSetData(this.startPort.name);this.name2Shape[t.name].task.inputDataset[0].metadata.type===e.metadata.type?(this.addRelation({s:this.startPort.name,t:t.name}),this.name2Shape[t.name].task.inputDataset.push(e)):this.$message.error("".concat(t.name,"不接受").concat(e.metadata.type,"类型的输入"))}this.startPort=null},moveLine:function(t){var e=t.currentTarget.getBoundingClientRect(),n=t.clientX-e.left-this.layerPos.x,a=t.clientY-e.top-this.layerPos.y;this.curPos={x:n,y:a}},getPositionY:function(t,e){var n;if(t){var a=e[t[this.options.idKey]];if(a&&a.length){for(var r=a[0].y,i=a[0].y,o=1;o<a.length;++o)a[o].y<r&&(r=a[o].y),a[o].y>i&&(i=a[o].y);n=(r+i)/2}}return n}}},ot=it,st=(n("7809"),Object(v["a"])(ot,a,r,!1,null,"9aa24cfe",null));e["a"]=st.exports},ac7f:function(t,e,n){"use strict";n("c6c3")},ae01:function(t,e,n){},b373:function(t,e,n){"use strict";n("4ef0")},b893:function(t,e,n){"use strict";n.d(e,"n",(function(){return c})),n.d(e,"c",(function(){return d})),n.d(e,"j",(function(){return p})),n.d(e,"m",(function(){return f})),n.d(e,"o",(function(){return h})),n.d(e,"a",(function(){return m})),n.d(e,"i",(function(){return v})),n.d(e,"k",(function(){return g})),n.d(e,"l",(function(){return _})),n.d(e,"h",(function(){return k})),n.d(e,"e",(function(){return w})),n.d(e,"d",(function(){return x})),n.d(e,"b",(function(){return S})),n.d(e,"g",(function(){return C})),n.d(e,"f",(function(){return O}));var a=n("7ea2"),r=n("4360");function i(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */i=function(){return e};var t,e={},n=Object.prototype,a=n.hasOwnProperty,r=Object.defineProperty||function(t,e,n){t[e]=n.value},s="function"==typeof Symbol?Symbol:{},l=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function d(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{d({},"")}catch(t){d=function(t,e,n){return t[e]=n}}function p(t,e,n,a){var i=e&&e.prototype instanceof b?e:b,o=Object.create(i.prototype),s=new T(a||[]);return r(o,"_invoke",{value:D(t,n,s)}),o}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=p;var h="suspendedStart",m="suspendedYield",v="executing",g="completed",y={};function b(){}function _(){}function k(){}var w={};d(w,l,(function(){return this}));var x=Object.getPrototypeOf,S=x&&x(x(P([])));S&&S!==n&&a.call(S,l)&&(w=S);var C=k.prototype=b.prototype=Object.create(w);function O(t){["next","throw","return"].forEach((function(e){d(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function n(r,i,s,l){var c=f(t[r],t,i);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"==o(d)&&a.call(d,"__await")?e.resolve(d.__await).then((function(t){n("next",t,s,l)}),(function(t){n("throw",t,s,l)})):e.resolve(d).then((function(t){u.value=t,s(u)}),(function(t){return n("throw",t,s,l)}))}l(c.arg)}var i;r(this,"_invoke",{value:function(t,a){function r(){return new e((function(e,r){n(t,a,e,r)}))}return i=i?i.then(r,r):r()}})}function D(e,n,a){var r=h;return function(i,o){if(r===v)throw new Error("Generator is already running");if(r===g){if("throw"===i)throw o;return{value:t,done:!0}}for(a.method=i,a.arg=o;;){var s=a.delegate;if(s){var l=E(s,a);if(l){if(l===y)continue;return l}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(r===h)throw r=g,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);r=v;var c=f(e,n,a);if("normal"===c.type){if(r=a.done?g:m,c.arg===y)continue;return{value:c.arg,done:a.done}}"throw"===c.type&&(r=g,a.method="throw",a.arg=c.arg)}}}function E(e,n){var a=n.method,r=e.iterator[a];if(r===t)return n.delegate=null,"throw"===a&&e.iterator.return&&(n.method="return",n.arg=t,E(e,n),"throw"===n.method)||"return"!==a&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+a+"' method")),y;var i=f(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,y;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,y):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,y)}function I(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function j(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function T(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(I,this),this.reset(!0)}function P(e){if(e||""===e){var n=e[l];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function n(){for(;++r<e.length;)if(a.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(o(e)+" is not iterable")}return _.prototype=k,r(C,"constructor",{value:k,configurable:!0}),r(k,"constructor",{value:_,configurable:!0}),_.displayName=d(k,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===_||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,k):(t.__proto__=k,d(t,u,"GeneratorFunction")),t.prototype=Object.create(C),t},e.awrap=function(t){return{__await:t}},O(L.prototype),d(L.prototype,c,(function(){return this})),e.AsyncIterator=L,e.async=function(t,n,a,r,i){void 0===i&&(i=Promise);var o=new L(p(t,n,a,r),i);return e.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},O(C),d(C,u,"Generator"),d(C,l,(function(){return this})),d(C,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var a in e)n.push(a);return n.reverse(),function t(){for(;n.length;){var a=n.pop();if(a in e)return t.value=a,t.done=!1,t}return t.done=!0,t}},e.values=P,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(j),!e)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(a,r){return s.type="throw",s.arg=e,n.next=a,r&&(n.method="next",n.arg=t),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var l=a.call(o,"catchLoc"),c=a.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),j(n),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var a=n.completion;if("throw"===a.type){var r=a.arg;j(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,a){return this.delegate={iterator:P(e),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=t),y}},e}function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e,n,a,r,i,o){try{var s=t[i](o),l=s.value}catch(c){return void n(c)}s.done?e(l):Promise.resolve(l).then(a,r)}function l(t){return function(){var e=this,n=arguments;return new Promise((function(a,r){var i=t.apply(e,n);function o(t){s(i,a,r,o,l,"next",t)}function l(t){s(i,a,r,o,l,"throw",t)}o(void 0)}))}}var c={StreamingSQL:"step2FlinkSQL",StreamingJAR:"step2FlinkJar",Metis2Hive:"step2Metis",MysqlCDC2Hive:"step2CDC",Mysql2Lakehouse:"step2Hive",Mysql2Hive:"step2Hive",File2Lakehouse:"step2File",Mysql2Hudi:"step2Hudi",Hive2Hive:"step2HiveSQL",DataMigration:"step2HCCloud",SPARKJAR:"step2SparkJar",Hive2Sharestore:"step2ShareStore",Hive2Clickhouse:"step2ClickHouse",Hive2Mysql:"step2MySql",Hive2Doris:"step2Doris",PythonShell:"step2Shell",Db2Hive:"step2DB",Hive2Redis:"step2Redis",Hive2Redshift:"step2Redshift",MergeSmallFiles:"step2FileMerge",Hive2File:"step2Hive2File",TfJob:"step2TrainingModel"},u=r["a"].getters["isCloud"],d=[{title:"数据接入 Data Ingestion",list:[{label:"DB -> Lakehouse",templateCode:"step2Hive",path:"step2Hive",content:"该模板适用于拉取各类关系型DataBase数据到Lakehouse湖仓，提供离线全量和实时增量同步方案。"},{label:"File -> Lakehouse",templateCode:"File2Lakehouse",path:"step2File",content:"该模板适用于将对象存储(如AWS S3、OBS、KS3等)或分布式文件存储(如HDFS等)中存储的各种格式(如csv、json、paruet、orc等)的文件数据同步到Lakehouse湖仓中。"},{label:"Kafka -> Lakehouse",templateCode:"Metis2Hive",path:"step2Metis",content:"Kafka2Lakehouse统一模板，对接Kafka/Metis，透传至Lakehouse表。",isGray:!0}]},{title:"湖仓处理 Data Transformation",list:[{label:"Lakehouse -> Lakehouse",templateCode:"Hive2Hive",path:"step2HiveSQL",content:"基于Hive SQL/Spark SQL数据处理，不同的执行引擎语法略有差异，请参考官方语法。"}]},{title:"数据导出 Data Digestion",list:[{label:"Lakehouse -> Doris",templateCode:"Hive2Doris",path:"step2Doris",content:"用于数据的导出处理，可将数据从Lakehouse导出到Doris中。"},{label:"Lakehouse -> File",templateCode:"Hive2File",path:"step2Hive2File",content:"用于Lakehouse数据导出到文件的任务，可以支持以邮件的方式将文件发送给用户。"},{label:"Lakehouse -> MySQL",templateCode:"Hive2Mysql",path:"step2MySql",content:"用于数据的导出处理，可将数据从Lakehouse导出到MySQL中。"},{label:"Lakehouse -> ClickHouse",content:"用于数据的导出处理，可将数据从Lakehouse导出到ClickHouse中。",isGray:!0},{label:"Lakehouse -> Redshift",content:"适用于将S3文件中结构化数据映射到Aws Redshift表中的业务场景。",isGray:!0}]}],p=[{title:"数据接入 Data Ingestion",list:[{label:"Spark Jar",templateCode:"SPARKJAR",path:"step2SparkJar",content:"用于湖仓数据的基于Jar包的数据处理，一般用于更加复杂的数据处理逻辑。"},{label:"Shell/Python脚本",templateCode:"PythonShell",path:"step2Shell",content:"用于python和shell脚本任务的执行。"}]},{title:"湖仓处理 Lakehouse ETL",list:[{label:"Flink Jar",templateCode:"StreamingJAR",path:"step2FlinkJar",content:"通过上传Flink Jar包的方式，进行流式数据处理。",isGray:!0},{label:"Flink SQL",templateCode:"StreamingSQL",path:"step2FlinkSQL",content:"流式任务的统一模板，基于SQL查询的方式（Flink SQL）进行数据处理。Metis日志处理，统一归集到此处通过SQL的方式进行处理。",isGray:!0}]}],f={CREATED:"#8896B3",INITIALIZING:"rgba(146, 112, 202, 0.8)",SCHEDULED:"rgba(146, 112, 202, 0.8)",RUNNING:"#409EFF",RESTARTING:"#C6E2FF",RECONCILING:"#41F3D8",SUSPENDED:"#67C23A",CANCELED:"#E6A23C",CANCELLING:"#E6A23C",FAILED:"#FF5656",SUCCESS:"#67C23A",FINISHED:"#67C23A",FAILLING:"#FCE2E2"},h={CREATED:"#8896B3",INITIALIZING:"rgba(146, 112, 202, 0.8)",SCHEDULED:"rgba(146, 112, 202, 0.8)",RUNNING:"#409EFF",CANCELED:"#E6A23C",FAILED:"#FF5656",SUCCESS:"#67C23A",SUSPENDED:"#67C23A",FINISHED:"#67C23A",OFFLINE:"#dcdfe6"},m={CREATED:"已创建",INITIALIZING:"已上线",SCHEDULED:"已上线",RUNNING:"执行中",CANCELED:"已取消",FAILED:"失败",SUCCESS:"成功",SUSPENDED:"成功",FINISHED:"成功",OFFLINE:"已下线"},v={waiting:"检查上游",termination:"终止检查上游",waiting_queue:"排队中",running:"运行中",up_for_retry:"等待重试",failed:"失败",success:"成功"},g={INITIALIZING:"初始化中",CREATED:"已创建",RUNNING:"运行中",FAILING:"失败中",CANCELLING:"取消中",RESTARTING:"重启中",RECONCILING:"调度中",FAILED:"已失败",CANCELED:"已下线",FINISHED:"已完成",SUSPENDED:"已停止"};function y(){return b.apply(this,arguments)}function b(){return b=l(i().mark((function t(){var e,n;return i().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(a["r"])();case 2:return e=t.sent,n=e.data,t.abrupt("return",n.list.map((function(t){return{label:t.description,value:t.regionAlias}})));case 5:case"end":return t.stop()}}),t)}))),b.apply(this,arguments)}var _=u?y():new Promise((function(t,e){t([{label:"AWS 美东",value:"ue1"},{label:"AWS 新加坡",value:"sg1"},{label:"华为 新加坡",value:"sg2"}])})),k=[{label:"P0",value:0},{label:"P1",value:1},{label:"P2",value:2},{label:"P3",value:3}],w={GENERAL:"一般",SENIOR:"紧急"};function x(t,e){var n="";return function(a){n&&clearTimeout(n),n=setTimeout((function(){t(a)}),e)}}function S(t){if(null==t)return null;var e=Array.isArray(t)?[]:{};for(var n in t)t.hasOwnProperty(n)&&("object"===o(t[n])?e[n]=S(t[n]):e[n]=t[n]);return e}var C=[{package:"awscli",version:"1.16.263"},{package:"backports.ssl-match-hostname",version:"3.5.0.1"},{package:"boto",version:"2.49.0"},{package:"boto3",version:"1.9.220"},{package:"botocore",version:"1.12.253"},{package:"certifi",version:"2020.12.5"},{package:"chardet",version:"3.0.4"},{package:"colorama",version:"0.4.1"},{package:"docutils",version:"0.15.2"},{package:"futures",version:"3.3.0"},{package:"idna",version:"2.10"},{package:"iniparse",version:"0.4"},{package:"ipaddress",version:"1.0.16"},{package:"jmespath",version:"0.9.5"},{package:"kitchen",version:"1.1.1"},{package:"pip",version:"20.3.3"},{package:"pyasn1",version:"0.4.8"},{package:"pycurl",version:"7.19.0"},{package:"pygobject",version:"3.22.0"},{package:"pygpgme",version:"0.3"},{package:"pyliblzma",version:"0.5.3"},{package:"python-dateutil",version:"2.8.1"},{package:"pyxattr",version:"0.5.1"},{package:"PyYAML",version:"5.1.2"},{package:"requests",version:"2.24.0"},{package:"rsa",version:"3.4.2"},{package:"s3transfer",version:"0.2.1"},{package:"setuptools",version:"0.9.8"},{package:"six",version:"1.15.0"},{package:"urlgrabber",version:"3.10"},{package:"urllib3",version:"1.25.11"},{package:"yum-metadata-parser",version:"1.1.4"}],O={sg2:"swr.ap-southeast-3.myhuaweicloud.com/shareit-bdp/airflow-business:script_task",ue1:"848318613114.dkr.ecr.us-east-1.amazonaws.com/bdp/airflow:script_task",sg1:"848318613114.dkr.ecr.ap-southeast-1.amazonaws.com/bdp/workflow:script_task"}},c5a7:function(t,e,n){},c6c3:function(t,e,n){},c834:function(t,e,n){},cac8:function(t,e,n){"use strict";n("1c2f")},cc23:function(t,e,n){},cf58:function(t,e,n){"use strict";n("0feb")},dc43:function(t,e,n){"use strict";n("19a1")},e935:function(t,e,n){"use strict";n("17bc")},fc84:function(t,e,n){"use strict";n("c5a7")},fcc7:function(t,e,n){"use strict";n("9dba")}}]);