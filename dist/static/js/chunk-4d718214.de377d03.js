(window["webpackJsonp_datastudio-web"]=window["webpackJsonp_datastudio-web"]||[]).push([["chunk-4d718214"],{"0179":function(e,t,a){"use strict";a("f182")},"104b":function(e,t,a){},"271a":function(e,t,a){"use strict";a("104b")},"958a":function(e,t,a){"use strict";a("f9de")},adb2:function(e,t,a){},afb0:function(e,t,a){"use strict";a("adb2")},b164:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",{staticClass:"order-list box-card-container"},[a("div",{staticClass:"search-condition-wrap"},[a("div",{staticClass:"search-group"},[a("search-condition",{attrs:{label:"工单编号","label-class":"search-label"}},[a("el-input",{staticClass:"search-box",attrs:{placeholder:"工单编号",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.params.feedbackId,callback:function(t){e.$set(e.params,"feedbackId","string"===typeof t?t.trim():t)},expression:"params.feedbackId"}})],1),e._v(" "),a("search-condition",{attrs:{label:"产品模块","label-class":"search-label"}},[a("el-select",{staticClass:"search-box",attrs:{placeholder:"产品模块",clearable:""},model:{value:e.params.module,callback:function(t){e.$set(e.params,"module",t)},expression:"params.module"}},e._l(e.moduleList,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),e._v(" "),a("search-condition",{attrs:{label:"问题分类","label-class":"search-label"}},[a("el-select",{staticClass:"search-box",attrs:{placeholder:"问题分类",clearable:""},model:{value:e.params.type,callback:function(t){e.$set(e.params,"type",t)},expression:"params.type"}},e._l(e.typeList,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),e._v(" "),a("search-condition",{attrs:{label:"提交时间","label-class":"search-label"}},[a("el-date-picker",{staticClass:"search-box",staticStyle:{width:"225px"},attrs:{type:"daterange","range-separator":"至","start-placeholder":"开始日","end-placeholder":"结束日","value-format":"yyyy-MM-dd","picker-options":e.pickerOptions},on:{change:e.changeTime},model:{value:e.timeRange,callback:function(t){e.timeRange=t},expression:"timeRange"}})],1),e._v(" "),a("search-condition",{attrs:{label:"工单状态","label-class":"search-label"}},[a("el-select",{staticClass:"search-box",attrs:{placeholder:"工单状态",clearable:""},model:{value:e.params.status,callback:function(t){e.$set(e.params,"status",t)},expression:"params.status"}},e._l(e.statusList,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),a("search-condition",{attrs:{label:"提交人","label-class":"search-label"}},[a("el-input",{staticClass:"search-box",attrs:{placeholder:"提交人",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.params.createBy,callback:function(t){e.$set(e.params,"createBy","string"===typeof t?t.trim():t)},expression:"params.createBy"}})],1),e._v(" "),a("search-condition",{attrs:{label:"处理人","label-class":"search-label"}},[a("el-input",{staticClass:"search-box",attrs:{placeholder:"处理人",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search(t)}},model:{value:e.params.handleBy,callback:function(t){e.$set(e.params,"handleBy","string"===typeof t?t.trim():t)},expression:"params.handleBy"}}),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.search}},[e._v("查询")]),e._v(" "),e.isAdmin?a("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.exportData}},[e._v("下载")]):e._e()],1)],1),e._v(" "),a("div",{staticClass:"btns"},[a("el-button",{staticClass:"create",attrs:{type:"primary",size:"small",plain:""},on:{click:e.create}},[e._v("新建工单")])],1)]),e._v(" "),a("div",{staticClass:"table-wrap"},[a("table-page",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"table-data":e.data,"column-data":e.columnData,"is-show-index":!1,"table-height":"calc(100vh - 240px)",total:e.total,"page-num":e.params.pageNum,"page-size":e.params.pageSize},on:{changePage:e.changePage}},[a("el-table-column",{attrs:{fixed:"right",label:"操作","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){return e.see(t.row)}}},[e._v("详情")]),e._v(" "),e.isAdmin?a("el-button",{attrs:{type:"text",size:"mini",disabled:["SOLVED","SCORED","ACCEPTED"].includes(t.row.status)},on:{click:function(a){return e.accept(t.row)}}},[e._v("受理")]):e._e(),e._v(" "),e.isAdmin?a("el-button",{attrs:{type:"text",size:"mini",disabled:["SOLVED","SCORED"].includes(t.row.status)},on:{click:function(a){return e.transfer(t.row)}}},[e._v("转让")]):e._e(),e._v(" "),a("el-button",{attrs:{type:"text",size:"mini",disabled:!t.row.sendCloseFlag||!e.isAdmin&&"UN_ACCEPT"!==t.row.status||e.isAdmin&&["SOLVED","SCORED"].includes(t.row.status)},on:{click:function(a){return e.close(t.row)}}},[e._v("关闭")])]}}])})],1)],1),e._v(" "),a("win-see-order",{ref:"seeOrder",on:{save:e.getList}}),e._v(" "),a("win-transfer",{ref:"transferOrder",on:{save:e.getList}}),e._v(" "),a("win-close-order",{ref:"closeOrder",on:{save:e.getList}}),e._v(" "),a("win-score-order",{ref:"scoreOrder",on:{save:e.getList}})],1)},n=[],r=a("88c9"),i=a("6041"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{staticClass:"order-dialog",attrs:{title:"工单详情",visible:e.dialogVisible,width:"900px","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t},close:e.resetForm}},[a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("el-descriptions",{attrs:{title:"基础信息",column:4,"label-class-name":"des-label"}},[a("template",{slot:"extra"},[e.isEdit?[a("i",{staticClass:"el-icon-refresh-left toolbar-icon",attrs:{title:"取消"},on:{click:function(t){e.isEdit=!1}}}),e._v(" "),a("svg-icon",{staticClass:"toolbar-icon",attrs:{"icon-class":"save",title:"保存"},on:{click:e.save}})]:a("i",{staticClass:"el-icon-edit toolbar-icon",attrs:{title:"编辑"},on:{click:e.edit}})],2),e._v(" "),a("el-descriptions-item",{attrs:{label:"工单编号"}},[e._v(e._s(e.data.id))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"工单提出人"}},[e._v(e._s(e.data.createBy))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"值班人"}},[e._v(e._s(e.data.chargePerson))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"处理人"}},[e._v(e._s(e.data.handleBy||"-"))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"分值"}},[e._v(e._s(e.data.score||"-"))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"工单状态"}},[e._v(e._s(e.statusList[e.data.status]))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"所属产品"}},[e.isEdit?a("el-select",{attrs:{placeholder:"请选择所属产品",size:"mini"},model:{value:e.newModule,callback:function(t){e.newModule=t},expression:"newModule"}},e._l(e.moduleList,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1):[e._v(e._s(e.data.module))]],2),e._v(" "),a("el-descriptions-item",{attrs:{label:"问题分类"}},[e.isEdit?a("el-select",{attrs:{placeholder:"请选择问题分类",size:"mini"},model:{value:e.newType,callback:function(t){e.newType=t},expression:"newType"}},e._l(e.typeList,(function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})})),1):[e._v(e._s(e.data.type))]],2),e._v(" "),a("el-descriptions-item",{attrs:{label:"问题标题"}},[e._v(e._s(e.data.title))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"任务ID"}},[e._v(e._s(e.data.taskId))]),e._v(" "),a("el-descriptions-item",{attrs:{label:"紧急程度"}},[e._v(e._s(e.data.feedbackLevel||"一般"))])],2)],1),e._v(" "),a("el-card",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"chat-wrap",attrs:{id:"chat-wrap"}},e._l(e.data.feedbackProcessItemList,(function(t){return a("chat-dialog",{key:t.id,attrs:{"chat-left":!t.isCurrentUser,user:t.createBy}},[e._l(t.attachmentList,(function(t){return a("div",{key:t.id},[/\.(jpg|jpeg|png)$/.test(t.fileName)?a("big-img",{attrs:{"img-src":e.downloadAttach(t.id,"img")}}):a("a",{staticClass:"primary",on:{click:function(a){return e.downloadAttach(t.id,"other")}}},[e._v(e._s(t.fileName))])],1)})),e._v(" "),a("div",{staticClass:"message"},[e._v(e._s(t.detail))]),e._v(" "),a("div",{staticClass:"time"},[e._v(e._s(e._f("dataTime")(t.createTime)))])],2)})),1),e._v(" "),["UN_ACCEPT","ACCEPTED"].includes(e.data.status)?a("el-card",{staticClass:"enter-box"},[e.isAdmin?a("div",{staticClass:"btn-wrap"},[a("el-button",{attrs:{type:"text",size:"mini",disabled:["SOLVED","SCORED","ACCEPTED"].includes(e.data.status)},on:{click:e.handleAccept}},[e._v("受理")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"mini",disabled:["SOLVED","SCORED"].includes(e.data.status)},on:{click:e.handleTransfer}},[e._v("转让")])],1):e._e(),e._v(" "),a("el-input",{staticClass:"textarea",attrs:{type:"textarea",placeholder:"请输入要写入的内容（Shift+Enter换行，Ctrl+V支持上传图片）",rows:"5",clearable:""},nativeOn:{paste:function(t){return e.handlePaste(t)},keydown:function(t){return e.keydown(t)}},model:{value:e.message,callback:function(t){e.message=t},expression:"message"}}),e._v(" "),a("div",{staticClass:"btn-line"},[a("el-upload",{ref:"upload",attrs:{action:"",accept:e.accept,"show-file-list":!1,"on-change":e.fileChange,"on-exceed":e.fileExceed,limit:3,multiple:!0,"auto-upload":!1}},[a("i",{staticClass:"el-icon-paperclip",attrs:{title:"上传附件"}})]),e._v(" "),a("div",[a("el-button",{attrs:{type:"primary",size:"mini",disabled:!e.data.sendCloseFlag},on:{click:e.send}},[e._v("发送")]),e._v(" "),a("el-button",{attrs:{size:"mini",disabled:!e.data.sendCloseFlag},on:{click:e.close}},[e._v("关闭工单")])],1)],1)],1):e._e(),e._v(" "),["SOLVED","SCORED"].includes(e.data.status)?a("div",{staticClass:"align-r"},[a("el-button",{attrs:{size:"mini"},on:{click:e.reopen}},[e._v("继续咨询")])],1):e._e()],1),e._v(" "),a("win-transfer",{ref:"transferOrder",on:{save:e.saveTransfer}}),e._v(" "),a("win-close-order",{ref:"closeOrder",on:{save:e.saveClose}})],1)},l=[],c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:["chat-dialog",e.chatLeft?"":"flex-end"]},[e.chatLeft?[a("div",{staticClass:"user-box"},[a("el-avatar",{attrs:{size:"small",icon:"el-icon-user-solid"}}),e._v(" "),a("div",[e._v(e._s(e.user))])],1),e._v(" "),a("div",{staticClass:"bubble-box"},[e._t("default"),e._v(" "),a("div",{staticClass:"bubble-arrow right"})],2)]:[a("div",{staticClass:"bubble-box left"},[e._t("default"),e._v(" "),a("div",{staticClass:"bubble-arrow left"})],2),e._v(" "),a("div",{staticClass:"user-box"},[a("el-avatar",{attrs:{size:"small",icon:"el-icon-user-solid"}}),e._v(" "),a("div",[e._v(e._s(e.user))])],1)]],2)},d=[],u={name:"ChatDialog",props:{chatLeft:{type:Boolean,default:!0},user:{type:String,default:"user"}}},f=u,p=(a("b766"),a("2877")),m=Object(p["a"])(f,c,d,!1,null,"7a92b830",null),b=m.exports,h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("img",{staticClass:"small-img",attrs:{src:e.imgSrc},on:{click:function(t){e.bigShow=!0}}}),e._v(" "),a("transition",{attrs:{name:"fade"}},[e.bigShow?a("div",{staticClass:"img-view",on:{click:function(t){e.bigShow=!1}}},[a("div",{staticClass:"img-layer"}),e._v(" "),a("div",{staticClass:"img"},[a("img",{attrs:{src:e.bigSrc||e.imgSrc}})])]):e._e()])],1)},v=[],g={name:"BigImg",props:{imgSrc:{type:String,default:""},bigSrc:{type:String,default:""}},data:function(){return{bigShow:!1}}},k=g,_=(a("afb0"),Object(p["a"])(k,h,v,!1,null,"04b9b9c0",null)),y=_.exports,w=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"转让工单",visible:e.dialogVisible,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t},close:e.resetForm}},[a("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"转让人"}},[a("el-select",{staticClass:"form-width",attrs:{placeholder:"请输入转让人",clearable:"",filterable:"",remote:"","remote-method":e.remoteMethod,loading:e.loading,"popper-class":"custom-popper"},model:{value:e.ruleForm.assignee,callback:function(t){e.$set(e.ruleForm,"assignee",t)},expression:"ruleForm.assignee"}},e._l(e.userList,(function(t){return a("el-option",{key:t.shareId,attrs:{value:t.shareId,label:t.name}},[a("div",{staticStyle:{"max-width":"250px","word-break":"break-all"}},[e._v("("+e._s(t.staffId)+")-"+e._s(t.name)+e._s(t.deptFullPath?"-"+t.deptFullPath:""))])])})),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"转让原因"}},[a("el-input",{staticClass:"form-width",attrs:{placeholder:"请输入转让原因",clearable:""},model:{value:e.ruleForm.reason,callback:function(t){e.$set(e.ruleForm,"reason",t)},expression:"ruleForm.reason"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",disabled:e.btnDisabled},on:{click:e.save}},[e._v("确 定")])],1)],1)},C=[],x=a("6297"),O=a("b199"),I={name:"WinTransfer",data:function(){return{dialogVisible:!1,ruleForm:{feedbackId:"",assignee:"",reason:""},userList:[],loading:!1,btnDisabled:!1}},methods:{showWin:function(e){this.ruleForm.feedbackId=e,this.dialogVisible=!0,this.btnDisabled=!1},remoteMethod:function(e){var t=this;""!==e?(this.loading=!0,Object(O["Y"])(e).then((function(e){var a=e.data;t.loading=!1,t.userList=a}))):this.userList=[]},resetForm:function(){this.ruleForm.assignee="",this.ruleForm.reason=""},save:function(){var e=this;if(this.ruleForm.assignee){this.btnDisabled=!0;var t={headers:{"Content-Type":"multipart/form-data"}},a=new FormData;a.append("feedbackId",this.ruleForm.feedbackId),a.append("assignee",this.ruleForm.assignee),a.append("reason",this.ruleForm.reason),Object(x["b"])(a,t).then((function(t){e.dialogVisible=!1,e.$message({type:"success",message:"转让成功"}),e.$emit("save")})).finally((function(){e.btnDisabled=!1}))}else this.$message.error("请输入转让人")}}},D=I,S=(a("271a"),Object(p["a"])(D,w,C,!1,null,"6174572c",null)),T=S.exports,F=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"关闭工单",visible:e.dialogVisible,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t},close:e.resetForm}},[a("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,"label-width":"130px"}},[e.isAdmin?a("el-form-item",{attrs:{label:"工单解决方案："}},[a("el-input",{attrs:{type:"textarea",rows:"4",placeholder:"工单解决方案"},model:{value:e.ruleForm.resolveReply,callback:function(t){e.$set(e.ruleForm,"resolveReply",t)},expression:"ruleForm.resolveReply"}})],1):a("div",[a("el-form-item",{attrs:{label:"关闭工单的原因："}},[a("el-radio-group",{model:{value:e.ruleForm.resolveReply,callback:function(t){e.$set(e.ruleForm,"resolveReply",t)},expression:"ruleForm.resolveReply"}},[a("el-radio",{attrs:{label:"自己已解决"}}),e._v(" "),a("el-radio",{attrs:{label:"不想问了"}}),e._v(" "),a("el-radio",{attrs:{label:"找不到人工"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"请您对工单评分："}},[a("el-rate",{attrs:{"show-text":"",texts:e.scoreTexts},model:{value:e.ruleForm.score,callback:function(t){e.$set(e.ruleForm,"score",t)},expression:"ruleForm.score"}})],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",disabled:e.btnDisabled},on:{click:e.save}},[e._v("确 定")])],1)],1)},E=[],$={name:"WinCloseOrder",data:function(){return{dialogVisible:!1,isAdmin:!1,ruleForm:{feedbackId:"",resolveReply:"",score:5},scoreTexts:["极差","失望","一般","满意","十分满意"],btnDisabled:!1}},methods:{showWin:function(e,t){this.isAdmin=e,this.ruleForm.feedbackId=t,this.dialogVisible=!0,this.btnDisabled=!1},resetForm:function(){this.ruleForm.resolveReply=""},save:function(){var e=this;if(this.ruleForm.resolveReply)if(this.ruleForm.score||this.isAdmin){this.btnDisabled=!0;var t={headers:{"Content-Type":"multipart/form-data"}},a=new FormData;a.append("feedbackId",this.ruleForm.feedbackId),a.append("reason",this.ruleForm.resolveReply),a.append("score",this.ruleForm.score),Object(x["c"])(a,t).then((function(s){e.isAdmin?(e.dialogVisible=!1,e.$message({type:"success",message:"关闭成功"}),e.$emit("save")):Object(x["j"])(a,t).then((function(t){e.dialogVisible=!1,e.$message({type:"success",message:"关闭成功"}),e.$emit("save")})).finally((function(){e.btnDisabled=!1}))})).finally((function(){e.btnDisabled=!1}))}else this.$message.error("请您对工单评分");else this.isAdmin?this.$message.error("请输入工单解决方案"):this.$message.error("请选择关闭工单的原因")}}},A=$,L=(a("f49f"),Object(p["a"])(A,F,E,!1,null,"765e634e",null)),j=L.exports;function P(e){return z(e)||R(e)||B(e)||V()}function V(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function B(e,t){if(e){if("string"===typeof e)return W(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?W(e,t):void 0}}function R(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function z(e){if(Array.isArray(e))return W(e)}function W(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}var M={name:"WinSeeOrder",components:{ChatDialog:b,BigImg:y,WinTransfer:T,WinCloseOrder:j},data:function(){return{sending:!1,dialogVisible:!1,loading:!1,isAdmin:!1,feedbackId:"",data:{},isEdit:!1,moduleList:["数据查询","数据开发","业务BI","资源中心","数据治理","其他"],newModule:"",newType:"",statusList:{UN_ACCEPT:"待接单",ACCEPTED:"处理中",SOLVED:"已完成",SCORED:"已打分"},message:"",btnDisabled:!1}},computed:{typeList:function(){var e=[];return e="数据查询"===this.newModule?["查询失败","功能故障","权限类","产品功能/交互体验","其他"]:"数据开发"===this.newModule?["任务失败类","调度异常类","任务配置类","权限类","产品建议","其他"]:"数据治理"===this.newModule?["查询故障","权限问题","功能故障","交互体验","功能优化","其他"]:["故障类","运维类","权限类","产品建议","其他"],e},lastProcessItemId:function(){var e=this.data.feedbackProcessItemList,t=e[e.length-1];return t.id},accept:function(){return".doc, .docx, .pdf, .jpg, .jpeg, .png, .xlsx"}},methods:{showWin:function(e,t){this.isAdmin=e,this.feedbackId=t,this.getInfo(t),this.dialogVisible=!0,this.btnDisabled=!1},scrollToBottom:function(){var e=document.getElementById("chat-wrap");e&&(e.scrollTop=e.scrollHeight)},getInfo:function(e){var t=this;this.loading=!0,Object(x["e"])({feedbackId:e}).then((function(e){var a=e.data;t.data=a,t.$nextTick((function(){t.scrollToBottom()})),t.loading=!1}))},edit:function(){this.isEdit=!0,this.newModule=this.data.module,this.newType=this.data.type},save:function(){var e=this;Object(x["l"])({id:this.feedbackId,module:this.newModule,type:this.newType,maxId:this.lastProcessItemId}).then((function(t){var a,s=t.data;e.data.module=s.module,e.data.type=s.type,e.isEdit=!1,(a=e.data.feedbackProcessItemList).push.apply(a,P(s.feedbackProcessItemList)),e.$nextTick((function(){e.scrollToBottom()}))}))},downloadAttach:function(e,t){var a="/api-gateway/"+"ds_task/attachment/download?id=".concat(e);if("img"===t)return a;window.location.href=a},handleAccept:function(){var e=this,t={headers:{"Content-Type":"multipart/form-data"}},a=new FormData;a.append("feedbackId",this.feedbackId),Object(x["a"])(a,t).then((function(t){e.$message({type:"success",message:"受理成功"}),e.getInfo(e.feedbackId),e.$emit("save")}))},handleTransfer:function(){this.$refs.transferOrder.showWin(this.feedbackId)},saveTransfer:function(){this.getInfo(this.feedbackId),this.$emit("save")},close:function(){this.$refs.closeOrder.showWin(this.isAdmin,this.feedbackId)},saveClose:function(){this.getInfo(this.feedbackId),this.$emit("save")},reopen:function(){var e=this;this.$confirm("继续咨询将重开工单，是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(x["g"])({feedbackId:e.feedbackId,maxId:e.lastProcessItemId}).then((function(t){var a,s=t.data;e.data.status=s.status,(a=e.data.feedbackProcessItemList).push.apply(a,P(s.feedbackProcessItemList)),e.$nextTick((function(){e.scrollToBottom()})),e.$emit("save")}))})).catch((function(){}))},handlePaste:function(e){var t=(e.clipboardData||window.clipboardData).items,a=null;if(t&&0!==t.length){for(var s=0;s<t.length;s++)if(-1!==t[s].type.indexOf("image")){a=t[s].getAsFile();break}a&&this.addFile(a)}else this.$message.error("当前浏览器不支持粘贴")},addFile:function(e){var t=this;if(e.type.indexOf("image")>=0){var a,s=new FileReader;s.onload=function(s){a='<image src="'.concat(s.target.result,'" width="500" />'),t.$confirm(a,"提示",{customClass:"img-preview",confirmButtonText:"上传",cancelButtonText:"取消",dangerouslyUseHTMLString:!0}).then((function(){t.sendMsg([e])})).catch((function(){}))},s.readAsDataURL(e)}},fileExceed:function(){this.$message({type:"warning",message:"最多上传3个文件"})},fileChange:function(e,t){var a=t.map((function(e){return e.raw}));this.sendMsg(a)},sendMsg:function(e){var t=this,a={headers:{"Content-Type":"multipart/form-data"}},s=new FormData;s.append("feedbackId",this.feedbackId),s.append("detail",this.message),s.append("maxId",this.lastProcessItemId),e&&e.forEach((function(e){s.append("multipartFileList",e)})),this.sending=!0,Object(x["k"])(s,a).then((function(e){var a,s=e.data;(a=t.data.feedbackProcessItemList).push.apply(a,P(s.feedbackProcessItemList)),t.message="",t.$nextTick((function(){t.scrollToBottom()}))})).finally((function(){t.sending=!1,t.$refs.upload.clearFiles()}))},resetForm:function(){this.message="",this.isEdit=!1,this.data={}},send:function(){this.sending||(this.message?this.sendMsg():this.$message.error("请输入内容"))},keydown:function(e){if(!e.shiftKey&&13===e.keyCode)return this.send(),e.cancelBubble=!0,e.preventDefault(),e.stopPropagation(),!1}}},N=M,U=(a("958a"),Object(p["a"])(N,o,l,!1,null,"69c05a00",null)),q=U.exports,H=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"工单评分",visible:e.dialogVisible,width:"500px","close-on-click-modal":!1},on:{"update:visible":function(t){e.dialogVisible=t},close:e.resetForm}},[a("div",[a("div",{staticClass:"mb10"},[e._v("请您针对工单编号"+e._s(e.params.feedbackId)+"的处理情况进行评分呦，谢谢配合。")]),e._v(" "),a("el-rate",{attrs:{"show-text":"",texts:e.scoreTexts},model:{value:e.params.score,callback:function(t){e.$set(e.params,"score",t)},expression:"params.score"}})],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary",disabled:e.btnDisabled},on:{click:e.save}},[e._v("确 定")])],1)])},G=[],J={name:"WinScoreOrder",data:function(){return{dialogVisible:!1,params:{feedbackId:"",score:5},scoreTexts:["极差","失望","一般","满意","十分满意"],btnDisabled:!1}},methods:{showWin:function(e){this.params.feedbackId=e.id,this.dialogVisible=!0,this.btnDisabled=!1},resetForm:function(){this.params.score=""},save:function(){var e=this;if(this.params.score){this.btnDisabled=!0;var t={headers:{"Content-Type":"multipart/form-data"}},a=new FormData;a.append("feedbackId",this.params.feedbackId),a.append("score",this.params.score),Object(x["j"])(a,t).then((function(t){e.dialogVisible=!1,e.$message({type:"success",message:"评价成功"}),e.$emit("save")})).finally((function(){e.btnDisabled=!1}))}else this.$message.error("请选择评分")}}},K=J,Y=Object(p["a"])(K,H,G,!1,null,"13848e99",null),Q=Y.exports,X=a("2f62");function Z(e){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Z(e)}function ee(e){return ne(e)||se(e)||ae(e)||te()}function te(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function ae(e,t){if(e){if("string"===typeof e)return re(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?re(e,t):void 0}}function se(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function ne(e){if(Array.isArray(e))return re(e)}function re(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}function ie(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function oe(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(a),!0).forEach((function(t){le(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ie(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function le(e,t,a){return t=ce(t),t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ce(e){var t=de(e,"string");return"symbol"===Z(t)?t:String(t)}function de(e,t){if("object"!==Z(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var s=a.call(e,t||"default");if("object"!==Z(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var ue={components:{SearchCondition:r["a"],TablePage:i["a"],WinSeeOrder:q,WinTransfer:T,WinCloseOrder:j,WinScoreOrder:Q},data:function(){var e=this;return{params:{appName:"ds-work",feedbackId:this.$route.query.feedbackId,status:"",module:"",type:"",createStartTime:"",createEndTime:"",createBy:"",handleBy:"",pageNum:1,pageSize:10},timeRange:[],moduleList:["数据查询","数据开发","业务BI","资源中心","数据治理","其他"],pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()}},statusList:[{label:"待接单",value:"UN_ACCEPT"},{label:"处理中",value:"ACCEPTED"},{label:"已完成",value:"SOLVED"},{label:"已打分",value:"SCORED"}],loading:!1,data:[],canScore:!1,columnDataDefault:[{prop:"id",label:"工单编号",width:"80"},{prop:"module",label:"产品模块",width:"100"},{prop:"type",label:"问题分类",width:"100"},{prop:"title",label:"问题标题",width:"150",tooltip:!0},{prop:"taskId",label:"任务ID",width:"120",tooltip:!0},{prop:"createBy",label:"提交用户",width:"100"},{prop:"feedbackLevel",label:"紧急程度",width:"90"},{prop:"status",label:"状态",width:"100",format:function(t){var a=e.statusList.find((function(e){return e.value===t.status}));return a?a.label:"-"}},{prop:"userGroup",label:"用户组",width:"130"},{prop:"chargePerson",label:"值班人",width:"110"},{prop:"handleBy",label:"处理人",width:"100"},{prop:"createTime",label:"提交时间",width:"145",format:function(t){return t.createTime?e.$utils.parseTime(t.createTime):"-"}}],columnData:[],total:0}},computed:oe(oe({},Object(X["c"])(["isAdmin","userInfo"])),{},{typeList:function(){var e=[];return e="数据查询"===this.params.module?["查询失败","功能故障","权限类","产品功能/交互体验","其他"]:"数据开发"===this.params.module?["任务失败类","调度异常类","任务配置类","权限类","产品建议","其他"]:"数据治理"===this.params.module?["查询故障","权限问题","功能故障","交互体验","功能优化","其他"]:["任务失败类","调度异常类","任务配置类","权限类","产品建议","查询失败","功能故障","产品功能/交互体验","故障类","运维类","查询故障","权限问题","交互体验","功能优化","其他"],e}}),created:function(){this.init()},methods:{init:function(){this.isAdmin?this.columnData=[].concat(ee(this.columnDataDefault),[{prop:"firstAcceptDuration",label:"响应时间",width:"130"},{prop:"firstCloseDuration",label:"解决时间",width:"130"}]):this.columnData=ee(this.columnDataDefault),this.getList("init")},search:function(){this.params.pageNum=1,this.getList()},changePage:function(e){this.params.pageSize=e.pageSize,this.params.pageNum=e.pageNum,this.getList()},getList:function(e){var t=this;this.loading=!0,Object.keys(this.params).forEach((function(e){t.params[e]||delete t.params[e]})),Object(x["f"])(this.params).then((function(a){var s=a.data;t.data=s.list,t.total=s.total,t.loading=!1,"init"===e&&t.params.feedbackId&&!t.isAdmin&&"SOLVED"===t.data[0].status&&t.$refs.scoreOrder.showWin(t.data[0])}))},create:function(){this.$router.push("/admin/order/create")},exportData:function(){var e=this,t=oe({},this.params);delete t.pageNum,delete t.pageSize,Object(x["d"])(oe({response:"HttpServletResponse"},t)).then((function(t){e.$message({type:"success",message:"下载成功"})}))},changeTime:function(e){e?(this.params.createStartTime=e[0],this.params.createEndTime=e[1]):(this.params.createStartTime="",this.params.createEndTime="")},see:function(e){this.$refs.seeOrder.showWin(this.isAdmin,e.id)},accept:function(e){var t=this,a={headers:{"Content-Type":"multipart/form-data"}},s=new FormData;s.append("feedbackId",e.id),Object(x["a"])(s,a).then((function(e){t.$message({type:"success",message:"受理成功"}),t.getList()}))},transfer:function(e){this.$refs.transferOrder.showWin(e.id)},close:function(e){this.$refs.closeOrder.showWin(this.isAdmin,e.id)},score:function(e){this.$refs.scoreOrder.showWin(e)}}},fe=ue,pe=(a("0179"),Object(p["a"])(fe,s,n,!1,null,"574e8210",null));t["default"]=pe.exports},b199:function(e,t,a){"use strict";a.d(t,"y",(function(){return r})),a.d(t,"W",(function(){return i})),a.d(t,"E",(function(){return o})),a.d(t,"p",(function(){return l})),a.d(t,"ab",(function(){return c})),a.d(t,"s",(function(){return d})),a.d(t,"r",(function(){return u})),a.d(t,"t",(function(){return f})),a.d(t,"Q",(function(){return p})),a.d(t,"T",(function(){return m})),a.d(t,"A",(function(){return b})),a.d(t,"O",(function(){return h})),a.d(t,"B",(function(){return v})),a.d(t,"q",(function(){return g})),a.d(t,"e",(function(){return k})),a.d(t,"g",(function(){return _})),a.d(t,"d",(function(){return y})),a.d(t,"ib",(function(){return w})),a.d(t,"n",(function(){return C})),a.d(t,"Y",(function(){return x})),a.d(t,"I",(function(){return O})),a.d(t,"H",(function(){return I})),a.d(t,"c",(function(){return D})),a.d(t,"hb",(function(){return S})),a.d(t,"m",(function(){return T})),a.d(t,"j",(function(){return F})),a.d(t,"f",(function(){return E})),a.d(t,"bb",(function(){return $})),a.d(t,"J",(function(){return A})),a.d(t,"F",(function(){return L})),a.d(t,"h",(function(){return j})),a.d(t,"db",(function(){return P})),a.d(t,"z",(function(){return V})),a.d(t,"R",(function(){return B})),a.d(t,"u",(function(){return R})),a.d(t,"D",(function(){return z})),a.d(t,"P",(function(){return W})),a.d(t,"w",(function(){return M})),a.d(t,"Z",(function(){return N})),a.d(t,"C",(function(){return U})),a.d(t,"eb",(function(){return q})),a.d(t,"a",(function(){return H})),a.d(t,"fb",(function(){return G})),a.d(t,"cb",(function(){return J})),a.d(t,"G",(function(){return K})),a.d(t,"U",(function(){return Y})),a.d(t,"i",(function(){return Q})),a.d(t,"k",(function(){return X})),a.d(t,"K",(function(){return Z})),a.d(t,"L",(function(){return ee})),a.d(t,"N",(function(){return te})),a.d(t,"M",(function(){return ae})),a.d(t,"b",(function(){return se})),a.d(t,"l",(function(){return ne})),a.d(t,"o",(function(){return re})),a.d(t,"S",(function(){return ie})),a.d(t,"gb",(function(){return oe})),a.d(t,"X",(function(){return le})),a.d(t,"v",(function(){return ce})),a.d(t,"V",(function(){return de}));var s=a("7258"),n="/ds_task/task";function r(e){return s["b"].post("/ds_task/metadata/search",e,{timeout:12e4})}function i(){return s["b"].get("/ds_task/sysdict/getTemplateList")}function o(e){return s["b"].get("/ds_task/dict/list",{params:e})}function l(e){return s["b"].get("/ds_task/artifact/list",{params:e})}function c(e){return s["b"].get("/ds_task/artifactversion/list",{params:e})}function d(e){return s["b"].get("/ds_task/flinkcluster/list",{params:e})}function u(e){return s["b"].get("/ds_task/flinkcluster/auto",{params:e})}function f(e){return s["b"].get("/ds_task/flinkcluster/noauto",{params:e})}function p(e){return s["b"].get("".concat(n,"/get"),{params:e})}function m(e){return s["b"].get("".concat(n,"/page"),{params:e,timeout:6e4})}function b(e){return s["b"].post("/ds_task/metadata/getddl",e)}function h(e){return s["b"].get("".concat(n,"/getInsertSql"),{params:e,timeout:6e5})}function v(e){return s["b"].post("/ds_task/metadata/getdispalyddl",e)}function g(e){return s["b"].get("".concat(n,"/getChildDependencies"),{params:{id:e}})}function k(e){return s["b"].get("".concat(n,"/backfill"),{params:e})}function _(e){return s["b"].put("".concat(n,"/onlineAndOffline"),null,{params:e})}function y(e){return s["b"].post("".concat(n,"/add"),e)}function w(e){return s["b"].put("".concat(n,"/update"),e)}function C(e){return s["b"].delete("".concat(n,"/new/delete"),{params:e})}function x(e){return s["b"].get("/ds_task/user/list",{params:{name:e}})}function O(e){return s["b"].get("/ds_task/label/list",{params:{name:e}})}function I(e){return s["b"].get("/ds_task/label/get",{params:{id:e}})}function D(e){return s["b"].post("/ds_task/label/add",e)}function S(e){return s["b"].put("/ds_task/label/update",e)}function T(e){return s["b"].delete("/ds_task/label/delete",{params:{id:e}})}function F(e){return s["b"].patch("/ds_task/collect/add",null,{params:e})}function E(e){return s["b"].get("/ds_task/collect/cancel",{params:e})}function $(e){return s["b"].get("/ds_task/collect/my",{params:e})}function A(e){return s["b"].get("/ds_task/task/listforlabel",{params:{name:e}})}function L(e){return s["b"].get("/ds_task/task/iam",{params:e})}function j(e){return s["b"].post("/ds_task/task/check",e,{timeout:18e4})}function P(e){return s["b"].get("/ds_task/task/name/search",{params:{name:e}})}function V(e){return s["b"].get("/ds_task/task/backfillDateDetail",{params:e})}function B(e){return s["b"].get("/ds_task/task/last7",{params:e})}function R(e){return s["b"].get("/ds_task/user/getEffectiveCostList",{params:{name:e}})}function z(e){return s["b"].get("/ds_task/task/getGitSqlFile",{params:e})}function W(e){return s["b"].post("/ds_task/task/sqlTbls",e,{headers:{"Content-Type":"multipart/form-data"}})}function M(e){return s["b"].post("/ds_task/task/getCrontab",e)}function N(e){return s["b"].get("/ds_task/taskversion/pages",{params:e})}function U(){return s["b"].get("/ds_task/auditlog/type?module=task")}function q(e){return s["b"].get("/ds_task/taskversion/verionSwitch",{params:e})}function H(e){return s["b"].post("/ds_task/task/addAndStart",e)}function G(e){return s["b"].post("/ds_task/task/updateAndStart",e)}function J(e){return s["b"].post("/ds_task/task/date/preview",e)}function K(e){return s["b"].post("/ds_task/task/mergeSmallFiles/jars",e)}function Y(e){return s["b"].post("/ds_task/task/getTasks",e)}function Q(e){return s["b"].post("/ds_task/task/checkPath",e,{headers:{"Content-Type":"multipart/form-data"}})}function X(e){return s["b"].post("/ds_task/task/fastBackfill?taskId="+e.taskId,e)}function Z(e){return s["b"].get("/ds_task/task/renderContent",{params:e})}function ee(e){return s["b"].post("/ds_task/metadata/preview",e)}function te(e){return s["b"].get("/ds_task/actor/sources/page",{params:e})}function ae(e){return s["b"].get("/ds_task/taskfolder/listFolder",{params:e})}function se(e){return s["b"].post("/ds_task/taskfolder/saveFolder",e)}function ne(e){return s["b"].get("/ds_task/taskfolder/deleteFolder",{params:e})}function re(e){return s["b"].post("/ds_task/taskfolder/editFolder",e)}function ie(e){return s["b"].get("/ds_task/taskfolder/listTask",{params:e})}function oe(e){return s["b"].post("/ds_task/taskfolder/updateTask",e)}function le(e){return s["b"].get("/ds_task/wechatAlert/listById?id=".concat(e))}function ce(e){return s["b"].post("/pipeline/cron/get",e)}function de(e){return s["b"].get("/ds_task/task/templateRendering",{params:e})}},b766:function(e,t,a){"use strict";a("cf34")},bfac:function(e,t,a){},cf34:function(e,t,a){},f182:function(e,t,a){},f49f:function(e,t,a){"use strict";a("bfac")},f9de:function(e,t,a){}}]);