(window["webpackJsonp_datastudio-web"]=window["webpackJsonp_datastudio-web"]||[]).push([["chunk-70d36cda","chunk-afc23f2e","chunk-2d0e1bd0"],{"01b6":function(t,e,n){"use strict";n("8df6")},"01cc":function(t,e,n){"use strict";n("24fa")},"0505":function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAAAXNSR0IArs4c6QAADYxJREFUeF7tnWuW2zYMhZ2VpVlZ2pU1WVl72JipRiNbJN6P6z9JTiiKuMAHgKLG8+WBDxSAAi8V+AJtoAAUeK0AAEF0QIE3CgAQhAcUACCIAShAUwAVhKYbrmqiAABp4miYSVMAgNB0w1VNFAAgTRwNM2kKABCabriqiQIApImjYSZNAQBC0w1XNVEAgDRxNMykKQBAaLrhqiYKAJAmjoaZNAUACE03XNVEAQDSxNEwk6YAAKHphquaKABA4jj6j4ul/IizvJ4rASC6fh9Bfwz8r6d/7979CMzPx+Mx/w2QdpVcHA9AFoVaGPbncwwXgoVbXQ45QvLXAR7qfLju8XgAEHoYzOrgBcTKygc0s9KgyqwodhoDQPZEG1UiMhB31gxIRnUZHwBzpxYqyIJCj8dsnb4vjc4zaMICUN74DBXkWpyqULwKBcDyQhkA8lGYAUa1SrFT0wAK9iCX8dIdjCtRxl5lVtIdyEqN7V5BAMZ9OLcGpSsgAOMejPOIlqB0AwRg7INxvKLdHqUTIICDB0dLUDoAEgmMebJ9FapX5xHnFxjHIeX4XL3YKBf+6zOVb7sqA+IJxhGE8XeNw7gJyfjTE5zSbVdVQDzgmK9weD8aHcDMsxzLSlOymlQExAqOKEC8a4gmIAMYC1hGNfm23qHFH1kJEEswvKsEJbIsYRmQaLSVFLtZ11QBRBuO+fMVJZz+rCbaVaVEy1UBkL8V24cSTr5JoZrJJX3LlR0QLTg6gHHmRguU1JBkBWT00wMO6U9HMKxASbkvyQiIBhwA43Oq0ajO6SDJBoh0GzAP9DI+lZKunlfzzTMVyUfEqSDJBIg0HKga64i11T4LIJJtVepN43pMi4+UriYpElQGQCThSOEU8dCWnVCymoRvt6IDAjhkg1tqNkm/hIYkOiD/CHgULZWAiBdTSLZcYeMw7MKe5xzcpydoqXTgOM4q0XKFTWJRAZF4Bg849OGYdygLSURAJMQGHHZwSEISzm/RAJHY/IUT2T5W3e5YLrlFA4S7KQccbmz8vrEEJGHiMsxCBDblgMMfDql2K4wvowDCzTphBI0To+4rKeHTCIBw9x2Aw52FlwtID0kEQDiPdAFHXDik2i3XGHW9+fPbw6m/biDs4VL8mDVfYdok6AkIt7UK/Q6PeQjGvyHnCaVbnLrdmPnUCnDEB+K8Qs5+xK2V9gKEUz3cxMoXk+FWnA4SL0CoPSn2HeFifntBVN+PG5nHq/kNmRtztFbb8RjyAup+xLx78AAkjTiM0JpfAjG/dX1+MyNjylKXclot05g1vRmjemRprd45vvSvCSDgS221TKuINSDU6pGhtVp98GDqYELgWl2SoopYAkIVJEv12IEf1eQXhtSYMEsyloDsBNAxi1mukZo9V6vHeX4zR1MNM7gudFxYBV/1AKL20yP+slRILVZCVxErQKgBZLU+rvOp9s37dm+5wlYRiwCsXj1GkHMBmaB0bbnCVhELQKjBY7E2buWY11NtvLp/15aLUkXUE4pFEIY0XIqM5zySgMylZXi0LSkjtYqoxrDq5M9fjUb5RTfa65J0rGSL1f0pV7hkqh2IlMyascWg2LkKaacNPKWKqLZZmoBQN+cZWwtNQDpt4KkxoxbHahMT26uM1UOzxTpXmaz6rFbLMS5Um6UJCCWrZqweloDMg8XKbwdT2iy1xKEJCCUTAJD1XKvae68vQ2UkJXZUYlll0mbtlXUFOUakWuZUCfv1SSlVRCW5agESxsB1n7BGUtpJ1g1PF6sEh+QCN+eixI9KRdUChBIwmZ1MsXczZm6HqwTI7V31Buy2WSrVVAuQEMbp+e7TzBEAqbaB342hYb94PItP2HD/4bkHeZUDKlSTEG2WBiCUbJq5vYoIyKwmQ9esHwBy8JwGqJaBQUkKFuvL/prKbpslvg/RCMzdYBE3yiLyTvfYtdl6iVlbLoquojEtOtnT6+7UW0ef4A9MaS49YyKitFmiMS06GXGDnjW7HYOZkuk0YXg3d6b9HgUQUfsiACJqkFPUZQJkSJQlKVHe7hW1TRoQd+IByLICWTbwuy17aEAomVQa0uUIERxIsVvw9qypRAOKtZLri1sDknHjeOXGzIBEPzPZ1VY0pqSzt6sxCtlrdcpdu1fntRwXteXabdtDA+JaDi2jKdk5yI400VquXUCGrWKJX2wi4hlINGfsBFLWx7wrNopm4ZUbvhkDQJgCRri8Qot1pWOER/AAJEKEM9dQFZAIZyZlAKEc6kTIUEw2/ru8MiDekAAQiQh1nqM6IJ6QuCZeyU26qyEAxEQByXhZXbBrXEka7GrIqtpK4zpUkCGdR0vsGlcARIYYACKj49UsZQAZxuGgUC9QIsyMCsL0AgBhChj8cg9AyjzFQgUJHt3M5XmdrgMQpuMiXN5hD+JRPYZvAUiECGeuoTogXnAAkGeGYMan++VVAYnwMumutqKtoORjXsorF6LGOGKy60THpS7fOgIc7jElDYhrv7jsevmBlQCJ9oNTu09GRZMuAJGBpQogUarG9ArlkFDUhgiAeG4AZfCo8TavaGAJCUsBRDSepAGhGBTRMbv+zVxBRFuSXeFuxlNa9tCAdD0szApI9ORE0VU06YtO9swGrpsq4Qy2Oh3Fkatza42LDof7E6yxAA1AKMGisQ6twLqal2Kz5fqO98oAxlyve7LVCExK35jJaZkByaQzZT8rvp8CIDJ5PHoFiXa2saI6RVPRDbpWi0XZqGuuZcUZ3DEUZ3LvuXp9pqpxtImiqXjCF5/waWEI41YjSGAcxV6B295OkRWOEO2VZtbutg+JBoh4L36LouwACiAqyUCrgoQxUNZvL2eLBIhKoBjpOG9D0VN8/6FZQbrtQygO1Yi5CnBQkqtaLGtVkLFgStBkdTDFVklAsup2pQEFELWWUhMQyj5ELRNIRuPFXJ6AVIKDmlhV2iuLYNw9CR1rUjNWERIPQDKebdy5gFI9VGNGs4KMhVOqSMaMaA1IRo3u4KBWD7X2yqKCUACxWNeKs3bGWAJSFQ7qgx3VjkO7glCNzhYEFoCoZsqdbKA0NmQytQAkpOHCTtYGJFvCoMhL2a+qJ43IgGQKCk1AMulAAYO6V1XdnE9DLAChtlmZ9iIagHQAY8ZhyOphGYDUNitLkEgDksVuasU4XkeNDdXNuXUFqV5FpACpeLZxBxGlepgld6sWi9NnZsimEoBksPMu2Hf/n6qbmVaWgHCqiJkgux5+jqe2CfN20e0jyvL2MuqpuVn1ML0RM5DUH+cxI4AKSHS7mLK8vTx89fAApHIV2e2lO1aNSQw1oZjHrHWLxdmLmIuzmT53nN4ZDk5rZa6bByCcKhK9JbmDxNzBm5BbDKe2Vi6+9wLkLpDeOSp6kI0M+f3xeIw/52c492eRXxbEgYjjd5Nzj7NxXoBwW63okHCCqOq1nNbKpXpE6Ol3N7bH4PGEu2oQa9nFgWOsyaV6RACEU3LdsopWFBWel7rvGJK4dgsRsjCniriKVzigJU1LnQQjAMIR0D3DSEZSwbm4vnVrraYvIgDC3bADkphkceEI0R1EAQSQxAxy6qq4cITZX0YCZDiDsx9BJaGGs+x1XDgiPDz6rUg0QCTEDVGaZWMuzWwS/nPfd0Q/S5AQGZDYM1XSb9EqyHQr57n5nAOQ2EEiAUeYfUf0CgJI7AJb4k5l4Qi1GXrhKe6mfUzb8ee8JQJ/ZQ6JSh86DqO2WNM53Hd4jk4Otflbib7AYySqxjQvtF+iAzJElIQE+xI+dW3gCF3aTn6UdApaLjokUi3VWEHoyjElylBB5lolIRlzopqsg9JW+0yASLdb2MDfAzLA+Hr66cj7q96PSJWYsgGiAckEZZR8fP5XQLpqpGmrjkGQERAtSNB2/YoMDTBSwpFpk/4qs0tuGo/3SNUGCJU9LTBCnpCvapa1ghzt04KkS0XRAqNE61oBEM22YIJY7dHwOFuaX0+0mkx3x5WowlUA0dyXHANjgjKz427QeI/XrBYlW9RKgEwHabZcGWEZUIzP+DI77U+JqnEUqSIgFi3XOdBGZZl7lvl37WB8Nb8lECWrRgdAZst1/gpQq6CdkIyvG51/1wBn7iWGXdIHejtalasc0/iqFeToXKu+eyWgjuCc27Xz9cfv9j3+nycI5zWWBaMTIN7VZAWcbGPKg9ENkGnv1TevZwtO7/W2gWMI3aHFugqoSG2Xd8Cv3r8VGF0ryDkYAMo9Hi3BACAfAwOgfAalNRgA5DpzYo+CHyT7EBld9yB3jUU3UEa1GJ95yHinT5v/ByD3rq4KC6C4933bp1gL0nwaMg/uvE7nKWs+X4NfJrqpIirIpmCH4fM1j0gn26+AGGBovOpCVy/JlQBEzlHnn6949aqI3B0/zzQrBPYTQioDECEhX0wzIRl/jkozP1R4rt7lQnVQ9CEAURR3Y+orYNASbQioNRSAaCmLeUsoAEBKuBFGaCkAQLSUxbwlFAAgJdwII7QUACBaymLeEgoAkBJuhBFaCgAQLWUxbwkFAEgJN8IILQUAiJaymLeEAgCkhBthhJYCAERLWcxbQgEAUsKNMEJLAQCipSzmLaEAACnhRhihpQAA0VIW85ZQAICUcCOM0FIAgGgpi3lLKABASrgRRmgp8C9bsfLngtvSOQAAAABJRU5ErkJggg=="},"0703":function(t,e,n){"use strict";n("ca96")},1265:function(t,e,n){t.exports=n.p+"static/img/avatar1.2858d4e2.jpeg"},"198d":function(t,e,n){},"1c36":function(t,e,n){},"1f17":function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return a})),n.d(e,"d",(function(){return o})),n.d(e,"f",(function(){return s})),n.d(e,"a",(function(){return l})),n.d(e,"e",(function(){return u}));var r=n("953e");function i(t,e){var n=Object(r["a"])("ds-query-sql-".concat(t));if(n){n=JSON.parse(n);var i=n.findIndex((function(t){return t.name===e.name}));i>-1?n[i]=Object.assign(n[i],e):n.push(e)}else n=[e];Object(r["c"])("ds-query-sql-".concat(t),JSON.stringify(n))}function a(t,e){var n=Object(r["a"])("ds-query-sql-".concat(t));if(n)if(n=JSON.parse(n),e){var i=n.findIndex((function(t){return t.name===e}));i>-1&&(n.splice(i,1),Object(r["c"])("ds-query-sql-".concat(t),JSON.stringify(n)))}else Object(r["b"])("ds-query-sql-".concat(t))}var o=["integer","bigint","smallint","tinyint","float","real","double"];function s(t){localStorage.setItem("cmpType",JSON.stringify({value:t,startDate:(new Date).getTime()}))}function l(){var t=JSON.parse(localStorage.getItem("cmpType")||null);if(t){var e=(new Date).getTime(),n=t.startDate;return e-n<864e5&&t.value}return!1}function u(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t.trim().endsWith(";")?t.slice(0,-1):t}},"23a1":function(t,e,n){"use strict";n("d3a9")},"24fa":function(t,e,n){},"295e":function(t,e,n){t.exports=n.p+"static/img/avatar2.b2ee1857.png"},"297d":function(t,e,n){"use strict";n("83e0")},"2ccb":function(t,e,n){"use strict";n("a0f7")},"35a9":function(t,e,n){"use strict";n("b098")},"3a8f":function(t,e,n){"use strict";n("abef")},"3b14":function(t,e,n){},"3bea":function(t,e,n){"use strict";n("ed77")},"49bb":function(t,e,n){"use strict";var r=n("f3bb"),i=n("3842"),a=n("f934"),o=n("6d8b"),s=2*Math.PI,l=Math.PI/180;function u(t,e){return a["d"](t.getBoxLayoutParams(),{width:e.getWidth(),height:e.getHeight()})}function c(t,e){var n=u(t,e),r=t.get("center"),a=t.get("radius");o["s"](a)||(a=[0,a]);var s,l,c=Object(i["q"])(n.width,e.getWidth()),f=Object(i["q"])(n.height,e.getHeight()),h=Math.min(c,f),p=Object(i["q"])(a[0],h/2),d=Object(i["q"])(a[1],h/2),m=t.coordinateSystem;if(m){var g=m.dataToPoint(r);s=g[0]||0,l=g[1]||0}else o["s"](r)||(r=[r,r]),s=Object(i["q"])(r[0],c)+n.x,l=Object(i["q"])(r[1],f)+n.y;return{cx:s,cy:l,r0:p,r:d}}function f(t,e,n){e.eachSeriesByType(t,(function(t){var e=t.getData(),r=e.mapDimension("value"),a=u(t,n),o=c(t,n),f=o.cx,h=o.cy,p=o.r,d=o.r0,m=-t.get("startAngle")*l,g=t.get("minAngle")*l,v=0;e.each(r,(function(t){!isNaN(t)&&v++}));var b=e.getSum(r),y=Math.PI/(b||v)*2,w=t.get("clockwise"),_=t.get("roseType"),k=t.get("stillShowZeroSum"),D=e.getDataExtent(r);D[0]=0;var x=s,C=0,S=m,O=w?1:-1;if(e.setLayout({viewRect:a,r:p}),e.each(r,(function(t,n){var r;if(isNaN(t))e.setItemLayout(n,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:w,cx:f,cy:h,r0:d,r:_?NaN:p});else{r="area"!==_?0===b&&k?y:t*y:s/v,r<g?(r=g,x-=g):C+=t;var a=S+O*r;e.setItemLayout(n,{angle:r,startAngle:S,endAngle:a,clockwise:w,cx:f,cy:h,r0:d,r:_?Object(i["m"])(t,D,[d,p]):p}),S=a}})),x<s&&v)if(x<=.001){var L=s/v;e.each(r,(function(t,n){if(!isNaN(t)){var r=e.getItemLayout(n);r.angle=L,r.startAngle=m+O*n*L,r.endAngle=m+O*(n+1)*L}}))}else y=x/C,S=m,e.each(r,(function(t,n){if(!isNaN(t)){var r=e.getItemLayout(n),i=r.angle===g?g:t*y;r.startAngle=S,r.endAngle=S+O*i,S+=O*i}}))}))}function h(t){return{seriesType:t,reset:function(t,e){var n=e.findComponents({mainType:"legend"});if(n&&n.length){var r=t.getData();r.filterSelf((function(t){for(var e=r.getName(t),i=0;i<n.length;i++)if(!n[i].isSelected(e))return!1;return!0}))}}}}var p=n("7fae"),d=n("76a5"),m=n("deca"),g=n("d498"),v=n("4aa2"),b=n("7d6c"),y=n("e887"),w=n("dce8"),_=n("89b6"),k=n("2355"),D=Math.PI/180;function x(t,e,n,r,i,a,o,s,l,u){if(!(t.length<2)){for(var c=t.length,f=0;f<c;f++)if("outer"===t[f].position&&"labelLine"===t[f].labelAlignTo){var h=t[f].label.x-u;t[f].linePoints[1][0]+=h,t[f].label.x=u}Object(k["d"])(t,l,l+o)&&d(t)}function p(t){for(var a=t.rB,o=a*a,s=0;s<t.list.length;s++){var l=t.list[s],u=Math.abs(l.label.y-n),c=r+l.len,f=c*c,h=Math.sqrt((1-Math.abs(u*u/o))*f),p=e+(h+l.len2)*i,d=p-l.label.x,m=l.targetTextWidth-d*i;S(l,m,!0),l.label.x=p}}function d(t){for(var a={list:[],maxY:0},o={list:[],maxY:0},s=0;s<t.length;s++)if("none"===t[s].labelAlignTo){var l=t[s],u=l.label.y>n?o:a,c=Math.abs(l.label.y-n);if(c>=u.maxY){var f=l.label.x-e-l.len2*i,h=r+l.len,d=Math.abs(f)<h?Math.sqrt(c*c/(1-f*f/h/h)):h;u.rB=d,u.maxY=c}u.list.push(l)}p(a),p(o)}}function C(t,e,n,r,i,a,o,s){for(var l=[],u=[],c=Number.MAX_VALUE,f=-Number.MAX_VALUE,h=0;h<t.length;h++){var p=t[h].label;O(t[h])||(p.x<e?(c=Math.min(c,p.x),l.push(t[h])):(f=Math.max(f,p.x),u.push(t[h])))}for(h=0;h<t.length;h++){var d=t[h];if(!O(d)&&d.linePoints){if(null!=d.labelStyleWidth)continue;p=d.label;var m=d.linePoints,g=void 0;g="edge"===d.labelAlignTo?p.x<e?m[2][0]-d.labelDistance-o-d.edgeDistance:o+i-d.edgeDistance-m[2][0]-d.labelDistance:"labelLine"===d.labelAlignTo?p.x<e?c-o-d.bleedMargin:o+i-f-d.bleedMargin:p.x<e?p.x-o-d.bleedMargin:o+i-p.x-d.bleedMargin,d.targetTextWidth=g,S(d,g)}}x(u,e,n,r,1,i,a,o,s,f),x(l,e,n,r,-1,i,a,o,s,c);for(h=0;h<t.length;h++){d=t[h];if(!O(d)&&d.linePoints){p=d.label,m=d.linePoints;var v="edge"===d.labelAlignTo,b=p.style.padding,y=b?b[1]+b[3]:0,w=p.style.backgroundColor?0:y,_=d.rect.width+w,k=m[1][0]-m[2][0];v?p.x<e?m[2][0]=o+d.edgeDistance+_+d.labelDistance:m[2][0]=o+i-d.edgeDistance-_-d.labelDistance:(p.x<e?m[2][0]=p.x+d.labelDistance:m[2][0]=p.x-d.labelDistance,m[1][0]=m[2][0]+k),m[1][1]=m[2][1]=p.y}}}function S(t,e,n){if(void 0===n&&(n=!1),null==t.labelStyleWidth){var r=t.label,i=r.style,a=t.rect,o=i.backgroundColor,s=i.padding,l=s?s[1]+s[3]:0,u=i.overflow,c=a.width+(o?0:l);if(e<c||n){var f=a.height;if(u&&u.match("break")){r.setStyle("backgroundColor",null),r.setStyle("width",e-l);var h=r.getBoundingRect();r.setStyle("width",Math.ceil(h.width)),r.setStyle("backgroundColor",o)}else{var p=e-l,d=e<c?p:n?p>t.unconstrainedWidth?null:p:null;r.setStyle("width",d)}var m=r.getBoundingRect();a.width=m.width;var g=(r.style.margin||0)+2.1;a.height=m.height+g,a.y-=(a.height-f)/2}}}function O(t){return"center"===t.position}function L(t){var e,n,r=t.getData(),a=[],s=!1,l=(t.get("minShowLabelAngle")||0)*D,u=r.getLayout("viewRect"),c=r.getLayout("r"),f=u.width,h=u.x,p=u.y,d=u.height;function m(t){t.ignore=!0}function g(t){if(!t.ignore)return!0;for(var e in t.states)if(!1===t.states[e].ignore)return!0;return!1}r.each((function(t){var u=r.getItemGraphicEl(t),p=u.shape,d=u.getTextContent(),v=u.getTextGuideLine(),b=r.getItemModel(t),y=b.getModel("label"),_=y.get("position")||b.get(["emphasis","label","position"]),k=y.get("distanceToLabelLine"),D=y.get("alignTo"),x=Object(i["q"])(y.get("edgeDistance"),f),C=y.get("bleedMargin"),S=b.getModel("labelLine"),O=S.get("length");O=Object(i["q"])(O,f);var L=S.get("length2");if(L=Object(i["q"])(L,f),Math.abs(p.endAngle-p.startAngle)<l)return Object(o["k"])(d.states,m),d.ignore=!0,void(v&&(Object(o["k"])(v.states,m),v.ignore=!0));if(g(d)){var T,E,A,j,F=(p.startAngle+p.endAngle)/2,q=Math.cos(F),N=Math.sin(F);e=p.cx,n=p.cy;var I="inside"===_||"inner"===_;if("center"===_)T=p.cx,E=p.cy,j="center";else{var $=(I?(p.r+p.r0)/2*q:p.r*q)+e,P=(I?(p.r+p.r0)/2*N:p.r*N)+n;if(T=$+3*q,E=P+3*N,!I){var B=$+q*(O+c-p.r),z=P+N*(O+c-p.r),M=B+(q<0?-1:1)*L,Q=z;T="edge"===D?q<0?h+x:h+f-x:M+(q<0?-k:k),E=Q,A=[[$,P],[B,z],[M,Q]]}j=I?"center":"edge"===D?q>0?"right":"left":q>0?"left":"right"}var G=Math.PI,R=0,H=y.get("rotate");if(Object(o["y"])(H))R=H*(G/180);else if("center"===_)R=0;else if("radial"===H||!0===H){var U=q<0?-F+G:-F;R=U}else if("tangential"===H&&"outside"!==_&&"outer"!==_){var Y=Math.atan2(q,N);Y<0&&(Y=2*G+Y);var V=N>0;V&&(Y=G+Y),R=Y-G}if(s=!!R,d.x=T,d.y=E,d.rotation=R,d.setStyle({verticalAlign:"middle"}),I){d.setStyle({align:j});var K=d.states.select;K&&(K.x+=d.x,K.y+=d.y)}else{var W=d.getBoundingRect().clone();W.applyTransform(d.getComputedTransform());var X=(d.style.margin||0)+2.1;W.y-=X/2,W.height+=X,a.push({label:d,labelLine:v,position:_,len:O,len2:L,minTurnAngle:S.get("minTurnAngle"),maxSurfaceAngle:S.get("maxSurfaceAngle"),surfaceNormal:new w["a"](q,N),linePoints:A,textAlign:j,labelDistance:k,labelAlignTo:D,edgeDistance:x,bleedMargin:C,rect:W,unconstrainedWidth:W.width,labelStyleWidth:d.style.width})}u.setTextConfig({inside:I})}})),!s&&t.get("avoidLabelOverlap")&&C(a,e,n,c,f,d,h,p);for(var v=0;v<a.length;v++){var b=a[v],y=b.label,k=b.labelLine,x=isNaN(y.x)||isNaN(y.y);if(y){y.setStyle({align:b.textAlign}),x&&(Object(o["k"])(y.states,m),y.ignore=!0);var S=y.states.select;S&&(S.x+=y.x,S.y+=y.y)}if(k){var O=b.linePoints;x||!O?(Object(o["k"])(k.states,m),k.ignore=!0):(Object(_["c"])(O,b.minTurnAngle),Object(_["b"])(O,b.surfaceNormal,b.maxSurfaceAngle),k.setShape({points:O}),y.__hostTarget.textGuideLineConfig={anchor:new w["a"](O[0][0],O[0][1])})}}}var T=n("7837"),E=n("e4b8"),A=function(t){function e(e,n,r){var i=t.call(this)||this;i.z2=2;var a=new d["a"];return i.setTextContent(a),i.updateData(e,n,r,!0),i}return Object(p["a"])(e,t),e.prototype.updateData=function(t,e,n,r){var i=this,a=t.hostModel,s=t.getItemModel(e),l=s.getModel("emphasis"),u=t.getItemLayout(e),c=Object(o["m"])(Object(E["a"])(s.getModel("itemStyle"),u,!0),u);if(isNaN(c.startAngle))i.setShape(c);else{if(r){i.setShape(c);var f=a.getShallow("animationType");a.ecModel.ssr?(m["c"](i,{scaleX:0,scaleY:0},a,{dataIndex:e,isFrom:!0}),i.originX=c.cx,i.originY=c.cy):"scale"===f?(i.shape.r=u.r0,m["c"](i,{shape:{r:u.r}},a,e)):null!=n?(i.setShape({startAngle:n,endAngle:n}),m["c"](i,{shape:{startAngle:u.startAngle,endAngle:u.endAngle}},a,e)):(i.shape.endAngle=u.startAngle,m["h"](i,{shape:{endAngle:u.endAngle}},a,e))}else Object(m["g"])(i),m["h"](i,{shape:c},a,e);i.useStyle(t.getItemVisual(e,"style")),Object(b["D"])(i,s);var h=(u.startAngle+u.endAngle)/2,p=a.get("selectedOffset"),d=Math.cos(h)*p,g=Math.sin(h)*p,v=s.getShallow("cursor");v&&i.attr("cursor",v),this._updateLabel(a,t,e),i.ensureState("emphasis").shape=Object(o["m"])({r:u.r+(l.get("scale")&&l.get("scaleSize")||0)},Object(E["a"])(l.getModel("itemStyle"),u)),Object(o["m"])(i.ensureState("select"),{x:d,y:g,shape:Object(E["a"])(s.getModel(["select","itemStyle"]),u)}),Object(o["m"])(i.ensureState("blur"),{shape:Object(E["a"])(s.getModel(["blur","itemStyle"]),u)});var y=i.getTextGuideLine(),w=i.getTextContent();y&&Object(o["m"])(y.ensureState("select"),{x:d,y:g}),Object(o["m"])(w.ensureState("select"),{x:d,y:g}),Object(b["E"])(this,l.get("focus"),l.get("blurScope"),l.get("disabled"))}},e.prototype._updateLabel=function(t,e,n){var r=this,i=e.getItemModel(n),a=i.getModel("labelLine"),s=e.getItemVisual(n,"style"),l=s&&s.fill,u=s&&s.opacity;Object(T["f"])(r,Object(T["d"])(i),{labelFetcher:e.hostModel,labelDataIndex:n,inheritColor:l,defaultOpacity:u,defaultText:t.getFormattedLabel(n,"normal")||e.getName(n)});var c=r.getTextContent();r.setTextConfig({position:null,rotation:null}),c.attr({z2:10});var f=t.get(["label","position"]);if("outside"!==f&&"outer"!==f)r.removeTextGuideLine();else{var h=this.getTextGuideLine();h||(h=new g["a"],this.setTextGuideLine(h)),Object(_["d"])(this,Object(_["a"])(i),{stroke:l,opacity:Object(o["N"])(a.get(["lineStyle","opacity"]),u,1)})}},e}(v["a"]),j=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ignoreLabelLineUpdate=!0,e}return Object(p["a"])(e,t),e.prototype.render=function(t,e,n,r){var i,a=t.getData(),o=this._data,s=this.group;if(!o&&a.count()>0){for(var l=a.getItemLayout(0),u=1;isNaN(l&&l.startAngle)&&u<a.count();++u)l=a.getItemLayout(u);l&&(i=l.startAngle)}if(this._emptyCircleSector&&s.remove(this._emptyCircleSector),0===a.count()&&t.get("showEmptyCircle")){var f=new v["a"]({shape:c(t,n)});f.useStyle(t.getModel("emptyCircleStyle").getItemStyle()),this._emptyCircleSector=f,s.add(f)}a.diff(o).add((function(t){var e=new A(a,t,i);a.setItemGraphicEl(t,e),s.add(e)})).update((function(t,e){var n=o.getItemGraphicEl(e);n.updateData(a,t,i),n.off("click"),s.add(n),a.setItemGraphicEl(t,n)})).remove((function(e){var n=o.getItemGraphicEl(e);m["f"](n,t,e)})).execute(),L(t),"expansion"!==t.get("animationTypeUpdate")&&(this._data=a)},e.prototype.dispose=function(){},e.prototype.containPoint=function(t,e){var n=e.getData(),r=n.getItemLayout(0);if(r){var i=t[0]-r.cx,a=t[1]-r.cy,o=Math.sqrt(i*i+a*a);return o<=r.r&&o>=r.r0}},e.type="pie",e}(y["a"]),F=j,q=n("b1d4"),N=n("b682");function I(t,e,n){e=Object(o["s"])(e)&&{coordDimensions:e}||Object(o["m"])({encodeDefine:t.getEncode()},e);var r=t.getSource(),i=Object(q["a"])(r,e).dimensions,a=new N["a"](i,t);return a.initData(r,n),a}var $=n("e0d3"),P=n("0f99"),B=function(){function t(t,e){this._getDataWithEncodedVisual=t,this._getRawData=e}return t.prototype.getAllNames=function(){var t=this._getRawData();return t.mapArray(t.getName)},t.prototype.containName=function(t){var e=this._getRawData();return e.indexOfName(t)>=0},t.prototype.indexOfName=function(t){var e=this._getDataWithEncodedVisual();return e.indexOfName(t)},t.prototype.getItemVisual=function(t,e){var n=this._getDataWithEncodedVisual();return n.getItemVisual(t,e)},t}(),z=B,M=n("4f85"),Q=$["m"](),G=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(p["a"])(e,t),e.prototype.init=function(e){t.prototype.init.apply(this,arguments),this.legendVisualProvider=new z(o["c"](this.getData,this),o["c"](this.getRawData,this)),this._defaultLabelLine(e)},e.prototype.mergeOption=function(){t.prototype.mergeOption.apply(this,arguments)},e.prototype.getInitialData=function(){return I(this,{coordDimensions:["value"],encodeDefaulter:o["h"](P["d"],this)})},e.prototype.getDataParams=function(e){var n=this.getData(),r=Q(n),a=r.seats;if(!a){var o=[];n.each(n.mapDimension("value"),(function(t){o.push(t)})),a=r.seats=Object(i["e"])(o,n.hostModel.get("percentPrecision"))}var s=t.prototype.getDataParams.call(this,e);return s.percent=a[e]||0,s.$vars.push("percent"),s},e.prototype._defaultLabelLine=function(t){$["e"](t,"labelLine",["show"]);var e=t.labelLine,n=t.emphasis.labelLine;e.show=e.show&&t.label.show,n.show=n.show&&t.emphasis.label.show},e.type="series.pie",e.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,minShowLabelAngle:0,selectedOffset:10,percentPrecision:2,stillShowZeroSum:!0,left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:0,show:!0,overflow:"truncate",position:"outer",alignTo:"none",edgeDistance:"25%",bleedMargin:10,distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:15,smooth:!1,minTurnAngle:90,maxSurfaceAngle:90,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1,borderJoin:"round"},showEmptyCircle:!0,emptyCircleStyle:{color:"lightgray",opacity:1},labelLayout:{hideOverlap:!0},emphasis:{scale:!0,scaleSize:5},avoidLabelOverlap:!0,animationType:"expansion",animationDuration:1e3,animationTypeUpdate:"transition",animationEasingUpdate:"cubicInOut",animationDurationUpdate:500,animationEasing:"cubicInOut"},e}(M["b"]),R=G;function H(t){return{seriesType:t,reset:function(t,e){var n=t.getData();n.filterSelf((function(t){var e=n.mapDimension("value"),r=n.get(e,t);return!(Object(o["y"])(r)&&!isNaN(r)&&r<0)}))}}}function U(t){t.registerChartView(F),t.registerSeriesModel(R),Object(r["a"])("pie",t.registerAction),t.registerLayout(Object(o["h"])(f,"pie")),t.registerProcessor(h("pie")),t.registerProcessor(H("pie"))}n.d(e,"a",(function(){return U}))},"4a55":function(t,e,n){},"53c2":function(t,e,n){"use strict";n("f5d4")},"58cb":function(t,e,n){},"5c24":function(t,e,n){},"5cac":function(t,e,n){t.exports={globalFont:"Helvetica Neue,Helvetica,PingFang SC,Avenir,Segoe UI,Arial,sans-serif,Hiragino Sans GB,Microsoft YaHei",navbarHeight:"45px",menuText:"#445782",menuActiveText:"#3782ff",subMenuActiveText:"#3782ff",menuBg:"#f7f9ff",menuHover:"#dfebff",subMenuBg:"#1f2d3d",subMenuHover:"#dfebff",sideBarWidth:"244px"}},"5dae":function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrapper_table"},[n("el-table",{ref:"singleTable",class:["singleTable",t.tableOptions.format.transposition?"tansTable":""],attrs:{border:"",stripe:"",data:t.handelTableData,"highlight-current-row":"","cell-style":{padding:"0",height:"30px"},"header-cell-style":{padding:"0",height:"36px"}},on:{"sort-change":t.sortChange}},[t.tableOptions.format.indexType?n("el-table-column",{attrs:{type:"index",width:"50",index:t.indexMethod,align:"center"}},[n("template",{slot:"header"},[t._v("序号")])],2):t._e(),t._v(" "),t._l(t.transTableHeader,(function(e){return n("el-table-column",{key:e.valueKey,attrs:{"min-width":"180",prop:e.valueKey,align:t.tableOptions.align,"show-overflow-tooltip":!t.tableOptions.format.wrap,sortable:"custom"},scopedSlots:t._u([{key:"header",fn:function(r){return[e.name&&14*e.name.length<r.column.realWidth?n("span",[t._v(t._s(e.name))]):n("el-tooltip",{attrs:{effect:"dark",content:e.name,placement:"top"}},[n("span",{staticStyle:{"max-width":"90%",display:"inline-block"}},[t._v(t._s(e.name))])])]}},{key:"default",fn:function(r){return[t.tableOptions.format.transposition?[n("span",{staticClass:"cell_label",style:t.cellStyle(t.tremFormatFn(r.row.valueKey).tremFormat,r.row[e.valueKey])},["text"===t.tremFormatFn(r.row.valueKey).showType?n("span",[t._v("\n              "+t._s(r.row[e.name])+"\n            ")]):"link"===t.tremFormatFn(r.row.valueKey).showType?n("a",{attrs:{href:r.row[e.valueKey],target:"_blank"}},[t._v("\n              "+t._s(r.row[e.name])+"\n            ")]):"img"===t.tremFormatFn(r.row.valueKey).showType?n("img",{attrs:{src:r.row[e.valueKey]}}):t._e()])]:[n("span",{staticClass:"cell_label",style:t.cellStyle(e.tremFormat,r.row[e.valueKey])},["text"===e.showType?n("span",[t._v("\n              "+t._s(r.row[e.valueKey])+"\n            ")]):"link"===e.showType?n("a",{attrs:{href:r.row[e.valueKey],target:"_blank"}},[t._v("\n              "+t._s(r.row[e.valueKey])+"\n            ")]):"img"===e.showType?n("img",{attrs:{src:r.row[e.valueKey]}}):t._e()])]]}}],null,!0)})}))],2)],1)},i=[],a={props:{tableData:{type:Array,default:function(){return[]}},tableOptions:{type:Object,default:function(){return{filterList:[],align:"",format:{indexType:!1,transposition:!1,wrap:!1,auto:!1},pagination:{paginationType:!1,pageSize:20,pageNum:1,max:1e3}}}}},data:function(){return{}},computed:{transTableHeader:function(){if(this.tableOptions.format.transposition){var t=this.handelTableData[0]&&Object.keys(this.handelTableData[0]).map((function(t){if("valueKey"!==t)return{name:t,valueKey:t}}));return t.filter((function(t){return t}))}return this.tableOptions.filterList},handelTableData:function(){var t=this,e=this.tableData;if(e.length<=0)return[];if(this.tableOptions.format.transposition){var n=this.tableOptions.filterList.map((function(t){return t.valueKey})),r={};n.forEach((function(t){r[t]=e.map((function(e){return e[t]}))}));var i=[];Object.keys(r).forEach((function(e){var n={};n.name=t.tableOptions.filterList.find((function(t){return t.valueKey===e})).name,n.valueKey=e,r[e].forEach((function(t,e){n["key"+e]=t})),i.push(n)})),e=i}return e}},methods:{sortChange:function(t){this.$emit("sortChange",t)},indexMethod:function(t){return(this.tableOptions.pagination.pageNum-1)*this.tableOptions.pagination.pageSize+t+1},tremFormatFn:function(t){return this.tableOptions.filterList.find((function(e){return e.valueKey===t}))||{}},cellStyle:function(t,e){if(!t||!e&&0!==e)return{};var n=t.symbol,r=t.value,i=t.viewColor,a=r;if("number"===typeof e&&(a=Number(r)),!n||!a&&0!==a||!i)return{};if("lt"===n){if(e<a)return{"background-color":i,color:"#fff"}}else if("equal"===n){if(a===e)return{"background-color":i,color:"#fff"}}else if("gt"===n&&e>a)return{"background-color":i,color:"#fff"};return{}}}},o=a,s=(n("7c9a"),n("2877")),l=Object(s["a"])(o,r,i,!1,null,"56e5cad8",null);e["a"]=l.exports},"5ea0":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-card",{staticClass:"data-query box-card-container"},[n("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[n("el-tab-pane",{attrs:{label:"数据查询",name:"queryTab"}},[n("QueryTab",{staticClass:"tab-wrap"})],1),t._v(" "),n("el-tab-pane",{attrs:{label:"已保存的查询",name:"saveTab"}},[n("saved-tab",{ref:"saveTab",staticClass:"tab-wrap"})],1),t._v(" "),n("el-tab-pane",{attrs:{label:"历史查询",name:"historyTab"}},[n("history-tab",{ref:"historyTab",staticClass:"tab-wrap"})],1),t._v(" "),n("el-tab-pane",{attrs:{label:"定时任务",name:"controlManager"}},[n("control-manager",{ref:"controlManager",staticClass:"tab-wrap"})],1),t._v(" "),n("el-tab-pane",{attrs:{label:"分享列表",name:"shareTab"}},[n("shareTab",{ref:"shareTab",staticClass:"tab-wrap"})],1),t._v(" "),t.permissionType?n("el-tab-pane",{directives:[{name:"permission",rawName:"v-permission",value:t.permission,expression:"permission"}],attrs:{label:"已生成的API",name:"generateApi"}},[n("generate-api",{ref:"generateApi",staticClass:"tab-wrap"})],1):t._e()],1)],1)},i=[],a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"queryTab",staticClass:"query-tab"},[n("div",{ref:"leftBox",staticClass:"left-wrap",style:{width:t.leftWidth+"%"}},[n("div",[n("data-config",{ref:"dataConfig",on:{select:t.select,changeDrawer:t.changeDrawer,lookMetadata:t.lookMetadata,closeVisible:t.closeVisible,sqlCreateTable:t.sqlCreateTable}})],1),t._v(" "),n("div",{staticClass:"drag-bar",on:{mousedown:t.dragEagle}},[n("span",{staticClass:"bar"})])]),t._v(" "),n("div",{staticClass:"right-wrap",style:{width:t.rightWidth}},[n("el-menu",{staticClass:"el-menu-more",attrs:{"default-active":t.activeTabName,mode:"horizontal"}},[n("el-submenu",{attrs:{"popper-append-to-body":!1,index:"menu"}},[n("template",{slot:"title"},[n("svg-icon",{staticClass:"icon-more",attrs:{"icon-class":"more"}})],1),t._v(" "),n("el-menu-item",{key:"-1",attrs:{index:"-1"}},[n("div",{staticClass:"menu-item-close-all",on:{click:t.closeAll}},[t._v("关闭所有")])]),t._v(" "),t._l(t.queryList,(function(e){return n("el-menu-item",{key:e.name,attrs:{index:e.name}},[n("span",{staticClass:"menu-item-tabname",on:{click:function(n){return t.openTab(e.name)}}},[t._v(t._s(e.title))]),t._v(" "),n("i",{staticClass:"el-icon-close menu-item-close",on:{click:function(n){return n.stopPropagation(),t.closeTab(e.name)}}})])}))],2)],1),t._v(" "),n("el-tabs",{class:{"add-disabled":t.queryList.length>=15},attrs:{type:"card",editable:""},on:{edit:t.tabsEdit},nativeOn:{click:function(e){return t.tableClick(e)}},model:{value:t.activeTabName,callback:function(e){t.activeTabName=e},expression:"activeTabName"}},[n("el-dropdown",{staticStyle:{display:"none"},attrs:{trigger:"click"}},[n("span",{staticClass:"closeTabdropdown"}),t._v(" "),n("el-dropdown-menu",{staticClass:"closeTabdropdownMenu",attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{nativeOn:{click:function(e){return t.addTabFn("add")}}},[t._v("新建查询")]),t._v(" "),n("el-dropdown-item",{nativeOn:{click:function(e){return t.addTabFn("save")}}},[t._v("已保存查询")])],1)],1),t._v(" "),t._l(t.queryList,(function(e){return n("el-tab-pane",{key:e.name,attrs:{label:e.title,name:e.name}},[n("template",{slot:"label"},[e.inputType?[n("el-input",{directives:[{name:"autoFous",rawName:"v-autoFous"}],staticClass:"tabNameInput",attrs:{title:e.validMsg||e.title,placeholder:"标签名称",minlength:"3",size:"mini"},on:{input:function(n){e.title=t.handelInput(e)},blur:function(n){return t.titleInputBlur(e)}},nativeOn:{keydown:[function(n){return!n.type.indexOf("key")&&t._k(n.keyCode,"enter",13,n.key,"Enter")?null:t.titleInputBlur(e)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")&&t._k(e.keyCode,"right",39,e.key,["Right","ArrowRight"])&&t._k(e.keyCode,"delete",[8,46],e.key,["Backspace","Delete","Del"])||"button"in e&&2!==e.button?null:void e.stopPropagation()}]},model:{value:e.title,callback:function(n){t.$set(e,"title",n)},expression:"item.title"}})]:[n("span",{staticClass:"tabName"},[!e.result||0!==e.result.status&&1!==e.result.status&&2!==e.result.status?t._e():n("svg-icon",{attrs:{"icon-class":t.tabIcon(e.result)}}),t._v(" "),e.result&&(e.result.running||3===e.result.status)?n("i",{staticClass:"el-icon-loading"}):t._e(),t._v(" "),n("el-button",{attrs:{type:"text"},nativeOn:{dblclick:function(t){e.inputType=!0}}},[t._v(t._s(e.title))])],1)]],2),t._v(" "),n("div",{staticClass:"query-tab-content"},[n("QueryTabItem",{key:t.region,ref:e.name,refInFor:!0,attrs:{data:e,"active-tab-name":t.activeTabName},on:{keyDownExecute:t.keyDownExecute,changeName:function(e){t.activeTabName=e}}})],1)],2)}))],2)],1),t._v(" "),n("MetadataView",{ref:"MetadataView",attrs:{region:t.region,width:t.metaDateWidth},on:{update:function(e){t.visible=e}},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}}),t._v(" "),n("TemporaryTable",{attrs:{drawer:t.drawer},on:{"update:drawer":function(e){t.drawer=e}}}),t._v(" "),n("el-dialog",{staticClass:"saveList_dial",attrs:{title:"已保存列表",visible:t.addSaveDial,width:"45%"},on:{"update:visible":function(e){t.addSaveDial=e},close:t.saveDialClose}},[n("div",{staticClass:"saveList_content"},[n("div",{staticClass:"dial_search"},[n("el-input",{staticClass:"search_item",attrs:{placeholder:"查询名称",size:"mini",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchSaveList(e)}},model:{value:t.params.title,callback:function(e){t.$set(t.params,"title",e)},expression:"params.title"}},[n("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{cursor:"pointer"},attrs:{slot:"suffix"},on:{click:t.searchSaveList},slot:"suffix"})])],1),t._v(" "),n("div",{staticClass:"search_save_list"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.saveListLoading,expression:"saveListLoading"}],ref:"saveDialTable",staticStyle:{width:"100%"},attrs:{data:t.saveList,"header-cell-style":{height:"36px",padding:"0px"},"cell-style":{height:"32px",padding:"0px"}}},[n("el-table-column",{attrs:{label:"",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-radio",{attrs:{label:e.row},model:{value:t.addQuerySave,callback:function(e){t.addQuerySave=e},expression:"addQuerySave"}},[t._v(" ")])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"title",label:"名称",width:"140"}}),t._v(" "),n("el-table-column",{attrs:{prop:"querySql",label:"查询","show-overflow-tooltip":""}})],1),t._v(" "),n("el-pagination",{attrs:{total:t.total,"current-page":t.params.pageNum,"page-sizes":[10,20,30,50,100],"page-size":t.params.pageSize,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)]),t._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.addSaveDial=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.addSaveSub}},[t._v("确 定")])],1)])],1)},o=[],s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"data-config"},[n("div",{staticClass:"config_title"},[n("el-radio-group",{staticClass:"config_tool ellipsis",attrs:{size:"mini",fill:"#7c8de9"},model:{value:t.tabActive,callback:function(e){t.tabActive=e},expression:"tabActive"}},[n("el-radio-button",{attrs:{label:"datas"}},[t._v("元数据预览")]),t._v(" "),n("el-radio-button",{attrs:{label:"history"}},[t._v("最近查询记录")])],1),t._v(" "),n("el-tooltip",{attrs:{effect:"dark",placement:"right"},scopedSlots:t._u([{key:"content",fn:function(){return[t._v("\n        "+t._s("datas"===t.tabActive?"点击此按钮，可刷新出新增的数据库/数据表":"点击此按钮,可刷新查询记录列表")+"\n      ")]},proxy:!0}])},[t._v(" "),n("i",{class:["title_tips",t.refreshing?"el-icon-loading":"el-icon-refresh",{refreshing:t.refreshing}],on:{click:function(e){return t.refreshConfig(t.tabActive)}}})])],1),t._v(" "),n("el-form",{directives:[{name:"show",rawName:"v-show",value:"datas"===t.tabActive,expression:"tabActive === 'datas'"}],staticClass:"config_from",attrs:{"label-position":"top",model:t.form,size:"mini"}},[n("el-form-item",{staticClass:"config_ag"},[n("div",{staticClass:"config_ag_item"},[n("el-select",{staticClass:"w100",attrs:{title:t.form.catalog,placeholder:"请选择数据源"},model:{value:t.form.catalog,callback:function(e){t.$set(t.form,"catalog",e)},expression:"form.catalog"}},[n("svg-icon",{attrs:{slot:"prefix","icon-class":"artifact"},slot:"prefix"}),t._v(" "),t._l(t.filterCatalogList,(function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})}))],2)],1),t._v(" "),n("div",{staticClass:"config_ag_item"},[n("el-select",{staticClass:"w100",attrs:{filterable:"",title:t.form.database,placeholder:"请选择数据库"},model:{value:t.form.database,callback:function(e){t.$set(t.form,"database",e)},expression:"form.database"}},[n("svg-icon",{attrs:{slot:"prefix","icon-class":"dataSource"},slot:"prefix"}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.dbLoading,expression:"dbLoading"}],staticStyle:{"text-align":"center",padding:"10px"}},[n("i",{staticClass:"el-icon-loading"})]),t._v(" "),t._l(t.dbList,(function(e){return n("el-option",{directives:[{name:"show",rawName:"v-show",value:!t.dbLoading,expression:"!dbLoading"}],key:e,attrs:{label:e,value:e}})}))],2)],1)]),t._v(" "),n("el-form-item",{staticClass:"config_tuck",scopedSlots:t._u([{key:"label",fn:function(){return[n("div",{staticClass:"label"},[n("svg-icon",{staticClass:"title_follow",attrs:{"icon-class":"follow"}}),t._v(" "),n("span",{staticClass:"text"},[t._v("我的收藏")])],1)]},proxy:!0}])},[t._v(" "),n("div",{staticClass:"tuck_content"},[n("div",{staticClass:"configLoading"},[n("i",{directives:[{name:"show",rawName:"v-show",value:t.tuckLoading,expression:"tuckLoading"}],staticClass:"el-icon-loading"})]),t._v(" "),t.tuckList.length<=0&&!t.tuckLoading?n("el-empty",{attrs:{description:"暂无收藏"}}):n("div",{staticClass:"content"},t._l(t.tuckList,(function(e){return n("div",{key:e.id,staticClass:"tuck_item",on:{dblclick:function(n){return t.select("table",e.table,e.db)}}},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.table,placement:"top"}},[n("div",{staticClass:"tuck_table_name ellipsis"},[t._v(t._s(e.table))])]),t._v(" "),n("div",{staticClass:"item_right"},[n("el-tooltip",{attrs:{content:"定位",placement:"top",enterable:!1},nativeOn:{click:function(n){return t.tuckLockTable(e)}}},[n("svg-icon",{staticClass:"fixed",attrs:{"icon-class":"fixed"}})],1),t._v(" "),n("el-tooltip",{attrs:{effect:"dark",content:"取消",placement:"top",enterable:!1},nativeOn:{click:function(n){return t.cancelTuck(e.id)}}},[n("i",{staticClass:"el-icon-close"})])],1)],1)})),0)],1)]),t._v(" "),n("el-form-item",[n("div",{staticClass:"config_table"},[n("div",{staticClass:"table_title"},[n("el-input",{staticClass:"table_search",attrs:{placeholder:"请输入表名","suffix-icon":"el-icon-search",clearable:""},model:{value:t.form.keyword,callback:function(e){t.$set(t.form,"keyword",e)},expression:"form.keyword"}}),t._v(" "),t.formatEngine?n("el-dropdown",{directives:[{name:"permission",rawName:"v-permission",value:t.permission,expression:"permission"}],attrs:{placement:"bottom-start",trigger:"click"}},[n("i",{staticClass:"el-icon-circle-plus-outline"}),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{"data-testid":"crate_table"},nativeOn:{click:function(e){return t.changeDrawer(e)}}},[t._v("创建临时表")]),t._v(" "),n("el-dropdown-item",{attrs:{"data-testid":"sql_crate_table"},nativeOn:{click:function(e){return t.$emit("sqlCreateTable",{db:t.form.database})}}},[t._v("使用SQL创建")])],1)],1):t._e()],1),t._v(" "),n("div",{staticClass:"configLoading table"},[n("i",{directives:[{name:"show",rawName:"v-show",value:t.tableLoading,expression:"tableLoading"}],staticClass:"el-icon-loading"})]),t._v(" "),n("div",{staticClass:"table_content"},[t.showTableList.length<=0&&!t.tableLoading?n("el-empty",{attrs:{description:"暂无数据"}}):n("div",{ref:"tableTree",staticClass:"table-tree"},t._l(t.showTableList,(function(e,r){return n("div",{key:e+r,staticClass:"table-item"},[n("div",{staticClass:"table-title",on:{click:function(n){return n.stopPropagation(),t.clickTable(e)}}},[n("svg-icon",{staticClass:"table-title-icon",attrs:{"icon-class":"table"}}),t._v(" "),n("el-tooltip",{ref:"tooltip"+e,refInFor:!0,staticClass:"item",attrs:{effect:"dark",disabled:t.isTipDisabled,content:e,placement:"bottom"}},[n("span",{staticClass:"table-title-text ellipsis",on:{mouseenter:t.isShowTooltip,dblclick:function(n){return t.select("table",e)}}},[t._v("\n                    "+t._s(e)+"\n                  ")])]),t._v(" "),n("span",{class:["table_icon","temp_database"===t.form.database&&"hive"===t.catalog?"widthAdd":"","hive"===t.catalog?"widthSub":"","temp_database"===t.form.database?"widthSub":""]},["hive"===t.catalog?n("el-tooltip",{attrs:{content:"查看",placement:"top",enterable:!1},nativeOn:{click:function(n){return n.stopPropagation(),t.lockTable(e)}}},[n("svg-icon",{staticClass:"eye",attrs:{"icon-class":"eye-open-2"}})],1):t._e(),t._v(" "),n("el-tooltip",{attrs:{placement:"top",enterable:!1},nativeOn:{click:function(n){return n.stopPropagation(),t.addTuck(e)}},scopedSlots:t._u([{key:"content",fn:function(){return[t._v("\n                      "+t._s(t.tuckNameList.includes(e)?"取消":"收藏")+"\n                    ")]},proxy:!0}],null,!0)},[t._v(" "),n("svg-icon",{class:["follow",t.tuckNameList.includes(e)?"shadow":""],attrs:{"icon-class":"follow"}})],1),t._v(" "),"temp_database"===t.form.database?n("el-tooltip",{attrs:{content:"导入",placement:"top",enterable:!1}},[n("svg-icon",{staticClass:"import",attrs:{"icon-class":"import"},on:{click:function(n){return n.stopPropagation(),t.importDial(e)}}})],1):t._e()],1)],1)])})),0)],1)])])],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"history"===t.tabActive,expression:"tabActive === 'history'"},{name:"loadMore",rawName:"v-loadMore",value:{fn:t.searchHistory,selector:".query_content"},expression:"{ fn: searchHistory, selector: '.query_content' }"}],staticClass:"history_query"},[n("div",{staticClass:"query_search"},[n("el-input",{staticClass:"condition-input",attrs:{size:"mini",placeholder:"搜索历史查询sql",clearable:""},on:{change:t.filterChange},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchHistory(e)}},model:{value:t.historyFilterText,callback:function(e){t.historyFilterText=e},expression:"historyFilterText"}},[n("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{cursor:"pointer"},attrs:{slot:"suffix"},on:{click:t.searchHistory},slot:"suffix"})])],1),t._v(" "),n("div",{staticClass:"query_content"},[n("div",{staticClass:"configLoading"},[n("i",{directives:[{name:"show",rawName:"v-show",value:t.historyLoading,expression:"historyLoading"}],staticClass:"el-icon-loading"})]),t._v(" "),t._l(t.historyQueryList,(function(e){return n("div",{key:e.id,staticClass:"query_item"},[n("div",{staticClass:"query_title"},[n("span",{staticClass:"query_id"},[n("el-tag",{attrs:{type:t.historyTagStatus[e.status+""],size:"mini"}},[t._v(t._s(e.id))])],1),t._v(" "),n("span",{staticClass:"time"},[t._v(t._s(t.$utils.parseTime(e.startTime,"{y}-{m}-{d} {h}:{i}")))])]),t._v(" "),n("div",{staticClass:"query_sql"},[n("el-tooltip",{attrs:{effect:"dark",placement:"right","popper-class":"table_overflow_tootip"},nativeOn:{click:function(n){return t.goQueryTab(e)}},scopedSlots:t._u([{key:"content",fn:function(){return[n("div",{staticStyle:{height:"100%",overflow:"auto"}},[t._v(t._s(e.querySql))])]},proxy:!0}],null,!0)},[t._v(" "),n("span",{staticClass:"cell-ellipsis2 query_text"},[t._v(t._s(e.querySql))])])],1)])}))],2)]),t._v(" "),n("el-dialog",{attrs:{visible:t.dialogVisible,width:"45%","close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.dialogVisible=e},close:t.closeDial},scopedSlots:t._u([{key:"title",fn:function(){return[n("div",{staticClass:"title"},[n("span",[t._v("导入数据")]),t._v(" "),n("div",{staticClass:"title-tips"},[t._v("支持用户基于原有的数据结构重新导入数据,不支持重新解析数据结构,因此请您确保导入的数据和原有的数据结构保持一致")])])]},proxy:!0}])},[t._v(" "),n("div",{staticClass:"upload"},[n("div",{staticClass:"label"},[n("span",[t._v("\n          选择文件\n          "),n("el-tooltip",{attrs:{content:"上传数据前,请你确保单元格中不存在回车换行,否则建表之后,会出现数据乱行的情况",placement:"top-start"}},[n("svg-icon",{staticClass:"svg_help",staticStyle:{"vertical-align":"middle","margin-top":"-3px"},attrs:{"icon-class":"help"}})],1),t._v("\n          :\n        ")],1)]),t._v(" "),n("el-upload",{ref:"rebateUpload",staticClass:"upload-demo",attrs:{action:"",accept:t.accept,"on-remove":t.fileRemove,limit:1,"file-list":t.field,"on-exceed":t.fileExceed,"on-change":t.fileChange,"auto-upload":!1}},[n("el-button",{attrs:{size:"mini",type:"primary"}},[t._v("点击上传")]),t._v(" "),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("仅支持上传 .csv 文件格式的数据,上传数据量最大为50MB")])],1)],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.running&&t.percentage>0,expression:"running && percentage > 0"}],staticClass:"progress"},[n("div",{staticClass:"label"},[t._v(t._s(t.percentageText)+" :")]),t._v(" "),n("el-progress",{attrs:{percentage:t.percentage}})],1),t._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")])],1)])],1)},l=[],u=n("8cbe"),c=n("7d99"),f=n("2f62"),h=n("bc3a"),p=n.n(h),d=n("a026"),m={switchQueryTab:"SWITCH-QUERY-TAB"},g=new d["default"],v=n("953e");function b(t){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},b(t)}function y(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */y=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var a=e&&e.prototype instanceof v?e:v,o=Object.create(a.prototype),s=new j(r||[]);return i(o,"_invoke",{value:L(t,n,s)}),o}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h="suspendedStart",p="suspendedYield",d="executing",m="completed",g={};function v(){}function w(){}function _(){}var k={};u(k,o,(function(){return this}));var D=Object.getPrototypeOf,x=D&&D(D(F([])));x&&x!==n&&r.call(x,o)&&(k=x);var C=_.prototype=v.prototype=Object.create(k);function S(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function n(i,a,o,s){var l=f(t[i],t,a);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==b(c)&&r.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,o,s)}),(function(t){n("throw",t,o,s)})):e.resolve(c).then((function(t){u.value=t,o(u)}),(function(t){return n("throw",t,o,s)}))}s(l.arg)}var a;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return a=a?a.then(i,i):i()}})}function L(e,n,r){var i=h;return function(a,o){if(i===d)throw new Error("Generator is already running");if(i===m){if("throw"===a)throw o;return{value:t,done:!0}}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var l=T(s,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===h)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=d;var u=f(e,n,r);if("normal"===u.type){if(i=r.done?m:p,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=m,r.method="throw",r.arg=u.arg)}}}function T(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var a=f(i,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,g;var o=a.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function F(e){if(e||""===e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(b(e)+" is not iterable")}return w.prototype=_,i(C,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:w,configurable:!0}),w.displayName=u(_,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,u(t,l,"GeneratorFunction")),t.prototype=Object.create(C),t},e.awrap=function(t){return{__await:t}},S(O.prototype),u(O.prototype,s,(function(){return this})),e.AsyncIterator=O,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new O(c(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},S(C),u(C,l,"Generator"),u(C,o,(function(){return this})),u(C,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=F,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var l=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),A(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;A(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:F(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}function w(t,e,n,r,i,a,o){try{var s=t[a](o),l=s.value}catch(u){return void n(u)}s.done?e(l):Promise.resolve(l).then(r,i)}function _(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){w(a,r,i,o,s,"next",t)}function s(t){w(a,r,i,o,s,"throw",t)}o(void 0)}))}}function k(t){return S(t)||C(t)||x(t)||D()}function D(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function x(t,e){if(t){if("string"===typeof t)return O(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?O(t,e):void 0}}function C(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function S(t){if(Array.isArray(t))return O(t)}function O(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function L(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function T(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?L(Object(n),!0).forEach((function(e){E(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function E(t,e,n){return e=A(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function A(t){var e=j(t,"string");return"symbol"===b(e)?e:String(e)}function j(t,e){if("object"!==b(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==b(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var F={props:{},data:function(){return{tabActive:"datas",form:{engine:"",catalog:Object(v["a"])("ds-query-catalog")||"",database:Object(v["a"])("ds-query-database")||"",keyword:""},dbList:[],tableList:[],tableLoading:!1,refreshing:!1,dbLoading:!1,dialogVisible:!1,field:[],running:!1,percentageStatus:0,percentage:0,tableName:"",historyQueryList:[],historyLoading:!1,historyListEnd:!1,tuckList:[],tuckLoading:!1,historyTagStatus:{0:"success",1:"danger",2:"warning",3:""},historyFilterText:"",params:{info:"",pageSize:30,pageNum:1},isTipDisabled:!1}},computed:T(T({},Object(f["c"])(["userInfo","region","catalogList","catalog","currentUserGroup"])),{},{tuckNameList:function(){return this.tuckList.map((function(t){var e=t.table;return e}))},formatEngine:function(){var t=this,e=["hive","iceberg"];return this.form.catalog&&e.some((function(e){return t.form.catalog.startsWith(e)}))},permission:function(){var t={condition:"external",instead:!0};return t.condition_met=this.userInfo?this.userInfo.tenantName:"",t},filterCatalogList:function(){return this.catalogList.filter((function(t){return"mysql_databend-test"!==t}))},showTableList:function(){var t=this;return this.form.keyword?this.tableList.filter((function(e){return e.includes(t.form.keyword)})):this.tableList},accept:function(){return".csv"},percentageText:function(){return["初始化状态","正在上传","已取消","已完成"][this.percentageStatus]}}),watch:{tuckList:function(){this.tableHeight()},catalog:function(t){this.form.catalog!==t&&(this.form.catalog=t)},catalogList:function(t){t.length>0&&!this.form.catalog&&(this.form.catalog=t[0])},dbList:function(){this.form.catalog&&this.form.database&&this.getTableList()},region:function(t,e){var n,r;this.getCatalogAndEngine({region:t});var i=(null==(n=JSON.parse(Object(v["a"])("ds-query-catalogObj")))?void 0:n[e])||"",a=(null==(r=JSON.parse(Object(v["a"])("ds-query-catalogObj")))?void 0:r[t])||"";this.form.catalog=a,i===a&&""!==i&&this.getDbList(),this.form.database="",this.dbList=[],this.tableList=[]},tabActive:function(t){"history"===t?(this.historyListEnd=!1,this.params.pageNum=1,this.historyQueryList=[],this.searchHistory()):this.historyFilterText=""},"form.catalog":function(t){this.getDbList(),this.$store.commit("SET_CATALOG",t),Object(v["c"])("ds-query-catalog",t);var e=JSON.parse(Object(v["a"])("ds-query-catalogObj"))||{};Object(v["c"])("ds-query-catalogObj",JSON.stringify(Object.assign(e,E({},this.region,t))))},"form.database":function(t){this.tableList=[],this.getTableList(),Object(v["c"])("ds-query-database",t)}},created:function(){this.region&&this.getCatalogAndEngine({region:this.region}),this.region&&this.form.catalog&&this.form.database?(this.getTableList(),this.getDbList()):this.region&&this.form.catalog&&this.getDbList()},mounted:function(){this.tableHeight()},methods:T(T(T({},Object(f["b"])(["getCatalogAndEngine"])),Object(f["d"])(["SET_METADATA","SET_TABLELIST"])),{},{isShowTooltip:function(t){var e=t.target.clientWidth,n=t.target.scrollWidth;this.isTipDisabled=!(n>e)},goQueryTab:function(t){g.$emit(m.switchQueryTab,t)},tableHeight:function(){var t=this;this.$nextTick((function(){var e=document.querySelector(".config_tuck .tuck_content");if(e){var n=t.$refs.tableTree;n&&setTimeout((function(){n.style.height="calc(100vh - ".concat(282+e.offsetHeight,"px)")}))}}))},filterChange:function(){this.historyListEnd=!1,this.params.pageNum=1,this.historyQueryList=[],this.searchHistory()},searchHistory:function(){var t=this;if(!this.historyListEnd&&!this.historyLoading){this.historyLoading=!0;var e=T(T({},this.params),{},{query_sql:this.historyFilterText.trim(),createBy:this.userInfo.userId});Object(u["pb"])(e).then((function(e){var n,r=e.data;0===t.historyQueryList.length?t.historyQueryList=r.list:(n=t.historyQueryList).push.apply(n,k(r.list));t.params.pageNum++,r.list.length<t.params.pageSize&&(t.historyListEnd=!0)})).finally((function(){t.historyLoading=!1}))}},tuckLockTable:function(t){this.form.database!==t.db&&(this.form.database=t.db),this.form.keyword=t.table||""},cancelTuck:function(t){var e=this;Object(u["D"])({id:t+""}).then((function(t){t.data&&(e.$message({type:"success",message:"取消成功"}),e.getTuckTableList())}))},getTuckTableList:function(){var t=this;this.tuckLoading=!0,this.tuckList=[];var e={catalog:this.form.catalog,region:this.region};Object(u["ob"])(e).then((function(e){t.tuckList=e.data||[]})).finally((function(){t.tuckLoading=!1}))},lockTable:function(t){var e=this,n={pageSize:10,pageNum:1,keyWord:"".concat(this.form.database,".").concat(t)};Object(c["y"])(n).then((function(t){if(0===t.code&&t.data&&t.data.results&&t.data.results.length>0){var n=t.data.results[0],r=e.$router.resolve({path:"/meta/detail",query:{id:n.id,region:n.region,databaseName:n.db_name,tableName:n.table_name}});window.open(r.href)}else e.$message({type:"warning",message:"获取元数据失败"})}))},addTuck:function(t){var e=this;if(this.tuckNameList.includes(t))this.cancelTuck(this.tuckList.find((function(e){return e.name===t})).id);else{var n={name:t,is_active:1,region:this.region,catalog:this.form.catalog,db:this.form.database};Object(u["k"])(n).then((function(t){e.$message({type:"success",message:"收藏成功"}),e.getTuckTableList()})).catch((function(){}))}},changeDrawer:function(){this.$emit("changeDrawer",!0)},importDial:function(t){this.dialogVisible=!0,this.tableName=t},getDbList:function(t){var e=this;if(this.form.catalog)return this.getTuckTableList(),this.dbLoading=!0,Object(u["Y"])({engine:this.form.engine,catalog:this.form.catalog,region:this.region}).then((function(n){var r=n.data;e.dbList=r,e.dbList.length>0?e.form.database=t?t.db:e.currentUserGroup.defaultHiveDbName?e.currentUserGroup.defaultHiveDbName:e.dbList[0]:e.refreshing=!1})).finally((function(){e.dbLoading=!1}));this.dbList=[]},getTableList:function(){var t=this;this.form.database?(this.tableLoading=!0,Object(u["mb"])({engine:this.form.engine,catalog:this.form.catalog,database:this.form.database,region:this.region}).then((function(e){var n=e.data;t.tableList=n,t.SET_TABLELIST(n||[])})).finally((function(){t.tableLoading=!1,t.refreshing=!1}))):this.tableList=[]},clickTable:function(t){this.$emit("lookMetadata",{catalog:this.form.catalog,database:this.form.database,table:t})},select:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=n||this.form.database;this.$emit("select",t,r,e)},refreshConfig:function(){var t=_(y().mark((function t(e,n){return y().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("datas"!==e){t.next=16;break}if(!this.refreshing){t.next=3;break}return t.abrupt("return");case 3:return this.refreshing=!0,t.next=6,Object(u["q"])();case 6:return this.tableList=[],this.tuckList=[],this.getCatalogAndEngine({region:this.region}),t.next=11,this.getDbList();case 11:n&&this.tuckLockTable(n),this.SET_METADATA({region:this.region,resultData:[]}),this.$emit("closeVisible"),t.next=17;break;case 16:"history"===e&&(this.historyFilterText="",this.filterChange());case 17:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}(),closeDial:function(){this.cancel&&this.cancel(),this.percentageStatus=0,this.running=!1,this.field=[]},cancelFile:function(){this.cancel&&this.cancel(),this.$message({type:"warning",message:"已取消,重新上传文件的话请先删除当前文件",duration:4e3})},fileChange:function(t,e){var n=this,r=this,i=p.a.CancelToken,a=this.beforeAvatarUpload(t);if(a||(this.field=e.splice(e.length-1,1)),a){this.field=e,this.running=!0;var o=new FormData,s={headers:{"Content-Type":"multipart/form-data;"},timeout:6e5,cancelToken:new i((function(t){r.cancel=t})),onUploadProgress:function(t){n.onUploadProgress(t)}},l={database:"temp_database",table:this.tableName,file:t.raw,engine_key:"",region:this.region,catalog:this.form.catalog};Object.keys(l).forEach((function(t){o.append(t,l[t])})),Object(u["tb"])(o,s).then((function(t){0===t.data.status&&(n.dialogVisible=!1,n.percentage=100,n.percentageStatus=3,n.$message({type:"success",message:"上传成功"}))})).catch((function(){n.percentageStatus=2}))}},onUploadProgress:function(t){if(t.lengthComputable){var e=Math.round(t.total/1024/1024);if(e<=1){var n=Math.round(t.loaded/t.total*100);this.percentage=n>99?99:n}else{var r=Math.round(t.loaded/t.total*100);r=Math.round((51-e)/50*r),this.percentage=r>99?99:r}}},beforeAvatarUpload:function(t){this.percentageStatus=1;var e=t.size/1024/1024<50;return e||this.$message.warning("上传文件不能超过 50MB!"),e},fileExceed:function(t,e){var n=this;this.cancel&&this.cancel(),this.$refs["rebateUpload"].clearFiles(),setTimeout((function(){n.percentageStatus=1})),this.percentage=0,this.$set(this.field[0],"raw",t[0]),this.$set(this.field[0],"name",t[0].name),this.$set(this.field[0],"size",t[0].size),this.$set(this.field[0],"status","ready"),this.$set(this.field[0],"percentage",0),this.$set(this.field[0],"uid",t[0].uid),this.$refs["rebateUpload"].handleStart(t[0])},fileRemove:function(t,e){this.cancel&&this.cancel(),this.percentageStatus=0,this.percentage=0,this.running=!1,this.field=e}})},q=F,N=(n("aced"),n("2877")),I=Object(N["a"])(q,s,l,!1,null,"d2e57ea8",null),$=I.exports,P=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"query-tab-item"},[n("div",{staticClass:"toolbar"},[n("div",{staticClass:"toolbar-l"},[n("span",{directives:[{name:"show",rawName:"v-show",value:!t.running,expression:"!running"}],staticClass:"toolbar-icon execute",on:{click:t.execute}},[n("el-button",{staticClass:"execute",attrs:{type:"success",plain:"",size:"mini"}},[n("i",{staticClass:"el-icon-caret-right"}),t._v("\n          运 行\n        ")])],1),t._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:t.running,expression:"running"}],staticClass:"toolbar-icon stop",staticStyle:{display:"relative"}},[n("el-button",{staticClass:"stop",attrs:{type:"info",plain:"",size:"mini"},on:{click:t.cancel}},[n("svg-icon",{staticClass:"icon",attrs:{"icon-class":"stop"}}),t._v("\n          终 止\n        ")],1)],1),t._v(" "),n("span",{staticClass:"toolbar-icon format",on:{click:t.formatSql}},[n("el-button",{staticClass:"formatBtn",attrs:{type:"warning",plain:"",size:"mini"}},[t._v("格式化")])],1),t._v(" "),n("span",{staticClass:"toolbar-icon"},[n("el-button",{staticClass:"controlBtn",attrs:{type:"danger",plain:"",size:"mini",disabled:!t.controlType},on:{click:t.hnadelcontrol}},[t._v("\n          定时调度\n          "),n("el-tooltip",{attrs:{content:"请您编写带有动态时间参数的一条SQL，成功运行后即可设置定时任务",placement:"top",enterable:!1}},[n("svg-icon",{staticClass:"svg_help",staticStyle:{"vertical-align":"text-top"},attrs:{"icon-class":"help"}})],1)],1)],1),t._v(" "),n("span",{directives:[{name:"permission",rawName:"v-permission",value:t.permission1,expression:"permission1"}],staticClass:"toolbar-menu"},[n("el-dropdown",{ref:"toolbarMenu",attrs:{placement:"bottom-start",trigger:"click","hide-on-click":!1},on:{command:t.handletoolBarCommand}},[n("span",{staticClass:"title_icon"},[n("svg-icon",{staticClass:"svg_extendedMenu",attrs:{"icon-class":"extendedMenu"}})],1),t._v(" "),n("el-dropdown-menu",{staticClass:"query_menu",attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{disabled:!t.showScan,command:"DataScanning"}},[t.scanningStatus?n("span",[t._v("\n                扫描数据量\n                "),"err"===t.scanningStatus?n("span",{staticStyle:{display:"inline-flex","align-items":"center"}},[t._v("\n                  (获取失败)\n                  "),n("svg-icon",{staticStyle:{"margin-left":"6px"},attrs:{"icon-class":"err"}})],1):n("span",[t._v(t._s("("+t.scanningStatus+")"))])]):n("span",[t._v("\n                预估扫描数据量\n                "),t.scanningLoading?n("i",{staticClass:"el-icon-loading"}):t._e()])]),t._v(" "),n("el-dropdown-item",{directives:[{name:"permission",rawName:"v-permission",value:t.permission,expression:"permission"}],attrs:{command:"apiPopoverFn",disabled:t.disabledBtn}},[t._v("\n              "+t._s(t.apiHistoryForm.path?"更新API":"生成API")+"\n            ")])],1)],1)],1)]),t._v(" "),n("div",{staticClass:"toolbar-r"},[n("div",{staticClass:"engine_select"},[n("span",{staticClass:"label"},[t._v("查询引擎: ")]),t._v(" "),n("el-select",{attrs:{placeholder:"请选择引擎",size:"mini",disabled:t.engineDisabledType},model:{value:t.engine,callback:function(e){t.engine=e},expression:"engine"}},t._l(t.engineList,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),n("span",{staticClass:"toolbar-icon",on:{click:t.save}},[n("el-button",{staticClass:"toolbar-save icon",attrs:{type:"primary",size:"mini"}},[n("svg-icon",{staticClass:"icon",attrs:{"icon-class":"save"}}),t._v("\n          保 存\n        ")],1)],1),t._v(" "),n("el-button",{class:["toolbar-icon","toolbar-share",t.showShare?"":"disabled"],attrs:{type:"primary",disabled:!t.showShare,size:"mini"},on:{click:t.shareBtn}},[n("svg-icon",{staticClass:"icon",attrs:{"icon-class":"share"}}),t._v("\n        分 享\n      ")],1)],1)]),t._v(" "),n("div",{key:t.data.name,ref:"sqlBox",staticClass:"sql-box",style:t.sqlBoxStyle},[t.AIsqlType?t._e():n("i",{staticClass:"btn-full-screen el-icon-full-screen",attrs:{title:t.fullscreen?"还原":"放大"},on:{click:t.switchFullscreen}}),t._v(" "),t.AIsqlType?t._e():n("el-popover",{attrs:{placement:"left-start",trigger:"click",width:"700","popper-class":"QE_popper"}},[n("div",{staticClass:"tips_box"},[n("div",{staticClass:"jinjia"},[n("div",{staticClass:"title"},[t._v("时间参数规则")]),t._v(" "),n("div",{staticClass:"tips_text"},[n("div",[t._v("例子：")]),t._v(" "),n("div",[t._v(t._s(t.text)+" "),n("b",[t._v("注意，符号一定要使用英文字符")])]),t._v(" "),n("div",[t._v("说明：")]),t._v(" "),n("div",[t._v("execution_date 表示任务的入参时间，小时任务为每小时的0分，天级别的任务为每天0点0分，周任务为每周一的0点0分，月度任务为每月1号的0点0分")]),t._v(" "),n("div",[t._v("macros.timedelta(hours=8) 表示所需时间和入参时间的差值")]),t._v(" "),n("div",[t._v('strftime("%Y%m%d") 表示需要什么格式，譬如现在获取的格式是 20200108 eg：如果需要2020-01-08 ，则可写成strftime("%Y-%m-%d")')])]),t._v(" "),n("el-table",{attrs:{data:t.gridData,size:"mini","cell-style":{padding:"4px 0"}}},[n("el-table-column",{attrs:{"min-width":"235",property:"expression",label:"JINJA表达式"}}),t._v(" "),n("el-table-column",{attrs:{"min-width":"420",property:"mean",label:"含义"}})],1)],1),t._v(" "),n("div",{staticClass:"title"},[t._v("快捷方式")]),t._v(" "),n("el-table",{attrs:{data:t.quickData,size:"mini","cell-style":{padding:"4px 0"}}},[n("el-table-column",{attrs:{"min-width":"235",property:"action",label:"操作"}}),t._v(" "),n("el-table-column",{attrs:{"min-width":"420",property:"keyword",label:"快捷键"}})],1)],1),t._v(" "),n("span",{staticClass:"tips",attrs:{slot:"reference"},slot:"reference"},[n("svg-icon",{staticClass:"keyboard",attrs:{"icon-class":"keyboard"}})],1)]),t._v(" "),!t.AIsqlType&&t.downType?n("div",{staticClass:"selection_btn"},[n("i",{staticClass:"el-icon-upload2 icon",on:{click:function(e){return t.handelCurrent("sub")}}}),t._v(" "),n("i",{staticClass:"el-icon-download icon",on:{click:function(e){return t.handelCurrent("add")}}})]):t._e(),t._v(" "),n("div",{staticClass:"editor_wrap"},[n("div",{staticClass:"editor",class:[t.transfEditorType?"transf":"",t.AIsqlType?"aIshow":""]},[t.transfEditorType?n("div",{staticClass:"editor_item"},[n("div",{staticClass:"title"},[t._v("Ares（原始SQL）")]),t._v(" "),n("monaco-editor",{key:t.data.grade+"",ref:"transfMonaco",style:{paddingBottom:(t.keyList.length>0?31*Math.ceil(t.keyList.length/8):0)+"px"},attrs:{"execute-type":!t.transfEditorType,"render-line-highlight":"all","scroll-beyond-last-line":!1,"custom-theme":t.customTheme,"read-only":void 0!==t.data.grade&&1!==t.data.grade},model:{value:t.oldQuerySql,callback:function(e){t.oldQuerySql=e},expression:"oldQuerySql"}}),t._v(" "),n("div",{staticClass:"tool"},[n("i",{staticClass:"el-icon-close",on:{click:t.closeEditor}})])],1):t._e(),t._v(" "),n("div",{staticClass:"editor_item"},[n("div",{staticClass:"title"},[t._v("Spark（转换后SQL）")]),t._v(" "),n("monaco-editor",{key:t.data.grade+"",ref:"monaco",staticClass:"content",style:{paddingBottom:(t.keyList.length>0?31*Math.ceil(t.keyList.length/8):0)+"px"},attrs:{"render-line-highlight":"all","down-type":t.downType,"execute-type":!t.transfEditorType,"scroll-beyond-last-line":!1,"custom-theme":t.customTheme,"read-only":void 0!==t.data.grade&&1!==t.data.grade},on:{"update:downType":function(e){t.downType=e},"update:down-type":function(e){t.downType=e},save:t.save,exec:function(e){return t.$emit("keyDownExecute",t.activeTabName)},"edit-position":t.editPosition,handelExecute:t.execute},model:{value:t.querySql,callback:function(e){t.querySql=e},expression:"querySql"}})],1)]),t._v(" "),t.AIsqlType?n("AIsql",{ref:"AIsql",staticClass:"ai_sql",attrs:{region:t.region,catalog:t.catalog,data:t.data},on:{close:function(e){return t.changeAIsqlType(!1)}}}):t._e()],1),t._v(" "),t.keyList.length>0?n("div",{staticClass:"variable"},[n("div",{staticClass:"row"},t._l(t.sqlKeyObj.keyList,(function(e){return n("div",{key:e.key,staticClass:"col"},[n("div",{staticClass:"label"},[n("el-tooltip",{staticClass:"item",attrs:{effect:"light",content:e.key,placement:"top","popper-class":"sqlParamsClass",disabled:e.key.length<8}},[n("span",[t._v(t._s(e.key))])])],1),t._v(" "),n("el-input",{class:t.redKey.includes(e.key)?"redInput":"",attrs:{disabled:!!e.disabled,placeholder:"请输入参数值",size:"mini"},model:{value:e.value,callback:function(n){t.$set(e,"value","string"===typeof n?n.trim():n)},expression:"item.value"}})],1)})),0)]):t._e()],1),t._v(" "),t.unExecuteType?n("div",{staticClass:"result"},[n("div",{staticClass:"drag",on:{mousedown:t.dragEagle}},[n("i",{staticClass:"bar"})]),t._v(" "),n("result",{ref:"result",attrs:{uuid:t.uuid,data:t.result,running:t.running,engine:t.engine,"result-option":t.resultOption,"progress-obj":t.progressObj},on:{correct:t.changeAIsqlType}})],1):t._e(),t._v(" "),t.dialogVisible?n("el-dialog",{attrs:{title:"保存查询",width:"700px","close-on-click-modal":!1,visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e},close:t.closeDialog,opened:t.openDialog}},[n("el-form",{ref:"form",attrs:{model:t.form,"label-width":"100px",rules:t.rules}},[n("el-form-item",{attrs:{label:"查询名称",prop:"title"}},[n("el-input",{attrs:{placeholder:"请输入查询名称"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"文件夹",prop:"folderName"}},[n("el-select",{ref:"selectTree",staticStyle:{width:"100%"},attrs:{placeholder:"请选择文件夹"},model:{value:t.form.folderName,callback:function(e){t.$set(t.form,"folderName",e)},expression:"form.folderName"}},[n("el-option",{attrs:{hidden:"",value:""}}),t._v(" "),n("customTree",{attrs:{"tree-data":t.folderList,"default-props":t.defaultProps,"is-contextmenu":!0,depth:3,"no-drag":t.noDrag},on:{"node-click":t.handelClickMove,moveFile:t.moveFile,delFile:t.delFile,resetFolderName:t.resetFolderName,addFile:t.addFile}})],1)],1),t._v(" "),n("el-form-item",{attrs:{label:"查询描述",prop:"description"}},[n("el-input",{attrs:{type:"textarea",autosize:{minRows:3,maxRows:5},placeholder:"请输入内容"},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"预览SQL"}},[n("div",{staticStyle:{height:"100px"}},[n("monaco-editor",{ref:"saveMonaco",attrs:{"read-only":!0},model:{value:t.querySql,callback:function(e){t.querySql=e},expression:"querySql"}})],1)])],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submit("determine")}}},[t._v("保 存")]),t._v(" "),1===t.form.submited?n("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submit("saveAS")}}},[t._v("另存为")]):t._e()],1)],1):t._e(),t._v(" "),n("el-dialog",{staticClass:"apiDial",attrs:{title:t.apiHistoryForm.path?"更新API":"生成API",visible:t.apiDialogStatus,width:"30%"},on:{"update:visible":function(e){t.apiDialogStatus=e}}},[t.apiPathShow?n("div",{staticClass:"apiDial_box"},[n("el-form",{ref:"apiForm",staticClass:"demo-ruleForm",attrs:{model:t.apiForm,rules:t.apiFormRules,"label-width":"90px"}},[n("el-form-item",{attrs:{label:"API名称:",prop:"title"}},[n("el-input",{attrs:{size:"mini"},model:{value:t.apiForm.title,callback:function(e){t.$set(t.apiForm,"title",e)},expression:"apiForm.title"}})],1)],1),t._v(" "),n("div",{staticClass:"floor"},[n("el-button",{on:{click:t.cancelApi}},[t._v("取消")]),t._v(" "),t.apiHistoryForm.path?n("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.saveApi("update")}}},[t._v("保存")]):n("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.saveApi("add")}}},[t._v("保存")])],1)],1):n("div",{staticClass:"apiDial_box"},[n("div",{staticClass:"apiTips_title"},[n("i",{staticClass:"el-icon-warning-outline"}),t._v("\n        "+t._s("API已"+(t.apiHistoryForm.path?"更新":"保存")+"至'已生成的API'列表中")+"\n      ")]),t._v(" "),n("div",{staticClass:"tips-path"},[n("span",[t._v("API Path : "+t._s(t.newApiPath)+"}")]),t._v(" "),n("el-tooltip",{attrs:{effect:"dark",content:"复制",placement:"top",enterable:!1}},[n("i",{staticClass:"el-icon-document-copy",on:{click:function(e){return t.copyPath(t.newApiPath)}}})])],1),t._v(" "),n("div",{staticClass:"floor"},[n("el-button",{on:{click:function(e){t.apiDialogStatus=!1}}},[t._v("关闭")])],1)])]),t._v(" "),n("shareDialog",{ref:"shareDialog",attrs:{grade:t.data.grade,"share-url":t.shareUrl},on:{submitFn:t.shaerSubmit}}),t._v(" "),t.smartEngineObj&&t.smartEngineObj.smartEngineType?n("div",{staticClass:"smartEngine"},[n("div",{staticClass:"title"},[t._v("引擎推荐")]),t._v(" "),n("div",{staticClass:"box"},[n("div",{staticClass:"content"},[t._v(t._s("根据智能引擎，我们推荐您使用"+t.smartEngine+"引擎来运行"))]),t._v(" "),n("div",{staticClass:"footer"},[n("el-checkbox",{staticClass:"tipsbtn",model:{value:t.cpmType,callback:function(e){t.cpmType=e},expression:"cpmType"}},[t._v("一天内不再弹窗")]),t._v(" "),n("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.smartEngineFn(!1)}}},[t._v("仍要原引擎")]),t._v(" "),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.smartEngineFn(!0)}}},[t._v("接受推荐")])],1)])]):t._e(),t._v(" "),n("ControlDial",{ref:"controlDial",on:{submit:t.controlSubmit}})],1)},B=[],z=n("ff91"),M=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{ref:"monaco",staticClass:"monaco-editor"})},Q=[],G=n("33f9"),R=n("846a"),H=n("a739"),U=n("ed08");function Y(t){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(t)}function V(t){return J(t)||X(t)||W(t)||K()}function K(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function W(t,e){if(t){if("string"===typeof t)return Z(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Z(t,e):void 0}}function X(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function J(t){if(Array.isArray(t))return Z(t)}function Z(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function tt(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */tt=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var a=e&&e.prototype instanceof v?e:v,o=Object.create(a.prototype),s=new E(r||[]);return i(o,"_invoke",{value:S(t,n,s)}),o}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h="suspendedStart",p="suspendedYield",d="executing",m="completed",g={};function v(){}function b(){}function y(){}var w={};u(w,o,(function(){return this}));var _=Object.getPrototypeOf,k=_&&_(_(A([])));k&&k!==n&&r.call(k,o)&&(w=k);var D=y.prototype=v.prototype=Object.create(w);function x(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function n(i,a,o,s){var l=f(t[i],t,a);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==Y(c)&&r.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,o,s)}),(function(t){n("throw",t,o,s)})):e.resolve(c).then((function(t){u.value=t,o(u)}),(function(t){return n("throw",t,o,s)}))}s(l.arg)}var a;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return a=a?a.then(i,i):i()}})}function S(e,n,r){var i=h;return function(a,o){if(i===d)throw new Error("Generator is already running");if(i===m){if("throw"===a)throw o;return{value:t,done:!0}}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var l=O(s,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===h)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=d;var u=f(e,n,r);if("normal"===u.type){if(i=r.done?m:p,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=m,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var a=f(i,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,g;var o=a.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(Y(e)+" is not iterable")}return b.prototype=y,i(D,"constructor",{value:y,configurable:!0}),i(y,"constructor",{value:b,configurable:!0}),b.displayName=u(y,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u(t,l,"GeneratorFunction")),t.prototype=Object.create(D),t},e.awrap=function(t){return{__await:t}},x(C.prototype),u(C.prototype,s,(function(){return this})),e.AsyncIterator=C,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new C(c(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},x(D),u(D,l,"Generator"),u(D,o,(function(){return this})),u(D,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=A,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var l=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:A(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}function et(t,e,n,r,i,a,o){try{var s=t[a](o),l=s.value}catch(u){return void n(u)}s.done?e(l):Promise.resolve(l).then(r,i)}function nt(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){et(a,r,i,o,s,"next",t)}function s(t){et(a,r,i,o,s,"throw",t)}o(void 0)}))}}function rt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function it(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?rt(Object(n),!0).forEach((function(e){at(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rt(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function at(t,e,n){return e=ot(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ot(t){var e=st(t,"string");return"symbol"===Y(e)?e:String(e)}function st(t,e){if("object"!==Y(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var lt=n("0505"),ut={name:"AnalysisCopy",props:{readOnly:{type:Boolean,default:!1},value:{type:String,default:""},theme:{type:String,default:"vs"},language:{type:String,default:"sql"},minimap:{type:Boolean,default:!1},scrollBeyondLastLine:{type:Boolean,default:!0},executeType:{type:Boolean,default:!1},renderLineHighlight:{type:String,default:"line"},customTheme:{type:Object,default:function(){return{rules:[],colors:{}}}}},data:function(){return{once:!0,dbList:[],tableList:[],startColumn:0,codes:"",editorOptions:{selectOnLineNumbers:!0,roundedSelection:!1,readOnly:this.readOnly,cursorStyle:"line",automaticLayout:!0,useTabStops:!1,fontSize:14,autoIndent:!1,folding:!0,foldingStrategy:"indentation",scrollBeyondLastLine:this.scrollBeyondLastLine,renderLineHighlight:this.renderLineHighlight,minimap:{enabled:this.minimap},scrollbar:{alwaysConsumeMouseWheel:!1}},currentIndex:0,segmentPositions:[],currentLine:"",debounceHandel:null}},computed:it({},Object(f["c"])(["catalog","provider","engineConfig"])),mounted:function(){var t=this;this.debounceHandel=Object(U["debounce"])(this.debounceRender,600);var e=this,n=this.engineConfig;if(!this.provider){var r=G["languages"].registerCompletionItemProvider(this.language,{triggerCharacters:["."],provideCompletionItems:function(){var t=nt(tt().mark((function t(r,i){var a,o,s,l;return tt().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=r.getWordUntilPosition(i),o={startLineNumber:i.lineNumber,endLineNumber:i.lineNumber,startColumn:a.startColumn,endColumn:a.endColumn},s=r.getValueInRange({startLineNumber:1,startColumn:1,endLineNumber:i.lineNumber,endColumn:i.column}),t.next=5,e.initSqlKeyWords(o,s,n);case 5:return l=t.sent,t.abrupt("return",{suggestions:l});case 7:case"end":return t.stop()}}),t)})));function r(e,n){return t.apply(this,arguments)}return r}()});this.SET_PROVIDER(r)}G["editor"].defineTheme("customTheme",{base:this.theme,inherit:!0,rules:this.customTheme.rules,colors:this.customTheme.colors}),this.monacoEditor=G["editor"].create(this.$refs.monaco,it({value:this.value,language:this.language,theme:"customTheme"},this.editorOptions)),this.monacoEditor.onDidChangeModelContent((function(e){t.startColumn=e.changes[0].rangeOffset;var n=t.monacoEditor.getValue();t.updateCode(n)})),this.monacoEditor.onMouseDown((function(e){var n;if(t.executeType&&(t.setLineStyle(e.target),t.$emit("update:downType",!0),3===(null==(n=e.target)?void 0:n.type))){var r;t.monacoEditor.setPosition({lineNumber:e.target.position.lineNumber,column:0}),t.monacoEditor.focus();var i=(null==(r=t.segmentPositions[t.currentIndex])?void 0:r.str)||"";t.$emit("handelExecute",e,i)}})),this.monacoEditor.onDidScrollChange((function(e){null==t.debounceHandel||t.debounceHandel()})),this.monacoEditor.onDidChangeCursorPosition((function(e){t.$emit("edit-position",e.position)})),this.monacoEditor.addCommand(G["KeyMod"].CtrlCmd|G["KeyCode"].KEY_S,(function(){t.$emit("save")})),this.monacoEditor.addCommand(G["KeyMod"].CtrlCmd|G["KeyMod"].Alt|G["KeyCode"].KEY_L,(function(){t.formatSql()})),this.monacoEditor.addCommand(G["KeyMod"].CtrlCmd|G["KeyCode"].Enter,(function(){t.$emit("exec")}))},destroyed:function(){this.monacoEditor.dispose()},methods:it(it({},Object(f["d"])(["SET_PROVIDER"])),{},{debounceRender:function(){this.renderRunBtn()},initSqlKeyWords:function(){var t=nt(tt().mark((function t(e,n,r){var i,a,o,s,l,c,f,h,p,d,m,g,v;return tt().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=r.region,o=r.catalog,s=V(R["a"][this.language]),l=["from","join","inner","FROM","JOIN","INNER"],c=/[a-zA-Z]*\.$/,f=n.lastIndexOf("}}"),h=n.lastIndexOf("{{"),!(h>0&&h>f)){t.next=9;break}return t.abrupt("return",[{label:"",insertText:"",sortText:"A".concat(name),detail:" "}]);case 9:if(p=n.split(" "),!l.includes(p[p.length-2])){t.next=18;break}return t.next=13,Object(u["Y"])({region:a,catalog:o,engine:""});case 13:return t.next=15,t.sent.data;case 15:this.dbList=t.sent,s=this.dbList,p[p.length-1].includes("\r\n")&&(s=V(R["a"][this.language]));case 18:if(!c.test(n)){t.next=25;break}return d=n.split(" "),m=d[d.length-1].split(".")[0],t.next=23,Object(u["mb"])({region:a,engine:"",catalog:o,database:m});case 23:g=t.sent,s=g.data;case 25:return v=null==(i=s)?void 0:i.map((function(t){return{label:t,insertText:t,sortText:"A".concat(name),detail:" ",range:e}})),t.abrupt("return",v||[]);case 27:case"end":return t.stop()}}),t,this)})));function e(e,n,r){return t.apply(this,arguments)}return e}(),setLineStyle:function(t){var e=this,n=this.monacoEditor.getValue(),r=n.split(/\s*;\s*/).filter((function(t){return t.trim()})),i=0,a=r.map((function(r,a){var o=n.indexOf(r,i),s=o+r.length;i=s;var l=e.monacoEditor.getModel().getPositionAt(o),u=e.monacoEditor.getModel().getPositionAt(s);return t.position.lineNumber>=l.lineNumber&&t.position.lineNumber<=u.lineNumber&&(e.currentIndex=a,e.currentLine&&e.currentLine.clear(),e.currentLine=e.monacoEditor.createDecorationsCollection([{range:new G["Range"](l.lineNumber,1,u.lineNumber,1),options:{isWholeLine:!0,marginClassName:"myGlyphMarginClass"}},{range:new G["Range"](t.position.lineNumber,1,t.position.lineNumber,1),options:{isWholeLine:!0,marginClassName:"myGlyphMarginClass_current"}}])),{startLineNumber:l.lineNumber,endLineNumber:u.lineNumber,str:r}}));this.segmentPositions=a,setTimeout((function(){e.renderRunBtn()}),300)},setCurrent:function(t){var e=this;this.currentLine&&this.currentLine.clear(),this.currentLine=this.monacoEditor.createDecorationsCollection([{range:new G["Range"](t.startLineNumber,1,t.endLineNumber,1),options:{isWholeLine:!0,marginClassName:"myGlyphMarginClass"}},{range:new G["Range"](t.startLineNumber,1,t.startLineNumber,1),options:{isWholeLine:!0,marginClassName:"myGlyphMarginClass_current"}}]),setTimeout((function(){e.renderRunBtn()}),300)},handelCurrent:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"add";this.currentIndex===this.segmentPositions.length-1&&"add"===t||0===this.currentIndex&&"sub"===t||("add"===t?this.currentIndex++:this.currentIndex--,this.setCurrent(this.segmentPositions[this.currentIndex]))},renderRunBtn:function(){var t=this.$refs.monaco,e=null==t?void 0:t.querySelector(".myGlyphMarginClass_current");e&&(e.innerHTML='\n        <div class="myGlyphMarginClass_btn">\n          <span class="btn_text">运行</span>\n          <image src='.concat(lt," />\n        </div>\n        "))},formatSql:function(){var t="";t=this.monacoEditor.getValue(),t&&(t=H["a"].format(t),this.monacoEditor.setValue(t),this.updateCode(t))},updateCode:function(t){this.codes=t,this.$emit("input",t)},setCode:function(t){t=t||"",this.monacoEditor.setValue(t)},insertContent:function(t){var e=this.monacoEditor.getSelection(),n=new G["Range"](e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn),r={major:1,minor:1},i={identifier:r,range:n,text:t,forceMoveMarkers:!0};this.monacoEditor.executeEdits(this.root,[i]),this.monacoEditor.focus()},getSelection:function(){var t=this.monacoEditor.getSelection();return this.monacoEditor.getModel().getValueInRange(t)}})},ct=ut,ft=(n("7581"),n("3bea"),n("dfc7"),Object(N["a"])(ct,M,Q,!1,null,"2f139f34",null)),ht=ft.exports,pt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{staticClass:"shaerDial",attrs:{title:"分享",visible:t.dialogVisible,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e},close:t.close}},[n("div",{staticClass:"wrapper"},[n("el-radio-group",{staticClass:"type",model:{value:t.shareType,callback:function(e){t.shareType=e},expression:"shareType"}},[n("el-radio",{attrs:{label:"one"}},[t._v("个 人")]),t._v(" "),n("el-radio",{attrs:{label:"all",disabled:3===t.grade}},[t._v("公 开")])],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"one"===t.shareType,expression:"shareType === 'one'"}],staticClass:"one_share"},[n("el-form",{ref:"form",attrs:{model:t.dialForm,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"分享给:",prop:"shareeEmail",rules:[{required:!0,message:"请选择被分享者",trigger:"change"}]}},[n("el-select",{attrs:{filterable:"",placeholder:"请输入用户邮箱","remote-method":function(e){t.remoteMethod(e)},remote:"","reserve-keyword":!1,loading:t.loadingSelect},model:{value:t.dialForm.shareeEmail,callback:function(e){t.$set(t.dialForm,"shareeEmail",e)},expression:"dialForm.shareeEmail"}},t._l(t.options,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value},nativeOn:{click:function(n){return t.handelClick(e)}}})})),1)],1),t._v(" "),n("el-form-item",{attrs:{label:"权限:",prop:"grade",rules:[{required:!0,message:"请选择权限级别",trigger:"change"}]}},[n("el-select",{attrs:{placeholder:"请选择权限"},model:{value:t.dialForm.grade,callback:function(e){t.$set(t.dialForm,"grade",e)},expression:"dialForm.grade"}},t._l(t.gradeOptions,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1),t._v(" "),n("div",{staticClass:"footer"},[n("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("确 定")])],1)],1),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:"all"===t.shareType,expression:"shareType === 'all'"}],staticClass:"all_share"},[n("div",{staticClass:"box_item"},[n("div",{staticClass:"title"},[t._v("链接:")]),t._v(" "),n("div",{staticClass:"url_box"},[t._v("\n          "+t._s(t.shareUrl)+"\n          "),n("el-tooltip",{attrs:{effect:"dark",content:"复制",placement:"top",enterable:!1}},[n("i",{staticClass:"el-icon-document-copy",on:{click:function(e){return t.copyUrl(t.shareUrl)}}})])],1)])])],1)])},dt=[],mt=n("f904"),gt=n.n(mt),vt=n("7e3c");function bt(t){return bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bt(t)}function yt(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */yt=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var a=e&&e.prototype instanceof v?e:v,o=Object.create(a.prototype),s=new E(r||[]);return i(o,"_invoke",{value:S(t,n,s)}),o}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h="suspendedStart",p="suspendedYield",d="executing",m="completed",g={};function v(){}function b(){}function y(){}var w={};u(w,o,(function(){return this}));var _=Object.getPrototypeOf,k=_&&_(_(A([])));k&&k!==n&&r.call(k,o)&&(w=k);var D=y.prototype=v.prototype=Object.create(w);function x(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function n(i,a,o,s){var l=f(t[i],t,a);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==bt(c)&&r.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,o,s)}),(function(t){n("throw",t,o,s)})):e.resolve(c).then((function(t){u.value=t,o(u)}),(function(t){return n("throw",t,o,s)}))}s(l.arg)}var a;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return a=a?a.then(i,i):i()}})}function S(e,n,r){var i=h;return function(a,o){if(i===d)throw new Error("Generator is already running");if(i===m){if("throw"===a)throw o;return{value:t,done:!0}}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var l=O(s,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===h)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=d;var u=f(e,n,r);if("normal"===u.type){if(i=r.done?m:p,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=m,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var a=f(i,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,g;var o=a.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(bt(e)+" is not iterable")}return b.prototype=y,i(D,"constructor",{value:y,configurable:!0}),i(y,"constructor",{value:b,configurable:!0}),b.displayName=u(y,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u(t,l,"GeneratorFunction")),t.prototype=Object.create(D),t},e.awrap=function(t){return{__await:t}},x(C.prototype),u(C.prototype,s,(function(){return this})),e.AsyncIterator=C,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new C(c(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},x(D),u(D,l,"Generator"),u(D,o,(function(){return this})),u(D,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=A,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var l=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:A(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}function wt(t,e,n,r,i,a,o){try{var s=t[a](o),l=s.value}catch(u){return void n(u)}s.done?e(l):Promise.resolve(l).then(r,i)}function _t(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){wt(a,r,i,o,s,"next",t)}function s(t){wt(a,r,i,o,s,"throw",t)}o(void 0)}))}}var kt={name:"ShareDialog",props:["grade","shareUrl"],data:function(){return{shareType:"one",dialogVisible:!1,loadingSelect:!1,tenantId:JSON.parse(sessionStorage.getItem("userInfo")).tenantId,dialForm:{sharee:"",shareeEmail:"",grade:""},options:[],powerOptions:[{label:"编辑",value:"1"},{label:"查看",value:"3"}]}},computed:{gradeOptions:function(){var t=this.grade?this.grade+"":"1",e=this.powerOptions.findIndex((function(e){return e.value===t}));return this.powerOptions.slice(e)}},methods:{copyUrl:function(t){gt()(t,{format:"text/plain"}),this.$message({type:"success",message:"已复制到剪贴板"})},handelClick:function(t){this.dialForm.sharee=t.name},submit:function(){var t=this;this.$refs.form.validate((function(e){e&&(t.$emit("submitFn",JSON.parse(JSON.stringify(t.dialForm))),t.dialogVisible=!1)}))},open:function(){this.dialogVisible=!0},close:function(){this.$refs.form.resetFields(),this.options=[],this.shareType="one",this.$emit("close")},remoteMethod:function(){var t=_t(yt().mark((function t(e,n){var r;return yt().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""===e.trim()){t.next=11;break}return this.loadingSelect=!0,t.next=4,Object(vt["N"])({name:e,tenantId:this.tenantId});case 4:return t.next=6,t.sent.data;case 6:r=t.sent,this.loadingSelect=!1,this.options=r.list.length>0?r.list.map((function(t){return{label:t.email,value:t.email,name:t.name}})):[],t.next=12;break;case 11:this.options=[];case 12:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()}},Dt=kt,xt=(n("6628"),Object(N["a"])(Dt,pt,dt,!1,null,"4606bf47",null)),Ct=xt.exports,St=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{staticClass:"controlDial",attrs:{title:"定时任务配置",visible:t.dialogVisible,width:"650px"},on:{"update:visible":function(e){t.dialogVisible=e},close:t.close}},[n("el-form",{ref:"taskFrom",attrs:{model:t.taskFrom,rules:t.rules,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"任务名称: ",prop:"taskName"}},[n("el-input",{model:{value:t.taskFrom.taskName,callback:function(e){t.$set(t.taskFrom,"taskName",e)},expression:"taskFrom.taskName"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"调度周期: ",prop:"schedule"}},[n("el-select",{staticClass:"cron-input",attrs:{clearable:""},model:{value:t.taskFrom.schedule,callback:function(e){t.$set(t.taskFrom,"schedule",e)},expression:"taskFrom.schedule"}},t._l(t.cycleList,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),n("el-form-item",{attrs:{label:"邮箱提醒: "}},[n("el-radio-group",{on:{change:function(e){return t.change(e,"email")}},model:{value:t.hasEmial,callback:function(e){t.hasEmial=e},expression:"hasEmial"}},[n("el-radio",{attrs:{label:0}},[t._v("否")]),t._v(" "),n("el-radio",{attrs:{label:1}},[t._v("是")])],1),t._v(" "),1===t.hasEmial?n("el-select",{staticClass:"emial_input",attrs:{placeholder:"请输入邮箱",clearable:"",filterable:"","allow-create":"","default-first-option":"",remote:"","remote-method":t.remoteMethod,loading:t.ownerLoading,"popper-class":"custom-popper"},model:{value:t.taskFrom.email,callback:function(e){t.$set(t.taskFrom,"email",e)},expression:"taskFrom.email"}},t._l(t.ownerList,(function(t){return n("el-option",{key:t.shareId,attrs:{value:t.email,label:t.email}})})),1):t._e()],1),t._v(" "),n("el-form-item",{attrs:{label:"开始时间: "}},[n("el-radio-group",{on:{change:function(e){return t.change(e,"startTime")}},model:{value:t.startTimeType,callback:function(e){t.startTimeType=e},expression:"startTimeType"}},[n("el-radio",{attrs:{label:0}},[t._v("现在开始")]),t._v(" "),n("el-radio",{attrs:{label:1}},[t._v("设定开始时间")])],1),t._v(" "),1===t.startTimeType?n("el-date-picker",{staticClass:"time_picker",attrs:{"picker-options":t.pickerOptions,type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:t.taskFrom.startTime,callback:function(e){t.$set(t.taskFrom,"startTime",e)},expression:"taskFrom.startTime"}}):t._e()],1),t._v(" "),n("el-form-item",{attrs:{label:"结束时间: "}},[n("el-radio-group",{on:{change:function(e){return t.change(e,"endTime")}},model:{value:t.endTimeType,callback:function(e){t.endTimeType=e},expression:"endTimeType"}},[n("el-radio",{attrs:{label:0}},[t._v("永不结束")]),t._v(" "),n("el-radio",{attrs:{label:1}},[t._v("设定结束时间")])],1),t._v(" "),1===t.endTimeType?n("el-date-picker",{staticClass:"time_picker",attrs:{"picker-options":t.pickerOptions2,type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:t.taskFrom.endTime,callback:function(e){t.$set(t.taskFrom,"endTime",e)},expression:"taskFrom.endTime"}}):t._e()],1)],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("确 定")])],1)],1)},Ot=[],Lt=n("b199");function Tt(){return{taskName:"",schedule:"",email:"",startTime:"",endTime:""}}var Et={name:"ControlDoal",data:function(){return{hasEmial:0,endTimeType:0,startTimeType:0,dialogVisible:!1,taskFrom:Tt(),rules:{taskName:[{required:!0,message:"请输入任务名称",trigger:"blur"}],schedule:[{required:!0,message:"请选择调度周期",trigger:"change"}]},cycleList:[{label:"分钟",value:"minutely"},{label:"小时",value:"hourly"},{label:"天",value:"daily"},{label:"周",value:"weekly"},{label:"月",value:"monthly"}],pickerOptions:{disabledDate:function(t){return t.getTime()+864e5<Date.now()}},pickerOptions2:{disabledDate:function(t){return t.getTime()+864e5<Date.now()}},ownerList:[],ownerLoading:!1}},watch:{"taskFrom.startTime":function(t){t&&(this.pickerOptions2={disabledDate:function(e){return e.getTime()<new Date(t).getTime()}})}},methods:{remoteMethod:function(t){var e=this;""!==t?(this.ownerLoading=!0,Object(Lt["Y"])(t).then((function(t){var n=t.data||[];e.ownerList=n})).finally((function(){e.ownerLoading=!1}))):this.ownerList=[]},change:function(t,e){t||(this.taskFrom[e]="")},callback:function(){this.dialogVisible=!1},submit:function(){var t=this;this.$refs.taskFrom.validate((function(e){e&&t.$emit("submit",t.taskFrom,t.callback)}))},close:function(){this.hasEmially=0,this.startTimeType=0,this.endTimeType=0,this.$refs.taskFrom.resetFields()},show:function(){this.dialogVisible=!0}}},At=Et,jt=(n("f4e1"),Object(N["a"])(At,St,Ot,!1,null,"281c5d65",null)),Ft=jt.exports,qt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"query-result"},[n("div",{staticClass:"result-tips"},[n("div",{staticClass:"tips_l"},[n("div",{staticClass:"result"},[n("i",{class:[t.icon+"-color",t.icon,"icon"]}),t._v(" "),n("span",{class:["text",{"active-text":!t.logType}],on:{click:t.hadelResult}},[t._v("结果")])]),t._v(" "),t.showLogBtn?n("div",{staticClass:"log"},[n("span",{class:["log-btn",{"active-text":t.logType}],on:{click:function(e){t.logType=!0}}},[t._v("查看日志")])]):t._e()]),t._v(" "),n("div",{staticClass:"tips_r"},[t.queryActive?n("el-input",{directives:[{name:"autoFous",rawName:"v-autoFous",value:"input",expression:"'input'"}],class:["keyword",t.queryActive?"active":""],attrs:{size:"mini","prefix-icon":"el-icon-search",placeholder:"请输入行信息"},on:{blur:function(e){t.queryActive=!1}},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}):n("i",{staticClass:"el-icon-search query_icon",on:{click:function(e){t.queryActive=!0}}}),t._v(" "),t.statusText?n("span",{staticClass:"statusText"},[n("el-tooltip",{attrs:{effect:"dark",content:"查询时长",placement:"top"}},[n("span",{staticClass:"time"},[t._v(t._s(void 0===t.data.executeDuration?"-":t.data.executeDuration+"s"))])]),t._v(" "),n("span",{staticClass:"line"},[t._v("|")]),t._v(" "),n("el-tooltip",{attrs:{effect:"dark",content:"扫描量",placement:"top"}},[n("span",{staticClass:"scanSize"},[t._v(t._s(t.data.scanSize||"-"))])])],1):t._e()],1)]),t._v(" "),n("div",{staticClass:"result-box"},[n("div",{directives:[{name:"show",rawName:"v-show",value:!t.logType,expression:"!logType"}]},[n("div",{directives:[{name:"show",rawName:"v-show",value:-1===t.data.status||2===t.data.status||3===t.data.status,expression:"data.status === -1 || data.status === 2 || data.status === 3"}],class:["empty-box"]},[t.progressObj.queryState?n("div",{staticClass:"progress"},[n("div",{staticClass:"title"},[t._v("查询进度")]),t._v(" "),n("div",{staticClass:"box"},[n("div",{staticClass:"message"},[t.progressViewTime?[t._v("\n                预计完成时间 "),n("span",[t._v(t._s(t.formatEstimatedSecond(t.progressObj.estimatedSecond)))]),t._v(", ")]:t._e(),t._v("查询计算进度 "),n("span",[t._v(t._s(t.progressFn(t.progressObj.progress))+"% ")]),t._v(", 已扫描数据量 "),n("span",[t._v(t._s(t.progressObj.physicalInputDataSize||"-"))])],2),t._v(" "),n("myProgress",{attrs:{"inner-bar-list":t.innerBarList}}),t._v(" "),t.progressObj.tipInfo?n("div",{staticClass:"tips"},[n("i",{staticClass:"el-icon-info"}),t._v("\n              "+t._s(t.progressObj.tipInfo)+"\n            ")]):t._e()],1)]):n("div",{staticClass:"message"},[n("div",[t._v("暂无结果数据")]),t._v(" "),n("div",[t._v("运行查询以查看结果")])])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:0===t.data.status,expression:"data.status === 0"}],staticClass:"success-box"},[t.data.message?[n("div",{staticClass:"el-icon-success-color"},[t._v(t._s(t.data.message))])]:[t.toolList[t.chartActive]&&"table"!==t.toolList[t.chartActive].type?t._l(t.toolList,(function(e,r){return n("div",{key:e.title,staticClass:"chart_list"},[r===t.chartActive?n("chart",t._b({key:e.config.chartOptions.chartId,attrs:{data:t.data}},"chart",t.chartOptionFn(e),!1)):t._e()],1)})):["success"===t.explorStatus&&t.explorationShow?[n("DataExploration",{attrs:{"show-data":t.showData,meta:t.data.meta,"repeat-meta":t.data.repeat_meta,"probe-data":t.probeData,"prob-total":t.probTotal}})]:[t.tableConfigType?n("div",{staticClass:"config_table"},[t.tableSearhList.length>0?n("div",{staticClass:"search"},t._l(t.tableSearhList,(function(e){return n("div",{key:e.name,staticClass:"search_item"},[n("span",{staticClass:"name",attrs:{title:e.name}},[t._v(t._s(e.name+": "))]),t._v(" "),n("el-input",{attrs:{placeholder:e.name,size:"mini",clearable:""},model:{value:e.value,callback:function(n){t.$set(e,"value",n)},expression:"val.value"}})],1)})),0):t._e(),t._v(" "),n("myTable",{key:t.uuid,attrs:{"table-data":t.tableData,"table-options":t.tableOptions},on:{sortChange:t.sortChange}})],1):n("el-table",{key:t.uuid,staticClass:"resultTable",attrs:{border:"",data:t.showData,stripe:"","header-cell-style":{padding:"0px 0"},"cell-style":{padding:"4px 0"}},on:{"sort-change":t.sortChange}},[n("el-table-column",{attrs:{type:"index",index:t.indexMethod,label:"序号",width:"70",align:"center"}}),t._v(" "),t._l(t.data.meta,(function(e){return n("el-table-column",{key:e,attrs:{"min-width":"180",sortable:"custom",prop:e,label:t.formatLabel(e)},scopedSlots:t._u([{key:"default",fn:function(r){return[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",disabled:t.isTipDisabled,content:r.row[e],placement:"bottom"}},[n("div",{staticClass:"ellipsis",on:{mouseenter:t.isShowTooltip}},[t._v(t._s(r.row[e]))])])]}}],null,!0)})}))],2)]],t._v(" "),t.toolList[t.chartActive]&&"table"!==t.toolList[t.chartActive].type?t._e():n("div",{staticClass:"result-footer"},[n("div",{staticClass:"result-footer-btn-box"},[n("el-button",{staticClass:"result-footer-btn",attrs:{type:"text",disabled:0===t.showData.length},on:{click:t.copyData}},[t._v("复制")]),t._v(" "),n("el-tooltip",{attrs:{content:"仅支持复制当前页的结果数据",placement:"top"}},[n("svg-icon",{staticClass:"svg_help",staticStyle:{"vertical-align":"middle","margin-top":"-3px"},attrs:{"icon-class":"help"}})],1),t._v(" "),n("el-dropdown",{directives:[{name:"permission",rawName:"v-permission",value:t.permission,expression:"permission"}]},[n("span",{staticClass:"result-footer-btn"},[t._v("\n                  下载\n                  "),t.downloading?n("i",{staticClass:"el-icon-loading"}):t._e()]),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{disabled:t.downloading},nativeOn:{click:function(e){return t.downloadData("")}}},[t._v("CSV")]),t._v(" "),n("el-dropdown-item",{attrs:{disabled:t.downloading},nativeOn:{click:function(e){return t.downloadData("pdf")}}},[t._v("PDF")])],1)],1),t._v(" "),n("el-tooltip",{attrs:{placement:"top"}},[n("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n                  结果数据仅展示前1000条数据，用户可通过下载操作，预览更多数据,当前查询共"),n("span",{staticClass:"amount"},[t._v(t._s(t.data.result&&t.data.result.length||0))]),t._v("条记录\n                ")]),t._v(" "),n("svg-icon",{staticClass:"svg_help",staticStyle:{"vertical-align":"middle","margin-top":"-3px"},attrs:{"icon-class":"help"}})],1),t._v(" "),t.data.fileSize?[t._v("("+t._s(t.data.fileSize||"-")+")")]:t._e(),t._v(" "),n("el-button",{staticClass:"result-footer-btn",attrs:{type:"text"},on:{click:t.createCurTable}},[t._v("\n                创建临时表\n                "),n("el-tooltip",{attrs:{placement:"top"}},[n("div",{attrs:{slot:"content"},slot:"content"},[t._v(t._s("创建的临时表默认存放到"+t.regionLabel+"区域下,temp_database此数据库中,存储时长默认为1个月!"))]),t._v(" "),n("svg-icon",{staticClass:"svg_help",staticStyle:{"vertical-align":"middle","margin-top":"-3px"},attrs:{"icon-class":"help"}})],1),t._v(" "),n("el-tooltip",{attrs:{placement:"top"}},[n("div",{attrs:{slot:"content"},slot:"content"},[t._v("定位")]),t._v(" "),n("svg-icon",{staticClass:"fixed",staticStyle:{"vertical-align":"middle","margin-top":"-3px"},attrs:{"icon-class":"fixed"},on:{click:function(e){return e.stopPropagation(),t.handelPosition(e)}}})],1)],1)],2),t._v(" "),t.paginationType||!t.tableConfigType?n("el-pagination",{attrs:{background:"",total:t.filterData.length,layout:t.paginationLayout,"current-page":t.pageNum,"page-size":t.pageSize,"pager-count":5,"page-sizes":[10,20,30,50]},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}):t._e()],1)]],2),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:1===t.data.status,expression:"data.status === 1"}],staticClass:"error"},[n("div",{staticClass:"error-box"},[n("div",{staticClass:"error-message"},[t.data.errorType?n("div",{staticClass:"error_type"},[n("p",{staticClass:"type"},[t._v(t._s(t.data.errorType+": "))])]):t._e(),t._v(" "),n("div",{staticClass:"error_content"},[t.data.errorZh?n("p",{staticClass:"zh_message"},[t._v(t._s(t.data.errorZh))]):t._e(),t._v(" "),n("p",{staticClass:"message"},[t._v(t._s(t.data.message))])])])])])]),t._v(" "),n("Log",{directives:[{name:"show",rawName:"v-show",value:t.logType,expression:"logType"}],ref:"Log",attrs:{uuid:t.uuid,data:t.data}})],1),t._v(" "),n("chartDrawer",{ref:"chartDrawer",attrs:{title:t.drawerTitle,"chart-type":t.chartType,data:t.data,engine:t.engine},on:{submit:t.submit}}),t._v(" "),n("el-dialog",{attrs:{title:"创建临时表",visible:t.cursorType,width:"30%","close-on-click-modal":!1},on:{"update:visible":function(e){t.cursorType=e},close:t.closeCursor}},[n("el-form",{ref:"cursorForm",attrs:{model:t.cursorForm}},[n("el-form-item",{attrs:{label:"临时表名称",prop:"tableName","label-width":"110px",rules:[{required:!0,message:"请输入临时表名称",trigger:["blur","change"]}]}},[n("el-input",{model:{value:t.cursorForm.tableName,callback:function(e){t.$set(t.cursorForm,"tableName",e)},expression:"cursorForm.tableName"}})],1)],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.cursorType=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary",loading:t.createTabloading,disabled:t.createTabloading},on:{click:t.addCursorFn}},[t._v("确 定")])],1)],1),t._v(" "),n("el-dialog",{attrs:{title:"创建成功",visible:t.tipsVisible,width:"35%"},on:{"update:visible":function(e){t.tipsVisible=e}}},[n("p",[t._v("\n      "+t._s(t.tipsMessage)+"\n      "),n("el-tooltip",{staticStyle:{"margin-left":"10px",cursor:"pointer"},attrs:{effect:"dark",content:"复制",placement:"top",enterable:!1}},[n("i",{staticClass:"el-icon-document-copy",on:{click:function(e){t.copy(t.tipsMessage.split(",")[1])}}})])],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.tipsVisible=!1}}},[t._v("确 定")])],1)])],1)},Nt=[],It=n("1f17"),$t=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"data-warp"},[n("div",{staticClass:"title"},[n("div",{staticClass:"lf"},[n("span",{staticClass:"lf-title"},[t._v("\n        数据探查\n        "),n("el-tooltip",{attrs:{placement:"top"}},[n("div",{attrs:{slot:"content"},slot:"content"},[t._v("\n            数据探查规则: "),n("br"),t._v("\n            1.字符串和时间类型的字段统计占比TOP2的数据以及其他值(otherValue)的占比"),n("br"),t._v('\n            2.数据类型的字段以直方图形式统计数据分布情况,鼠标移动到右上角的"详细"展示当前列的sum、averge、min、max聚合值'),n("br"),t._v("\n            3.枚举类型的字段以饼图形式 统计数据分布情况\n          ")]),t._v(" "),n("svg-icon",{staticClass:"toolbar-icon-question svg_help",attrs:{"icon-class":"help"}})],1)],1),t._v(" "),n("span",{staticClass:"lf-total"},[t._v("\n        Count\n        "),n("el-tooltip",{attrs:{content:"探查总条数",placement:"top"}},[n("svg-icon",{staticClass:"toolbar-icon-question svg_help",attrs:{"icon-class":"help"}})],1),t._v("\n        :"+t._s(t.probTotal)+"\n      ")],1)]),t._v(" "),n("div",{staticClass:"ri",on:{click:t.closePage}},[t._v("关闭")])]),t._v(" "),n("el-table",{staticClass:"resultTable",attrs:{data:t.showData,stripe:"",border:""}},[n("el-table-column",[n("el-table-column",{attrs:{type:"index",index:t.indexMethod,label:"序号",width:"50",align:"center"}})],1),t._v(" "),t._l(t.resProp,(function(e){return n("el-table-column",{key:e.prop,attrs:{"min-width":"180"},scopedSlots:t._u([{key:"header",fn:function(t){return[n("TableTitle",{attrs:{scope:Object.assign({},{scope:t},e.obj),"tab-nam":e.prop}})]}}],null,!0)},[t._v(" "),n("el-table-column",{attrs:{prop:e.prop,label:t.formatLabel(e.prop),"min-width":"180"},scopedSlots:t._u([{key:"default",fn:function(r){return[r.row[e.prop]&&r.row[e.prop].length>22?[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:r.row[e.prop],placement:"top"}},[n("div",{staticClass:"ellipsis",staticStyle:{"max-width":"350px"}},[t._v(t._s(r.row[e.prop]))])])]:[n("div",[t._v(t._s(r.row[e.prop]))])]]}}],null,!0)})],1)}))],2)],1)},Pt=[],Bt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"content"},["0"==t.resType?n("div",{staticClass:"warp-text warp"},t._l(t.resStatistics,(function(e,r){return n("div",{key:r,staticClass:"item"},[n("el-tooltip",{attrs:{effect:"dark",content:e.key,placement:"top"}},[n("span",{staticClass:"key ellipsis-line"},[t._v(t._s(e.key))])]),t._v(" "),n("span",{staticClass:"value"},[t._v(t._s(e.value))])],1)})),0):"2"===t.resType?n("div",{staticClass:"warp"},[n("div",{staticClass:"itemCharts",class:"myCharts"+t.tabNam+t.runDom})]):"1"===t.resType?n("div",{staticClass:"warp warp-line"},[n("div",{staticClass:"itemCharts",class:"myCharts"+t.tabNam+t.runDom}),t._v(" "),n("el-popover",{attrs:{placement:"bottom",width:"100",trigger:"hover",disabled:0===t.resStatistics.length}},[t._l(t.resStatistics,(function(e,r){return n("div",{key:r},[t._v(t._s(e.key+":"+e.value))])})),t._v(" "),n("el-button",{staticClass:"result-footer-btn message",attrs:{slot:"reference",type:"text"},slot:"reference"},[t._v("详细")])],2)],1):n("div",{staticClass:"warp warp-empty"},[n("p",[t._v("该数据类型暂不支持探查")])])])},zt=[],Mt=n("22b4"),Qt=n("1be7"),Gt=n("2da7"),Rt=n("ff32"),Ht=n("4b2a"),Ut=n("49bb"),Yt=n("4cb5"),Vt=n("ee29"),Kt=n("f95e");Mt["a"]([Gt["a"],Rt["a"],Ut["a"],Kt["a"],Vt["a"],Ht["a"],Yt["a"]]);var Wt={name:"TableTitle",props:{scope:{type:Object,default:function(){return{}}},tabNam:{type:String,default:""}},data:function(){var t=Number.parseInt(1e6*Math.random());return{option:{tooltip:{trigger:"item"},legend:{show:!1},series:[{type:"",radius:[],center:[],avoidLabelOverlap:!1,label:{show:!1,position:"center"},emphasis:{label:{}},labelLine:{show:!1},data:[]}]},runDom:t}},computed:{resStatistics:function(){var t=this.scope.statistics||{},e=[];function n(t){return function(e,n){var r=e[t],i=n[t];return i-r}}if("0"===this.resType?Object.keys(t).forEach((function(n){e.push({key:"otherField"===n?"otherValue":n,value:t[n]})})):"1"===this.resType&&Object.keys(t).forEach((function(n){"null"!==n&&"histogram"!==n&&e.push({key:n,value:t[n]})})),e.sort(n("value")),"0"!==this.resType||e.some((function(t){return"integer"===t.key}))){if("0"===this.resType){var r=e.findIndex((function(t){return"integer"===t.key}));e.splice(r,1)}}else e.forEach((function(t){t.value+="%"}));if(e.some((function(t){return"otherValue"===t.key}))){var i=e.findIndex((function(t){return"otherValue"===t.key})),a=e.find((function(t){return"otherValue"===t.key}))||{};e.splice(i,1),a.value&&e.push(a)}if(e.some((function(t){return"null"===t.key}))){var o=e.findIndex((function(t){return"null"===t.key})),s=e.find((function(t){return"null"===t.key}))||{};e.splice(o,1),s.value&&e.push(s)}return e},resType:function(){var t=this,e={0:["string","char","varchar","date"],1:["integer","double","float"],2:["boolean"]},n=3;return Object.keys(e).forEach((function(r){e[r].includes(t.scope.type)&&(n=r)})),n}},created:function(){},mounted:function(){"1"!==this.resType&&"2"!==this.resType||this.initChart()},methods:{initChart:function(){var t=document.querySelector(".myCharts".concat(this.tabNam).concat(this.runDom)),e=t&&Qt["b"](t);this.setOption(),this.option&&(null==e||e.setOption(this.option))},setOption:function(){if("2"===this.resType){this.option.series[0].type="pie",this.option.series[0].radius=["0%","90%"],this.option.series[0].center=["50%","50%"],this.option.tooltip.formatter=function(t){return t.data.name+":"+t.percent+"%"};var t=[],e=this.scope.statistics||{};Object.keys(e).forEach((function(n){t.push({value:e[n],name:n})})),this.option.series[0].data=t}else if("1"===this.resType){var n=this.scope.statistics||{},r=[],i=[];if(n.histogram&&n.histogram.forEach((function(t){var e=Object.keys(t)[0],n=t[e];r.push(e),i.push(n)})),r.length<=3&&r.length>1)for(var a=0;a<2;a++)r.splice(r.length-1,0,"_"),i.splice(i.length-1,0,0);n.null&&(r.push("null"),i.push(n.null)),this.option.tooltip={trigger:"axis",axisPointer:{type:"shadow"},textStyle:{fontSize:12},position:function(t,e,n,r,i){var a=t[0]||0,o=30+10*Math.random();return[a+20,o]},formatter:function(t){var e='<span style="display:inline-block;max-width:150px;white-space: nowrap;white-space: normal;">'+t[0].name+"</span><br />";return t.forEach((function(t){e+='<span style="display:inline-block;margin-right:5px;border-radius:50%;width:10px;height:10px;left:5px;background-color:'+t.color+'"></span>count : '+t.value+"<br />"})),e}},this.option.xAxis=[{type:"category",data:r,axisTick:{alignWithLabel:!0},axisLabel:{interval:1e5,margin:10,showMinLabel:!0,showMaxLabel:!0,formatter:function(t,e){if(0===e)return t&&(t.split("-")[0].split(".")[0]||"0");if("null"===t)return t;if(e===r.length-1){var n=t&&t.split("-")[1].split(".")[0];return n}}}}],this.option.grid={left:"6%",right:"13%",bottom:"-3%",top:"11%",containLabel:!0},this.option.yAxis=[{type:"value",axisLabel:{formatter:function(){return""}},splitLine:{show:!1}}],this.option.series=[{type:"bar",barWidth:r.length>1?"60%":"30%",data:i}]}}}},Xt=Wt,Jt=(n("2ccb"),Object(N["a"])(Xt,Bt,zt,!1,null,"bca484a0",null)),Zt=Jt.exports,te={name:"DataExploration",components:{TableTitle:Zt},props:{showData:{type:Array,default:function(){return[]}},meta:{type:Array,default:function(){return[]}},repeatMeta:{type:Object,default:function(){return{}}},probeData:{type:Array,default:function(){return[]}},probTotal:{type:Number||void 0,default:0}},data:function(){return{}},computed:{resProp:function(){var t=this,e=JSON.parse(JSON.stringify(this.meta));return e.map((function(e){var n=t.probeData.find((function(t){return t.volume===e}));return{prop:e,obj:n}}))}},methods:{closePage:function(){this.$parent.explorationShow=!1},formatLabel:function(t){return this.repeatMeta[t]?this.repeatMeta[t]:t},indexMethod:function(t){return(this.$parent.pageNum-1)*this.$parent.pageSize+t+1}}},ee=te,ne=(n("f5b7"),Object(N["a"])(ee,$t,Pt,!1,null,"f2912c90",null)),re=ne.exports,ie=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.drawer?n("el-drawer",{staticClass:"chartDrawer",attrs:{visible:t.drawer,direction:"rtl",close:t.handleClose,size:"85%"},on:{"update:visible":function(e){t.drawer=e}},scopedSlots:t._u([{key:"title",fn:function(){return[n("span",{staticClass:"title"},[t._v(t._s(t.title))])]},proxy:!0}],null,!1,3574102829)},[t._v(" "),n("chartConfig",{ref:"chartConfig",attrs:{data:t.data,loading:t.loading},on:{cancel:t.cancel,submit:t.submit}})],1):t._e()},ae=[],oe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrapper"},[n("div",{staticClass:"config"},[n("el-form",{ref:"form",staticClass:"ruleForm",attrs:{model:t.form,"label-width":"100px",rules:t.rules}},[n("el-form-item",{attrs:{label:"类型: ",prop:"type"}},[n("el-select",{attrs:{placeholder:"类型",size:"mini"},model:{value:t.form.type,callback:function(e){t.$set(t.form,"type",e)},expression:"form.type"}},t._l(t.typeOptions,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),n("el-form-item",{attrs:{label:"名称: ",prop:"title"}},[n("el-input",{staticClass:"w250",attrs:{placeholder:"名称",size:"mini",maxlength:"20"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title","string"===typeof e?e.trim():e)},expression:"form.title"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"描述: "}},[n("el-input",{attrs:{type:"textarea",maxlength:"200"},model:{value:t.form.describe,callback:function(e){t.$set(t.form,"describe",e)},expression:"form.describe"}})],1),t._v(" "),"table"!==t.form.type?n("div",{staticClass:"chart_config"},[n("div",{staticClass:"axis"},["polygon"!==t.form.type?n("div",{staticClass:"axisX"},[n("div",{staticClass:"config_title"},[t._v("X轴")]),t._v(" "),n("el-form-item",{attrs:{label:"选择字段: ",prop:"axisX.value"}},[n("el-select",{attrs:{placeholder:"选择字段",size:"mini"},model:{value:t.form.axisX.value,callback:function(e){t.$set(t.form.axisX,"value",e)},expression:"form.axisX.value"}},t._l(t.otherTypeOptions,(function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),t._v(" "),n("el-form-item",{attrs:{label:"展示名称: "}},[n("el-input",{staticClass:"w250",attrs:{placeholder:"展示名称",size:"mini"},model:{value:t.form.axisX.name,callback:function(e){t.$set(t.form.axisX,"name",e)},expression:"form.axisX.name"}})],1)],1):t._e(),t._v(" "),"polygon"!==t.form.type?n("div",{staticClass:"axisY"},[n("div",{staticClass:"config_title"},[t._v("\n              Y轴\n              "),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"仅支持选择数值类型的字段",placement:"right"}},[n("i",{staticClass:"el-icon-info info_icon"})])],1),t._v(" "),n("el-form-item",{attrs:{label:"选择字段: ",prop:"axisY.value"}},[n("el-select",{attrs:{placeholder:"选择字段",size:"mini"},model:{value:t.form.axisY.value,callback:function(e){t.$set(t.form.axisY,"value",e)},expression:"form.axisY.value"}},t._l(t.numberTypeOptions,(function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),t._v(" "),n("el-form-item",{attrs:{label:"展示名称: "}},[n("el-input",{staticClass:"w250",attrs:{placeholder:"展示名称",size:"mini"},model:{value:t.form.axisY.name,callback:function(e){t.$set(t.form.axisY,"name",e)},expression:"form.axisY.name"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"数据格式: "}},[n("el-select",{attrs:{placeholder:"数据格式",size:"mini"},model:{value:t.form.axisY.format,callback:function(e){t.$set(t.form.axisY,"format",e)},expression:"form.axisY.format"}},t._l(t.formatOptions,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)],1):t._e(),t._v(" "),"stack"===t.form.type?n("div",{staticClass:"group"},[n("div",{staticClass:"config_title"},[t._v("分组")]),t._v(" "),n("el-form-item",{attrs:{label:"选取字段: "}},[n("el-select",{attrs:{placeholder:"选取字段",size:"mini",clearable:""},model:{value:t.form.group,callback:function(e){t.$set(t.form,"group",e)},expression:"form.group"}},t._l(t.otherTypeOptions,(function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1)],1):t._e(),t._v(" "),"line"===t.form.type?n("div",{staticClass:"dimenison"},[n("div",{staticClass:"config_title"},[t._v("维度")]),t._v(" "),n("el-form-item",{attrs:{label:"选取字段: "}},[n("el-select",{attrs:{placeholder:"选取字段",size:"mini",clearable:""},model:{value:t.form.dimension,callback:function(e){t.$set(t.form,"dimension",e)},expression:"form.dimension"}},t._l(t.otherTypeOptions,(function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),t._v(" "),n("el-form-item",{attrs:{label:"图例: "}},[n("el-switch",{model:{value:t.form.legend,callback:function(e){t.$set(t.form,"legend",e)},expression:"form.legend"}})],1)],1):t._e()]),t._v(" "),"polygon"===t.form.type?n("div",{staticClass:"base_config"},[n("div",{staticClass:"config_title"},[t._v("基础设置")]),t._v(" "),n("el-form-item",{attrs:{label:"维度: ",prop:"dimension"}},[n("el-select",{attrs:{placeholder:"维度",size:"mini",clearable:""},model:{value:t.form.dimension,callback:function(e){t.$set(t.form,"dimension",e)},expression:"form.dimension"}},t._l(t.otherTypeOptions,(function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),t._v(" "),n("el-form-item",{attrs:{label:"指标: ",prop:"norm"}},[n("el-select",{attrs:{placeholder:"指标",size:"mini"},model:{value:t.form.norm,callback:function(e){t.$set(t.form,"norm",e)},expression:"form.norm"}},t._l(t.numberTypeOptions,(function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),t._v(" "),n("el-form-item",{attrs:{label:"最多展示区数: "}},[n("el-select",{attrs:{placeholder:"最多展示区数",size:"mini"},model:{value:t.form.viewNum,callback:function(e){t.$set(t.form,"viewNum",e)},expression:"form.viewNum"}},t._l(t.normLength,(function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1),t._v(" "),n("el-form-item",{attrs:{label:"数据格式: "}},[n("el-select",{attrs:{placeholder:"数据格式",size:"mini"},model:{value:t.form.format,callback:function(e){t.$set(t.form,"format",e)},expression:"form.format"}},t._l(t.formatOptions,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),n("el-form-item",{attrs:{label:"图例: "}},[n("el-switch",{model:{value:t.form.legend,callback:function(e){t.$set(t.form,"legend",e)},expression:"form.legend"}})],1)],1):t._e()]):n("div",{staticClass:"table_config"},[n("div",{staticClass:"base"},[n("div",{staticClass:"config_title"},[t._v("基本格式")]),t._v(" "),n("el-form-item",{attrs:{label:"样式: "}},[n("div",{staticClass:"base_style"},[n("div",{staticClass:"switch"},[n("el-switch",{model:{value:t.form.params.format.indexType,callback:function(e){t.$set(t.form.params.format,"indexType",e)},expression:"form.params.format.indexType"}}),t._v(" "),n("span",[t._v("序号")])],1),t._v(" "),n("el-checkbox",{model:{value:t.form.params.format.transposition,callback:function(e){t.$set(t.form.params.format,"transposition",e)},expression:"form.params.format.transposition"}},[t._v("行列转置")]),t._v(" "),n("el-checkbox",{model:{value:t.form.params.format.wrap,callback:function(e){t.$set(t.form.params.format,"wrap",e)},expression:"form.params.format.wrap"}},[t._v("自动换行")])],1)]),t._v(" "),n("el-form-item",{attrs:{label:"分页: "}},[n("div",{staticClass:"pagination"},[n("el-switch",{model:{value:t.form.params.pagination.paginationType,callback:function(e){t.$set(t.form.params.pagination,"paginationType",e)},expression:"form.params.pagination.paginationType"}}),t._v(" "),t.form.params.pagination.paginationType?n("div",{staticClass:"paginationConfig"},[n("div",{staticClass:"item"},[n("span",{staticClass:"title"},[t._v("每页显示: ")]),t._v(" "),n("el-select",{staticClass:"w100",attrs:{size:"mini"},model:{value:t.form.params.pagination.pageSize,callback:function(e){t.$set(t.form.params.pagination,"pageSize",e)},expression:"form.params.pagination.pageSize"}},t._l(t.pageSizeOptions,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)]):t._e()],1)]),t._v(" "),n("el-form-item",{attrs:{label:"对齐方式: "}},[n("el-select",{staticClass:"w100",attrs:{size:"mini"},model:{value:t.form.params.align,callback:function(e){t.$set(t.form.params,"align",e)},expression:"form.params.align"}},t._l(t.alignOptions,(function(t){return n("el-option",{key:t.label,attrs:{label:t.label,value:t.value}})})),1)],1)],1),t._v(" "),n("div",{staticClass:"field"},[n("div",{staticClass:"config_title"},[t._v("字段设置")]),t._v(" "),n("div",{staticClass:"tag"},[n("div",{staticClass:"show_tag"},[n("p",{staticClass:"title"},[t._v("显示字段列表")]),t._v(" "),t._l(t.filterList,(function(e){return n("el-tag",{key:e.valueKey,class:[t.showTypeActive===e.valueKey?"active":""],attrs:{closable:"",type:"success"},on:{close:function(n){return t.handleClose(e.valueKey,!1)},click:function(n){t.showTypeActive=e.valueKey}}},[t._v("\n                "+t._s(e.valueKey)+"\n              ")])}))],2),t._v(" "),t.filterListDel.length>0?n("div",{staticClass:"no_show_tag"},[n("p",{staticClass:"title"},[t._v("不显示字段列表")]),t._v(" "),t._l(t.filterListDel,(function(e){return n("el-tag",{key:e.valueKey,attrs:{closable:"",type:"info"},on:{close:function(n){return t.handleClose(e.valueKey,!0)}}},[t._v("\n                "+t._s(e.valueKey)+"\n              ")])}))],2):t._e()]),t._v(" "),t.filterList.length>0?n("div",{staticClass:"field_box"},t._l(t.columnOptions,(function(e){return n("div",{key:e.valueKey,staticClass:"field_content"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.showTypeActive===e.valueKey,expression:"showTypeActive === item.valueKey"}],staticClass:"field_item"},[n("el-form-item",{attrs:{label:"展示名称: "}},[n("el-input",{staticClass:"w250",attrs:{size:"mini"},model:{value:e.name,callback:function(n){t.$set(e,"name",n)},expression:"item.name"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"搜索条件: "}},[n("el-radio-group",{model:{value:e.isFilterType,callback:function(n){t.$set(e,"isFilterType",n)},expression:"item.isFilterType"}},[n("el-radio",{attrs:{label:!0}},[t._v("是")]),t._v(" "),n("el-radio",{attrs:{label:!1}},[t._v("否")])],1)],1),t._v(" "),n("el-form-item",{attrs:{label:"展示类型: "}},[n("el-select",{staticClass:"w100",attrs:{size:"mini"},model:{value:e.showType,callback:function(n){t.$set(e,"showType",n)},expression:"item.showType"}},t._l(t.viewTypeOption,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),n("el-form-item",{attrs:{label:"条件格式: "}},[n("div",{staticClass:"tremFormat"},[n("el-select",{staticClass:"symbol w100",attrs:{size:"mini"},model:{value:e.tremFormat.symbol,callback:function(n){t.$set(e.tremFormat,"symbol",n)},expression:"item.tremFormat.symbol"}},[n("el-option",{attrs:{label:"小于",value:"lt"}}),t._v(" "),n("el-option",{attrs:{label:"等于",value:"equal"}}),t._v(" "),n("el-option",{attrs:{label:"大于",value:"gt"}})],1),t._v(" "),n("el-input",{staticClass:"value",attrs:{placeholder:"请输入值",size:"mini"},model:{value:e.tremFormat.value,callback:function(n){t.$set(e.tremFormat,"value",n)},expression:"item.tremFormat.value"}}),t._v(" "),n("div",{staticClass:"color"},[n("span",{staticClass:"title"},[t._v("显示")]),t._v(" "),n("el-color-picker",{model:{value:e.tremFormat.viewColor,callback:function(n){t.$set(e.tremFormat,"viewColor",n)},expression:"item.tremFormat.viewColor"}})],1)],1)])],1)])})),0):t._e()])])],1)],1),t._v(" "),n("div",{staticClass:"view"},[t._m(0),t._v(" "),"table"!==t.form.type?n("el-card",{staticClass:"chart_box"},[n("chart",{attrs:{data:t.data,"chart-config":t.chartForm,"chart-config-options":t.chartOptions},on:{normNumChange:t.normNumChange}})],1):n("el-card",{staticClass:"view_content"},[n("div",{staticClass:"search",attrs:{gutter:10}},t._l(t.tableSearhList,(function(e){return n("div",{key:e.valueKey,staticClass:"search_item",attrs:{span:4}},[n("span",{staticClass:"name ellipsis",attrs:{title:e.name}},[t._v(t._s(e.name+": "))]),t._v(" "),n("el-input",{attrs:{placeholder:e.name,size:"mini",clearable:""},model:{value:e.value,callback:function(n){t.$set(e,"value",n)},expression:"val.value"}})],1)})),0),t._v(" "),n("myTable",{attrs:{"table-data":t.tableData,"table-options":t.tableOptions}}),t._v(" "),t.form.params.pagination.paginationType?n("el-pagination",{attrs:{background:"","page-sizes":[10,20,50,100],"page-size":t.form.params.pagination.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.filterData.length},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}):t._e()],1),t._v(" "),n("div",{staticClass:"footer"},[n("el-button",{attrs:{size:"small"},on:{click:function(e){return t.$emit("cancel")}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.submit}},[t.loading?n("i",{staticClass:"el-icon-loading"}):t._e(),t._v("\n        保 存\n      ")])],1)],1)])},se=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"view_title"},[n("span",{staticClass:"title"},[t._v("结果展示区")])])}],le=n("e46f"),ue=n("5dae");function ce(t){return ce="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ce(t)}function fe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function he(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?fe(Object(n),!0).forEach((function(e){pe(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function pe(t,e,n){return e=de(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function de(t){var e=me(t,"string");return"symbol"===ce(e)?e:String(e)}function me(t,e){if("object"!==ce(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==ce(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var ge={components:{chart:le["a"],myTable:ue["a"]},props:{data:{type:Object,default:function(){return{}}},loading:{type:Boolean,default:!1}},data:function(){return{transTableData:[],transTableHeader:[],columnOptions:[{name:"",valueKey:"",isFilterType:!1,showType:"text",tremFormat:{symbol:"",value:"",viewColor:""}}],showTypeActive:"",tableSearhList:[{name:"",valueKey:"",value:""}],filterListDel:[],filterList:[],viewTypeOption:[{label:"文本",value:"text"},{label:"超链接",value:"link"},{label:"图片",value:"img"}],alignOptions:[{label:"靠左",value:"left"},{label:"居中",value:"center"},{label:"靠右",value:"right"}],maxOptions:[{label:"100条",value:100},{label:"200条",value:200},{label:"500条",value:500},{label:"1000条",value:1e3}],pageSizeOptions:[{label:"10条/页",value:10},{label:"20条/页",value:20},{label:"50条/页",value:50},{label:"100条/页",value:100}],chartOptions:{chartHeight:570,chartId:"chartId"+Math.random(),padding:[20,40,70,100]},typeOptions:[{label:"表格",value:"table"},{label:"柱状图",value:"interval"},{label:"堆叠图",value:"stack"},{label:"折线图",value:"line"},{label:"矩形树图",value:"polygon"}],formatOptions:[{label:"数字",value:"number"},{label:"百分比",value:"hundred"},{label:"千分比",value:"thousand"}],rules:{title:[{required:!0,message:"请输入名称",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"change"}],norm:[{required:!0,message:"请选择指标",trigger:"change"}],dimension:[{required:!0,message:"请选择维度",trigger:"change"}],"axisY.value":[{required:!0,message:"请选择字段",trigger:"change"}],"axisX.value":[{required:!0,message:"请选择字段",trigger:"change"}]},form:{type:"table",title:"",describe:"",axisX:{value:"",name:""},axisY:{value:"",name:"",format:"number"},group:"",legend:!1,dimension:"",norm:"",viewNum:"",format:"number",params:{format:{indexType:!0,transposition:!1,wrap:!1,auto:!1},pagination:{paginationType:!0,pageSize:20,pageNum:1,max:1e3},align:"left"}},normLength:0}},computed:{chartForm:function(){return JSON.parse(JSON.stringify(this.form))},numberTypeOptions:function(){var t=this;return this.data.type?this.data.meta.filter((function(e){var n=t.data.type.find((function(t){return t[e]}));if(!n||0===Object.keys(n).length)return!1;var r=n[Object.keys(n)[0]];return It["d"].includes(r)})):[]},otherTypeOptions:function(){var t=this;return this.data.meta.filter((function(e){return!t.numberTypeOptions.includes(e)}))},tableOptions:function(){return"table"!==this.form.type?{}:Object.assign({},{align:this.form.params.align,format:this.form.params.format,pagination:this.form.params.pagination,filterList:this.filterList})},filterData:function(){var t=this;if("table"!==this.form.type)return[];var e=this.data.result||[];if(this.data.type&&e.forEach((function(e){Object.keys(e).forEach((function(n){var r=t.data.type.find((function(t){return t[n]}));r&&"integer"===Object.values(r)[0]&&(e[n]=Number(e[n]))}))})),this.tableSearhList.length>0&&this.tableSearhList.some((function(t){return t.value.trim()}))){var n=this.tableSearhList.filter((function(t){return t.value.trim()})),r=n.map((function(t){return t.valueKey})),i=n.map((function(t){return t.value}));e=e.filter((function(e){var n=[];return r.forEach((function(r,a){var o=t.data.type.find((function(t){return Object.keys(t)[0]===r}));o&&It["d"].includes(o[Object.keys(o)[0]])?(e[r]||0===e[r])&&n.push(e[r]===1*i[a]):e[r]&&n.push(e[r].includes(i[a]))})),!(!n||0===n.length)&&!n.some((function(t){return!t}))}))}return e},tableData:function(){var t,e=this.filterData;if(null!=(t=this.form.params)&&t.pagination.paginationType){var n=(this.form.params.pagination.pageNum-1)*this.form.params.pagination.pageSize,r=this.form.params.pagination.pageNum*this.form.params.pagination.pageSize;return e.slice(n,r)}return e}},watch:{"form.type":function(t){"interval"===t?(this.form.dimension="",this.form.norm="",this.form.viewNum="",this.form.group="",this.form.legend=!1):"line"===t?(this.form.norm="",this.form.viewNum=""):"stack"===t?(this.form.dimension="",this.form.norm="",this.form.viewNum="",this.form.legend=!0):"polygon"===t&&(this.form.axisX={value:"",name:""},this.form.axisY={value:"",name:"",format:""})},tableData:{handler:function(t){if("table"===this.form.type){var e=t[0]?Object.keys(t[0]):[],n={};e.forEach((function(e){n[e]=t.map((function(t){return t[e]}))}));var r=[];Object.keys(n).forEach((function(t){var e={};e.name=t,n[t].forEach((function(t,n){e["key"+n]=t})),r.push(e)})),this.transTableData=r,this.transTableHeader=r[0]?Object.keys(r[0]).map((function(t){return{name:t,valueKey:t}})):[]}},immediate:!0},"data.meta":{handler:function(t){"table"===this.form.type&&(this.columnOptions=t.map((function(t){return{name:t,valueKey:t,isFilterType:!1,isShow:!0,showType:"text",tremFormat:{symbol:"",value:"",viewColor:""}}})),this.showTypeActive=this.columnOptions.find((function(t){return t.isShow})).valueKey)},immediate:!0},columnOptions:{handler:function(t){if("table"===this.form.type){this.filterList=[].concat(t.filter((function(t){return t.isShow}))),this.filterListDel=[].concat(t.filter((function(t){return!t.isShow})));var e=t.filter((function(t){return t.isFilterType}));this.tableSearhList=e.map((function(t){return{valueKey:t.valueKey,name:t.name,value:""}}))}},deep:!0,immediate:!0},tableSearhList:{handler:function(){this.tableSearhList.length>0&&this.tableSearhList.some((function(t){return t.value.trim()}))&&(this.form.params.pagination.pageNum=1)},deep:!0}},methods:{normNumChange:function(t){this.normLength=t},setData:function(t){"table"!==t.form.type?(this.form=t.form,this.chartOptions=t.chartOptions):(this.form=t.form,this.chartOptions=t.chartOptions,this.filterList=t.filterList,this.tableSearhList=t.tableSearhList,this.filterListDel=t.filterListDel,this.columnOptions=t.columnOptions)},submit:function(){var t=this;this.loading||this.$refs.form.validate((function(e){var n;e&&(n="table"!==t.form.type?Object.assign({},{form:t.form,chartOptions:t.chartOptions}):Object.assign({},{form:he(he({},t.form),{},{type:"table"}),columnOptions:t.columnOptions,filterList:t.filterList,tableSearhList:t.tableSearhList,filterListDel:t.filterListDel}),t.$emit("submit",n))}))},cellStyle:function(t,e){if(!t||!e)return{};var n=t.symbol,r=t.value,i=t.viewColor,a=r;if("number"===typeof e&&(a=Number(r)),!n||!a||!i)return{};if("lt"===n){if(e<a)return{color:i}}else if("equal"===n){if(a===e)return{color:i}}else if("gt"===n&&e>a)return{color:i};return{}},indexMethod:function(t){return(this.form.params.pagination.pageNum-1)*this.form.params.pagination.pageSize+t+1},handleSizeChange:function(t){this.form.params.pagination.pageSize=t},handleCurrentChange:function(t){this.form.params.pagination.pageNum=t},handleClose:function(t,e){var n=this;this.columnOptions.forEach((function(r,i,a){if(r.valueKey===t&&(r.isShow=e,!e)){var o=i-1;if(o<0)return;n.showTypeActive=a[o].valueKey}}))}}},ve=ge,be=(n("01b6"),Object(N["a"])(ve,oe,se,!1,null,"d07237ba",null)),ye=be.exports;function we(t){return we="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},we(t)}function _e(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ke(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_e(Object(n),!0).forEach((function(e){De(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function De(t,e,n){return e=xe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xe(t){var e=Ce(t,"string");return"symbol"===we(e)?e:String(e)}function Ce(t,e){if("object"!==we(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==we(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Se={components:{chartConfig:ye},props:{title:{type:String,require:!0,default:""},engine:{type:String,default:""},chartType:{type:String,require:!0,default:""},data:{type:Object,default:function(){return{}}}},data:function(){return{drawer:!1,loading:!1}},computed:ke({},Object(f["c"])(["region"])),methods:{setData:function(t){var e=JSON.parse(JSON.stringify(t));"table"!==e.form.type&&Object.assign(e,{chartOptions:ke(ke({},e.chartOptions),{},{chartId:e.chartOptions.chartId+Math.random()})}),this.$refs.chartConfig.setData(e)},open:function(){this.drawer=!0},cancel:function(){this.drawer=!1},submit:function(t){var e=this;this.loading=!0;var n="SELECT * ,'{{ ds_nodash }}' as bidt FROM (".concat(this.data.editSql,") b");n=window.btoa(encodeURIComponent(n)),"table"!==t.form.type&&(t.chartOptions.chartId="chartId"+Math.random());var r,i={columnList:JSON.stringify(this.data.type),type:t.form.type,param:JSON.stringify(t),title:t.form.title,describe:t.form.describe,content:n,querySql:"SELECT * ,'{{ ds_nodash }}' as bidt FROM (".concat(this.data.editSql,") b"),uuid:this.data.uuid,region:this.region,engine:this.engine},a=u["b"];t.form.id&&(r=t.form.querySql?t.form.querySql:"SELECT * ,{{ ds_nodash }} as bidt FROM (".concat(this.data.editSql,") b"),i.id=t.form.id+"",i.querySql=r,i.content=t.form.content,a=u["Bb"]);a(i).then((function(n){"SUCCESS"===n.codeStr&&(e.$message({type:"success",message:"已保存至图表管理，您可以去图表管理中查看"}),n.data&&n.data.id&&(t.form.id=n.data.id),e.drawer=!1,e.$emit("submit",t))})).finally((function(t){Object(u["n"])(),e.loading=!1}))},handleClose:function(){}}},Oe=Se,Le=(n("7f55"),Object(N["a"])(Oe,ie,ae,!1,null,"2fc86f2f",null)),Te=Le.exports,Ee=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrapper"},[n("div",{staticClass:"content"},[n("div",{staticClass:"outbar"},t._l(t.styleOption,(function(e){return n("div",{key:e.text,staticClass:"innerbar",style:t.styleFn(e)},[n("div",{staticClass:"bar"}),t._v(" "),n("div",{staticClass:"bartext"},[t._v(t._s(e.text))])])})),0)])])},Ae=[],je={props:{innerBarList:{type:Array,default:function(){return[]}},styleOption:{type:Array,default:function(){return[{color:"linear-gradient(45deg, #cdf4ff, #5d92dd)",width:20,text:"正在提交"},{color:"linear-gradient(45deg, #f0f1de, #ffce74)",width:60,text:"查询计算"},{color:"linear-gradient(45deg, #eddef1, #715fd4)",width:20,text:"结果获取"}]}}},data:function(){return{}},watch:{innerBarList:{handler:function(t){var e=this;t.forEach((function(t,n){e.$set(e.styleOption[n],"bgcWidth",t.width)}))},immediate:!0,deep:!0}},methods:{styleFn:function(t){var e={};return e["width"]=t.width+"%",t.bgcWidth&&(e["background-image"]=t.color,e["background-size"]=t.bgcWidth+"%",e["background-repeat"]="no-repeat"),e}}},Fe=je,qe=(n("23a1"),Object(N["a"])(Fe,Ee,Ae,!1,null,"a8406ed8",null)),Ne=qe.exports,Ie=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"log-box"},[n("div",{staticClass:"tool"},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.fold?"展开":"折叠",placement:"top"}},[t.fold?n("i",{staticClass:"el-icon-arrow-down icon",on:{click:function(){return t.fold=!1}}}):t._e(),t._v(" "),t.fold?t._e():n("i",{staticClass:"el-icon-arrow-up icon",on:{click:function(){return t.fold=!0}}})])],1),t._v(" "),n("div",{class:["log-content",{"content-fold":!t.fold}]},[t._l(t.logData,(function(e,r){return n("div",{key:r,staticClass:"xhr-log"},[t._v("\n      "+t._s(e)+"\n    ")])})),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:t.endType,expression:"endType"}],staticClass:"end-log"},[t._v("-")])],2)])},$e=[];function Pe(t){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pe(t)}function Be(t){return Ge(t)||Qe(t)||Me(t)||ze()}function ze(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Me(t,e){if(t){if("string"===typeof t)return Re(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Re(t,e):void 0}}function Qe(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function Ge(t){if(Array.isArray(t))return Re(t)}function Re(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function He(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ue(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?He(Object(n),!0).forEach((function(e){Ye(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):He(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ye(t,e,n){return e=Ve(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ve(t){var e=Ke(t,"string");return"symbol"===Pe(e)?e:String(e)}function Ke(t,e){if("object"!==Pe(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Pe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var We={name:"Log",props:{data:{type:Object,default:function(){return{}}},uuid:{type:[Number,String],default:""}},data:function(){return{from:0,logData:[],maxLength:1e4,status:null,timer:null,timer1:null,endType:!0,fold:!0}},computed:Ue({},Object(f["c"])(["region","sqlOptions","userInfo"])),created:function(){var t=this.sqlOptions&&this.sqlOptions[this.region];if(t){var e,n=null==(e=t[this.data.name])?void 0:e.logData;n&&(this.logData=n.data||[],this.from=n.from,this.status=n.status,1!==this.status?(this.initGetLog(),this.handelEndType(),this.$parent&&(this.$parent.logType=!0)):this.endType=!1)}},destroyed:function(){clearInterval(this.timer),clearInterval(this.timer1)},methods:{handelExecute:function(){this.logData=[],this.from=0,this.status=null,this.initGetLog(),this.handelEndType()},handelEndType:function(){var t=this;clearInterval(this.timer1),this.timer1=setInterval((function(){t.endType=!t.endType}),600)},addLog:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(this.logData.length>=this.maxLength)for(var n=0;n<e.length;n++)this.logData.shift();(t=this.logData).push.apply(t,Be(e));var r={data:this.logData,from:this.from,status:this.status};this.$store.commit("SET_SQLOPTIONS",{region:this.region,name:this.data.name,key:"logData",value:r})},initGetLog:function(){clearInterval(this.timer),this.getLog(),this.timer=setInterval(this.getLog,5e3)},getLog:function(){var t=this;if(this.uuid){if(1===this.status)return clearInterval(this.timer),clearInterval(this.timer1),this.endType=!1,void(this.from=0);var e={uuid:this.uuid,from:this.from};Object(u["cb"])(e).then((function(e){var n=e.data||{};t.from=n.pointer||0,t.status=n.status||0,t.addLog(n.rows)}))}}}},Xe=We,Je=(n("7732"),Object(N["a"])(Xe,Ie,$e,!1,null,"585b7681",null)),Ze=Je.exports;function tn(t){return tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tn(t)}function en(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */en=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var a=e&&e.prototype instanceof v?e:v,o=Object.create(a.prototype),s=new E(r||[]);return i(o,"_invoke",{value:S(t,n,s)}),o}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h="suspendedStart",p="suspendedYield",d="executing",m="completed",g={};function v(){}function b(){}function y(){}var w={};u(w,o,(function(){return this}));var _=Object.getPrototypeOf,k=_&&_(_(A([])));k&&k!==n&&r.call(k,o)&&(w=k);var D=y.prototype=v.prototype=Object.create(w);function x(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function n(i,a,o,s){var l=f(t[i],t,a);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==tn(c)&&r.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,o,s)}),(function(t){n("throw",t,o,s)})):e.resolve(c).then((function(t){u.value=t,o(u)}),(function(t){return n("throw",t,o,s)}))}s(l.arg)}var a;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return a=a?a.then(i,i):i()}})}function S(e,n,r){var i=h;return function(a,o){if(i===d)throw new Error("Generator is already running");if(i===m){if("throw"===a)throw o;return{value:t,done:!0}}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var l=O(s,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===h)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=d;var u=f(e,n,r);if("normal"===u.type){if(i=r.done?m:p,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=m,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var a=f(i,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,g;var o=a.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(tn(e)+" is not iterable")}return b.prototype=y,i(D,"constructor",{value:y,configurable:!0}),i(y,"constructor",{value:b,configurable:!0}),b.displayName=u(y,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u(t,l,"GeneratorFunction")),t.prototype=Object.create(D),t},e.awrap=function(t){return{__await:t}},x(C.prototype),u(C.prototype,s,(function(){return this})),e.AsyncIterator=C,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new C(c(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},x(D),u(D,l,"Generator"),u(D,o,(function(){return this})),u(D,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=A,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var l=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:A(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}function nn(t,e,n,r,i,a,o){try{var s=t[a](o),l=s.value}catch(u){return void n(u)}s.done?e(l):Promise.resolve(l).then(r,i)}function rn(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){nn(a,r,i,o,s,"next",t)}function s(t){nn(a,r,i,o,s,"throw",t)}o(void 0)}))}}function an(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function on(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?an(Object(n),!0).forEach((function(e){sn(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):an(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function sn(t,e,n){return e=ln(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ln(t){var e=un(t,"string");return"symbol"===tn(e)?e:String(e)}function un(t,e){if("object"!==tn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==tn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var cn={components:{DataExploration:re,chartDrawer:Te,myTable:ue["a"],chart:le["a"],myProgress:Ne,Log:Ze},props:{uuid:{type:[Number,String],default:""},data:{type:Object,default:function(){return{result:[],meta:[],status:-1,executeDuration:0,fileSize:"",scanSize:"",codeStr:"",message:"",repeat_meta:{}}}},running:{type:Boolean,default:!1},engine:{type:String,default:""},resultOption:{type:Object,default:function(){return{}}},progressObj:{type:Object,default:function(){return{}}}},inject:["visible","positionTable"],data:function(){return{probTotal:0,keyword:"",pageSize:20,pageNum:1,downloading:!1,explorationShow:!1,explorLoading:!1,explorStatus:"",probeData:[],filterColumn:{},filterType:"",queryActive:!1,chartActive:-1,drawerTitle:"图表配置",chartType:"table",toolList:[],innerBarList:[],cursorType:!1,cursorForm:{tableName:""},createTabloading:!1,progressViewTime:!0,viewTime:!0,tipsVisible:!1,positionTableName:"",tipsMessage:"",isTipDisabled:!1,logType:!1,showLogBtn:!1}},computed:on(on({},Object(f["c"])(["region","regionList","catalog","userInfo","sqlOptions"])),{},{addChartType:function(){var t=this;return!!this.engine&&["spark","presto"].some((function(e){return t.engine.includes(e)}))},paginationLayout:function(){return this.visible()?"total, sizes, prev, pager, next":"total, sizes, prev, pager, next, jumper"},icon:function(){var t="";return this.running?t="":0===this.data.status?t="el-icon-success":1===this.data.status?t="el-icon-error":2===this.data.status?t="el-icon-warning-outline":3===this.data.status&&(t=""),t},statusText:function(){var t="";return this.running?t="正在运行":0===this.data.status?t="已完成":1===this.data.status?t="失败":2===this.data.status?t="已取消":3===this.data.status&&(t="正在运行"),t},tableSearhList:function(){return this.tableConfigType&&this.toolList[this.chartActive].config.tableSearhList||[]},tableConfigType:function(){return this.toolList[this.chartActive]&&"table"===this.toolList[this.chartActive].type&&this.toolList[this.chartActive].config},tableOptions:function(){var t=this.toolList[this.chartActive];return t&&"table"===t.type&&t.config?Object.assign({},{align:t.config.form.params.align,format:t.config.form.params.format,pagination:t.config.form.params.pagination,filterList:t.config.filterList}):{}},paginationType:function(){var t,e=null==(t=this.toolList[this.chartActive])?void 0:t.config;return!(!e||"table"!==e.form.type||!e.form.params.pagination.paginationType)},tableData:function(){var t,e=[],n=null==(t=this.toolList[this.chartActive])?void 0:t.config;return e=n&&"table"===n.form.type&&n.form.params.pagination.paginationType?this.showData:this.filterData,e},filterData:function(){var t=this,e=this.data.result||[];if(this.keyword&&(e=this.data.result.filter((function(e){var n=t.data.meta,r=n.findIndex((function(n){var r=e[n];return"string"!==typeof r&&(r=String(r)),r.includes(t.keyword)}));return r>-1}))),this.tableSearhList.length>0&&this.tableSearhList.some((function(t){return t.value.trim()}))){var n=this.tableSearhList.filter((function(t){return t.value.trim()})),r=n.map((function(t){return t.valueKey})),i=n.map((function(t){return t.value}));e=e.filter((function(e){var n=[];return r.forEach((function(r,a){var o=t.data.type.find((function(t){return Object.keys(t)[0]===r}));o&&It["d"].includes(o[Object.keys(o)[0]])?(e[r]||0===e[r])&&n.push(e[r]===1*i[a]):e[r]&&n.push(e[r].includes(i[a]))})),!(!n||0===n.length)&&!n.some((function(t){return!t}))}))}if(this.filterType){var a=JSON.parse(JSON.stringify(e));return a.sort(this.sortFun(this.filterColumn.prop,"ascending"===this.filterColumn.order))}return e},showData:function(){var t=this.pageSize*(this.pageNum-1),e=t+this.pageSize;return this.filterData.slice(t,e)},regionLabel:function(){var t=this;return this.regionList.find((function(e){return e.name===t.region})).name_zh||"当前区域"},permission:function(){var t={condition:"external",instead:!0};return t.condition_met=this.userInfo?this.userInfo.tenantName:"",t}}),watch:{progressViewTime:function(t){var e=this;t||setTimeout((function(){e.viewTime=!1,e.progressViewTime=!0}),3e4)},progressObj:{handler:function(t,e){if(t.queryState){this.progressViewTime&&0===t.estimatedSecond&&this.viewTime&&(this.progressViewTime=!1);var n=this.innerBarList;if("QUEUED"===t.queryState||"PLANNING"===t.queryState||"WAITING_FOR_RESOURCES"===t.queryState)n=[{color:"linear-gradient(45deg, #cdf4ff, #5d92dd)",width:100,text:"正在提交"}];else if("RUNNING"===t.queryState)if(n.some((function(t){return"正在提交"===t.text}))||n.push({color:"linear-gradient(45deg, #cdf4ff, #5d92dd)",width:100,text:"正在提交"}),n.some((function(t){return"查询计算"===t.text}))){var r=this.progressFn(t.progressType["RUNNING"]);this.$set(n[n.length-1],"width",r>0?r:1)}else{n.push({color:"linear-gradient(45deg, #f0f1de, #ffce74);",text:"查询计算"});var i=this.progressFn(t.progressType["RUNNING"]);this.$set(n[n.length-1],"width",i>0?i:1)}else if("FINISHIND"===t.queryState||"FINISHED"===t.queryState){if(n.some((function(t){return"正在提交"===t.text}))||n.push({color:"linear-gradient(45deg, #cdf4ff, #5d92dd)",width:100,text:"正在提交"}),n.some((function(t){return"查询计算"===t.text}))){var a=n.findIndex((function(t){return"查询计算"===t.text}));n[a].width=100}else n.push({color:"linear-gradient(45deg, #f0f1de, #ffce74);",width:100,text:"查询计算"});setTimeout((function(){if(n.some((function(t){return"结果获取"===t.text}))){var t=n.findIndex((function(t){return"结果获取"===t.text}));n[t].width=96}else n.push({color:"linear-gradient(45deg, #eddef1, #715fd4);",text:"结果获取",width:96})}),500)}this.$set(this,"innerBarList",n)}t.loading||(this.innerBarList=[])},immediate:!0,deep:!0},"resultOption.toolList":{handler:function(t){this.toolList=t||[]},immediate:!0},engine:function(t){this.toolList=[]},toolList:{handler:function(t){this.data.name&&Object(It["c"])(this.region,{name:this.data.name,toolList:t})},deep:!0},paginationType:function(t){t&&(this.pageSize=this.toolList[this.chartActive].config.form.params.pagination.pageSize)},keyword:function(){this.pageNum=1},data:{handler:function(t){3!==t.status&&this.hadelResult()},deep:!0}},created:function(){var t=this.sqlOptions&&this.sqlOptions[this.region];if(t){var e,n=null==(e=t[this.data.name])?void 0:e.logData;n&&(this.showLogBtn=!0)}},destroyed:function(){this.timer&&clearInterval(this.timer)},methods:{handelExecute:function(){var t;this.keyword="",this.positionTableName="",this.explorLoading=!1,this.explorStatus="",this.explorationShow=!1,this.filterColumn={},this.filterType="",this.progressViewTime=!0,this.viewTime=!0,this.pageNum=1,this.timer&&clearInterval(this.timer),this.logType=!0,this.showLogBtn=!0,null==(t=this.$refs.Log)||t.handelExecute()},hadelResult:function(){this.chartActive=-1,this.logType=!1},isShowTooltip:function(t){var e=t.target.clientWidth,n=t.target.scrollWidth;this.isTipDisabled=!(n>e)},handelPosition:function(){var t={db:"temp_database",table:this.positionTableName};this.positionTable(t),document.documentElement.scrollTo({top:0,behavior:"smooth"})},createCurTable:function(){var t=this;this.cursorType=!0,this.$nextTick((function(){t.$refs.cursorForm.clearValidate()}))},copy:function(t){gt()(t,{format:"text/plain"}),this.$message.success("已复制到剪贴板")},closeCursor:function(){this.cursorForm.tableName="",this.$refs.cursorForm.clearValidate()},addCursorFn:function(){var t=this;this.$refs.cursorForm.validate((function(e){if(e){t.$report({userId:t.userInfo&&t.userInfo.userId,time:Date.now(),event:{type:"createTable",message:t.cursorForm.tableName}}),t.createTabloading=!0;var n=on(on({},t.cursorForm),{},{engine:t.engine,database:"temp_database",comment:"",region:t.region,catalog:t.catalog,uuid:t.data.uuid,lifeCycle:30});Object(u["u"])(n).then((function(e){0===e.code&&(t.cursorType=!1,t.tipsVisible=!0,t.positionTableName=t.cursorForm.tableName,t.tipsMessage="临时表已保存在".concat(t.regionLabel,"区域下, temp_database.").concat(t.cursorForm.tableName))})).finally((function(e){t.createTabloading=!1}))}}))},formatEstimatedSecond:function(t){var e=["小于2分钟","预计5分钟内","大于五分钟"];return e[t]||"-"},progressFn:function(t){return t?(100*t.toFixed(2)).toFixed(0):0},chartOptionFn:function(t){var e={},n=t.config;return n&&Object.assign(e,{chartConfig:n.form,chartConfigOptions:n.chartOptions}),e},delChartTool:function(t){this.toolList.splice(t,1),this.chartActive=this.toolList.length-1},submit:function(t){var e=t.form.index;void 0!==e?(this.toolList[e].config=t,this.$set(this.toolList,e,{title:t.form.title,type:t.form.type,config:t})):(this.toolList.push({title:t.form.title,type:t.form.type,config:t}),this.chartActive=this.toolList.length-1)},chartDrawerShow:function(t,e){var n=this;if(this.data.result&&this.data.result.length>0){var r,i;this.chartType=t,this.$refs.chartDrawer.open(),null==(r=this.$parent)||r.setSql();var a=null==(i=this.toolList[e])?void 0:i.config;a&&(a.form.index=e,this.$nextTick((function(){n.$refs.chartDrawer.setData(a)})))}else this.$message({type:"warning",message:"暂无数据"})},resultCommand:function(t){"dataExplorationFn"===t&&this.dataExplorationFn(),"journalFn"===t&&this.journalFn()},dataExplorationFn:function(t){var e=this;if(!this.explorLoading&&"err"!==this.explorStatus){var n;if("success"===this.explorStatus)return this.explorationShow=!0,void(null==(n=this.$refs.expdropdown)||n.hide());var r=this.filterData.length;r<=0?this.$message({type:"warning",message:"暂无可探查的数据"}):(this.explorLoading=!0,Object(u["w"])({uuid:this.uuid}).then((function(t){var n;0===t.data.status?(e.probeData=t.data.probeData||[],e.probTotal=t.data.total,e.explorationShow=!0,e.explorStatus="success",e.explorLoading=!1,null==(n=e.$refs.expdropdown)||n.hide()):1!==t.data.status&&2!==t.data.status||(clearInterval(e.timer),e.timer=setInterval((function(){Object(u["w"])({uuid:e.uuid}).then((function(t){var n;0===t.data.status&&(clearInterval(e.timer),e.probeData=t.data.probeData||[],e.probTotal=t.data.total,e.explorationShow=!0,e.explorStatus="success",e.explorLoading=!1,null==(n=e.$refs.expdropdown)||n.hide())})).catch((function(){clearInterval(e.timer),e.explorStatus="err",e.explorLoading=!1}))}),8e3))})).catch((function(){e.explorStatus="err",e.explorLoading=!1})))}},formatLabel:function(t){return this.data.repeat_meta[t]?this.data.repeat_meta[t]:t},journalFn:function(){var t=this;Object(u["qb"])(this.uuid).then((function(e){e.data.url?window.open(e.data.url,"_blank"):t.$message({type:"error",message:"当前语句不能查看日志"})})).catch((function(){})).finally((function(){var e;null==(e=t.$refs.expdropdown)||e.hide()}))},handleSizeChange:function(t){this.pageSize=t},handleCurrentChange:function(t){this.pageNum=t},copyData:function(){var t=this,e=this.data.meta.map((function(t){return t})).join("\t"),n=this.showData.map((function(e){var n="";return t.data.meta.forEach((function(t){n=n+e[t]+"\t"})),n})).join("\n");this.copy("".concat(e,"\n").concat(n))},downloadData:function(){var t=rn(en().mark((function t(e){var n,r,i,a=this;return en().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.uuid){t.next=8;break}return this.downloading=!0,t.next=4,Object(u["Gb"])(this.uuid);case 4:n=t.sent.data,r=n||"pdf"===e?u["G"]:u["H"],i={responseType:"blob"},r({uuid:this.uuid,type:e},i).then((function(t){if(!n&&"pdf"!==e){var r=t.data||[];r.length>0&&r.forEach((function(t){var e=document.createElement("a");e.href=t.replace(/http:|https:/i,location.protocol),e.click()}))}})).finally((function(){a.downloading=!1}));case 8:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),indexMethod:function(t){return(this.pageNum-1)*this.pageSize+t+1},sortChange:function(t){this.filterColumn=t,this.filterType=t.order},sortFun:function(t,e){return e=void 0===e||e?1:-1,function(n,r){var i=/^[0-9]+.?[0-9]*$/;return n=n[t],r=r[t],i.test(n)&&i.test(r)&&(n=Number(n),r=Number(r)),n<r?-1*e:n>r?1*e:0}}}},fn=cn,hn=(n("01cc"),Object(N["a"])(fn,qt,Nt,!1,null,"a10046e4",null)),pn=hn.exports,dn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrapper"},[n("div",{staticClass:"header"},[n("div",{staticClass:"h_lf"},[t._v("SQL助手-Beta")]),t._v(" "),n("div",{staticClass:"h_ri"},[n("span",{staticClass:"msg_tips tool_item"},[n("i",{staticClass:"el-icon-document",on:{click:t.handelHelp}})]),t._v(" "),n("i",{staticClass:"el-icon-close tool_item close",on:{click:t.close}})])]),t._v(" "),n("div",{ref:"AIsqlContent",staticClass:"content"},t._l(t.msgList,(function(t,e){return n("msgItem",{key:e,ref:"msgItem",refInFor:!0,attrs:{options:t}})})),1),t._v(" "),n("div",{staticClass:"footer"},[n("div",{staticClass:"tool_btn"},[n("el-checkbox",{staticClass:"stop_btn",attrs:{disabled:!t.loading},on:{change:t.changeStop},model:{value:t.stop,callback:function(e){t.stop=e},expression:"stop"}},[t._v("停止操作")])],1),t._v(" "),n("div",{staticClass:"input_box"},[n("el-input",{ref:"inputText",staticClass:"input_text",attrs:{type:"textarea",autosize:{minRows:1,maxRows:2},disabled:t.loading||t.stop,placeholder:"请输入内容"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handelInput(e)}},model:{value:t.input,callback:function(e){t.input=e},expression:"input"}}),t._v(" "),n("div",{staticClass:"input_btn",on:{click:t.handelInput}},[n("svg-icon",{staticClass:"share_btn",attrs:{"icon-class":"share"}})],1)],1)]),t._v(" "),n("el-dialog",{attrs:{title:"请选择数据表",visible:t.dialogVisible,width:"615px"},on:{"update:visible":function(e){t.dialogVisible=e},close:t.dialClose}},[n("div",{staticClass:"dial_box"},[n("el-transfer",{ref:"tableTransfer",attrs:{titles:["数据表","已选择数据表"],filterable:"","filter-method":t.filterMethod,"filter-placeholder":"请输入表名",data:t.tableData},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.option;return n("span",{},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",disabled:t.isTipDisabled,content:r.label,placement:"top"}},[n("span",{staticClass:"block ellipsis",on:{mouseenter:t.isShowTooltip}},[t._v(t._s(r.label))])])],1)}}]),model:{value:t.selectionTables,callback:function(e){t.selectionTables=e},expression:"selectionTables"}})],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.selectionTableOk}},[t._v("确 定")])],1)]),t._v(" "),n("el-info",{attrs:{title:t.infoObj.title,width:"620px"},model:{value:t.infoObj.type,callback:function(e){t.$set(t.infoObj,"type",e)},expression:"infoObj.type"}},[t.infoObj.type?n("div",{directives:[{name:"highlight",rawName:"v-highlight"}],staticClass:"helpDom",attrs:{id:"helpDom"}}):t._e()])],1)},mn=[],gn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"msg_item"},[n("div",{staticClass:"msg_content",style:t.styleFn()},["left"===t.options.position?n("el-avatar",{attrs:{size:"large",src:t.src}}):t._e(),t._v(" "),n("div",{staticClass:"msg"},[n("div",{staticClass:"header"},[n("div",{staticClass:"name"},[t._v(t._s("@"+(t.options.userName||"DataCake")))]),t._v(" "),"left"===t.options.position?n("div",{staticClass:"tool"},[n("i",{staticClass:"el-icon-document-copy copy",on:{click:function(e){return t.handelCopy(t.options.msg)}}})]):t._e()]),t._v(" "),t._t("default",[n("div",{directives:[{name:"highlight",rawName:"v-highlight"}],class:["msg_box","left"===t.options.position?"addPadding":""],domProps:{innerHTML:t._s(t.options.transMSg||t.options.msg)}})])],2),t._v(" "),"right"===t.options.position?n("el-avatar",{attrs:{size:"large",src:t.src}}):t._e()],1)])},vn=[],bn={name:"AIsql",props:{options:{type:Object,default:function(){return{userName:"",msg:"",position:"left"}}}},data:function(){return{}},computed:{src:function(){return"left"===this.options.position?n("1265"):n("295e")}},methods:{handelCopy:function(t){gt()(t,{format:"text/plain"}),this.$message({type:"success",message:"已复制到剪贴板"})},styleFn:function(){var t={};return t["background-color"]="left"===this.options.position?"#c4ecfe":"#e2e0fe",t["float"]=this.options.position,t}}},yn=bn,wn=(n("3a8f"),Object(N["a"])(yn,gn,vn,!1,null,"3cdc6368",null)),_n=wn.exports,kn=n("ec26"),Dn=n("7c5c");function xn(t){return xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xn(t)}function Cn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Sn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Cn(Object(n),!0).forEach((function(e){On(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Cn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function On(t,e,n){return e=Ln(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ln(t){var e=Tn(t,"string");return"symbol"===xn(e)?e:String(e)}function Tn(t,e){if("object"!==xn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==xn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var En={name:"AIsql",components:{msgItem:_n},props:{region:{type:String,default:""},catalog:{type:String,default:""},data:{type:Object,required:!0}},data:function(){return{infoObj:{type:!1,title:"SQL助手教程"},dialogVisible:!1,stop:!1,input:"",msgList:[],selectionTables:[],renderer:null,loading:!1,timer:null,contentDom:null,cancel:null,isTipDisabled:!1,cueerntStr:["语法检查","SQL优化","SQL生成"]}},computed:Sn(Sn({},Object(f["c"])(["userInfo","tableList"])),{},{tableData:function(){return this.tableList.map((function(t){return{key:t,label:t}}))}}),watch:{msgList:function(t){var e=this;if(t[t.length-1]){var n=t[t.length-1];"语法检查"===n.msg.trim()&&t.length>1&&"right"===n.position?setTimeout((function(){e.msgList.push({userName:"DataCake",msg:"您可以这样说：请帮我检查以下SQL是否有什么错误，如果有错，请解释错误并将修改后的SQL以代码块形式返回。SQL为：……",position:"left"})}),1e3):"SQL优化"===n.msg.trim()&&t.length>1&&"right"===n.position?setTimeout((function(){e.msgList.push({userName:"DataCake",msg:"您可以这样说：请问以下SQL是否可以进一步优化从而提高执行效率，SQL为：……",position:"left"})}),1e3):"SQL生成"===n.msg.trim()&&t.length>1&&"right"===n.position?setTimeout((function(){e.msgList.push({userName:"DataCake",msg:'\n                请选择您要生产SQL的数据表: \n                <span class="ai_sql_btn color_cyan" data-type="4">点击进行选择数据表</sapn>\n              ',position:"left"})}),1e3):n.type&&"create_table"===n.type&&setTimeout((function(){e.msgList.push({userName:"DataCake",msg:"请描述您的需求，例如您可以这样说“请帮我写Trino SQL语句来查询上表中XX的数据，要求日期范围在XX和XX之间；XX字段取值只能为XX、XX；查询出的字段需要有XX、XX。SQL格式化后以代码块形式返回，末尾不要带分号。”",position:"left"})}),1e3),this.endDomView()}}},mounted:function(){this.initMDRender(),this.contentDom=this.$refs.AIsqlContent,this.contentDom&&this.contentDom.addEventListener("click",this.handelContent)},destroyed:function(){var t;null==(t=this.contentDom)||t.removeEventListener("click",this.handelContent),clearTimeout(this.timer)},methods:{isShowTooltip:function(t){var e=t.target.clientWidth,n=t.target.scrollWidth;this.isTipDisabled=!(n>e)},changeStop:function(t){var e=this;t&&(this.cancel&&this.cancel(),setTimeout((function(){e.stop=!1,e.addMsgList({userName:"DataCake",msg:"已取消,请重新描述您的需求.",position:"left"})}),1500))},handelHelp:function(){var t=this;this.infoObj.type=!0,p.a.get("/static/help.md").then((function(e){var n=document.documentElement.querySelector("#helpDom");e.data?(n.innerHTML=Object(Dn["marked"])(e.data),t.$forceUpdate()):n.innerHTML="数据加载失败"})).catch((function(){var t=document.documentElement.querySelector("#helpDom");t.innerHTML="数据加载失败"}))},addMsgList:function(t){var e=this.msgList.findIndex((function(t){return"loading"===t.type}));-1===e?this.msgList.splice(this.msgList.length,0,t):this.msgList.splice(e,1,t)},initMDRender:function(){this.renderer=new Dn["marked"].Renderer,this.renderer.code=function(t,e){var n=e?' class="language-'.concat(e,'"'):"",r='\n          <div class="code_tool">\n            <span class="tool_language">'.concat(e||"sql",'</span>\n            <i class="el-icon-document-copy copy_btn ai_sql_btn" data-type="5" data-code=').concat(encodeURI(t),"></i>\n          </div>\n        ");return"<pre".concat(n,">").concat(r,'<code class="code_msg">').concat(t,"</code></pre>")}},selectionTableOk:function(){0!==this.selectionTables.length?(this.dialogVisible=!1,this.sendTableInfo(this.selectionTables)):this.$message({type:"warning",message:"至少选择一个数据表"})},sendTableInfo:function(t){var e=this,n={uuid:this.uuid};n.info=t.map((function(t){return{region:e.region,catalog:e.catalog,database:Object(v["a"])("ds-query-database")||"",table:t}})),Object(u["vb"])(n).then((function(n){e.msgList.push({userName:e.userInfo.userId,msg:"\n            您选择的数据表有: \n            ".concat(t.map((function(t){return"<br />".concat(t)})),"\n          "),type:"create_table",position:"right"})})).catch((function(){e.msgList.push({userName:"DataCake",msg:'您选择的数据表,获取数据错误,请重新选择\n          <span class="ai_sql_btn color_cyan" data-type="4">点击进行选择数据表</sapn>\n          ',position:"left"})}))},dialClose:function(){var t=this;this.selectionTables=[],this.$nextTick((function(){t.$refs.tableTransfer.clearQuery("left"),t.$refs.tableTransfer.clearQuery("right")}))},filterMethod:function(t,e){return e.label.indexOf(t)>-1},handelContent:function(t){var e,n,r;switch(t&&null!=(e=t.target)&&null!=(n=e.className)&&n.includes("ai_sql_btn")&&(r=t.target.dataset.type),r){case"1":this.handelSql(r,"语法检查");break;case"2":this.handelSql(r,"SQL生成");break;case"3":this.handelSql(r,"SQL优化");break;case"4":this.dialogVisible=!0;break;case"5":this.handelCope(t.target.dataset.code);break}},handelCope:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=decodeURI(t),n=e.endsWith(";")?e.slice(0,-1):e;gt()(n,{format:"text/plain"}),this.$message.success("已复制到剪贴板")},handelSql:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.msgList.push({userName:this.userInfo.userId,msg:e,position:"right"})},init:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1?arguments[1]:void 0;this.uuid=Object(kn["a"])(),1===t?this.msgList.push({userName:"DataCake",msg:'请您选择要进行的操作 \n                <span class="ai_sql_btn" data-type="1">语法检查</sapn>\n                <span class="ai_sql_btn" data-type="2">SQL生成</sapn>\n                <span class="ai_sql_btn" data-type="3">SQL优化</sapn>\n              ',position:"left"}):2===t&&this.handelInput(e)},close:function(){this.msgList=[],this.$emit("close")},endDomView:function(){var t=this;this.$nextTick((function(){var e,n=t.$refs.msgItem,r=null==(e=n[n.length-1])?void 0:e.$el;r&&r.scrollIntoView({behavior:"smooth",block:"end"})}))},handelInput:function(t){var e=this;if(this.input.trim()||t.msg){var n="";if(t.msg&&(n="请帮我排查sql运行错误,sql语句为: ".concat(t.sql,",报错信息是: ").concat(t.msg," 请解释原因并给出修改后的sql,并以代码块的方式返回")),this.msgList.push({userName:this.userInfo.userId,msg:n||this.input,position:"right"}),this.cueerntStr.some((function(t){return t===e.input.trim()})))return this.$nextTick((function(){var t;null==(t=e.$refs.inputText)||t.focus()})),void(this.input="");this.loading=!0;var r={content:n||this.input,uuid:this.uuid};this.timer=setTimeout((function(){e.addMsgList({userName:"DataCake",msg:"SQL小助手正在奋笔疾书中，请您稍候......",type:"loading",position:"left"})}),1e3);var i=this,a={cancelToken:new p.a.CancelToken((function(t){i.cancel=t}))};Object(u["l"])(r,a).then((function(t){e.addMsgList({userName:"DataCake",msg:t.data.answer,transMSg:Object(Dn["marked"])(t.data.answer||"",{renderer:e.renderer}),position:"left"})})).catch((function(t){p.a.isCancel(t)||e.addMsgList({userName:"DataCake",msg:t.msg||t.massage||"服务器资源紧张,请稍后重试.....",position:"left"})})).finally((function(){e.loading=!1,clearTimeout(e.timer),e.$nextTick((function(){var t;null==(t=e.$refs.inputText)||t.focus()}))})),this.input=""}}}},An=En,jn=(n("53c2"),Object(N["a"])(An,dn,mn,!1,null,"ccf1b1dc",null)),Fn=jn.exports,qn=n("01ea");function Nn(t){return Nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nn(t)}function In(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */In=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var a=e&&e.prototype instanceof v?e:v,o=Object.create(a.prototype),s=new E(r||[]);return i(o,"_invoke",{value:S(t,n,s)}),o}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h="suspendedStart",p="suspendedYield",d="executing",m="completed",g={};function v(){}function b(){}function y(){}var w={};u(w,o,(function(){return this}));var _=Object.getPrototypeOf,k=_&&_(_(A([])));k&&k!==n&&r.call(k,o)&&(w=k);var D=y.prototype=v.prototype=Object.create(w);function x(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function n(i,a,o,s){var l=f(t[i],t,a);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==Nn(c)&&r.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,o,s)}),(function(t){n("throw",t,o,s)})):e.resolve(c).then((function(t){u.value=t,o(u)}),(function(t){return n("throw",t,o,s)}))}s(l.arg)}var a;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return a=a?a.then(i,i):i()}})}function S(e,n,r){var i=h;return function(a,o){if(i===d)throw new Error("Generator is already running");if(i===m){if("throw"===a)throw o;return{value:t,done:!0}}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var l=O(s,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===h)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=d;var u=f(e,n,r);if("normal"===u.type){if(i=r.done?m:p,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=m,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var a=f(i,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,g;var o=a.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(Nn(e)+" is not iterable")}return b.prototype=y,i(D,"constructor",{value:y,configurable:!0}),i(y,"constructor",{value:b,configurable:!0}),b.displayName=u(y,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u(t,l,"GeneratorFunction")),t.prototype=Object.create(D),t},e.awrap=function(t){return{__await:t}},x(C.prototype),u(C.prototype,s,(function(){return this})),e.AsyncIterator=C,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new C(c(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},x(D),u(D,l,"Generator"),u(D,o,(function(){return this})),u(D,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=A,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var l=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:A(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}function $n(t,e,n,r,i,a,o){try{var s=t[a](o),l=s.value}catch(u){return void n(u)}s.done?e(l):Promise.resolve(l).then(r,i)}function Pn(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){$n(a,r,i,o,s,"next",t)}function s(t){$n(a,r,i,o,s,"throw",t)}o(void 0)}))}}function Bn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function zn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Bn(Object(n),!0).forEach((function(e){Mn(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Bn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Mn(t,e,n){return e=Qn(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qn(t){var e=Gn(t,"string");return"symbol"===Nn(e)?e:String(e)}function Gn(t,e){if("object"!==Nn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Nn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function Rn(t,e,n){for(var r in t){if(t[r].id===n)return t[r].name;if(t[r][e]){var i=Rn(t[r][e],e,n);if(i)return i}}}var Hn={components:{MonacoEditor:ht,Result:pn,customTree:z["a"],shareDialog:Ct,AIsql:Fn,ControlDial:Ft},props:{data:{type:Object,required:!0},activeTabName:{type:String,default:""}},data:function(){var t,e=function(t,e,n){if(""===e)n(new Error("请输查询名称"));else{var r=Object(U["getStrByte"])(e,30);r!==e&&n("长度不能超过30个字符"),n()}};return{controlSql:"",downType:!1,AIsqlType:!1,cpmType:!1,regionSave:"",engine:this.data.engine||"",shareUrl:"",executeType:!1,isDatabend:!1,sql_base64:"",accelerateTips:!1,isAccelerate:!1,timerInter:null,newApiPath:"",customTheme:{rules:[{token:"string.sql",foreground:"b81515"},{token:"operator.sql",foreground:"0000ff"},{token:"predefined.sql",foreground:"925e26"}],colors:{"editor.lineHighlightBackground":"#e8f2ff","sideBar.background":"#330000"}},apiHistoryForm:{},apiDialogStatus:!1,apiPathShow:!0,apiForm:{title:""},apiFormRules:{title:[{required:!0,message:"请输入API名称",trigger:"blur"},{pattern:/^(?!_)[\u4e00-\u9fa5a-zA-Z0-9_]+$/,message:"格式错误",trigger:"blur"}]},redKey:[],sqlKeyObj:{regRes:[],keyList:[]},editPositionData:{lineNumber:1,column:1},showShare:!1,running:!1,uuid:(null==(t=this.data.result)?void 0:t.uuid)||"",queryId:"",querySql:this.data.querySql,resultOption:{toolList:this.data.toolList},result:this.data.result||{result:[],meta:[],status:-1,executeDuration:0,fileSize:"",scanSize:"",codeStr:"",message:""},height:0,offsetHeight:160,startY:0,fullscreen:!1,dialogVisible:!1,form:{title:"",description:"",folderName:"",folderID:null},rules:{title:[{validator:e,trigger:"blur"}]},scanningLoading:!1,scanningStatus:"",defaultProps:{children:"child",label:"name"},catalogDisabledList:["ch_","mysql_"],engineDisabled:!1,text:"{{ (execution_date - macros.timedelta(days=1)).strftime('%Y%m%d') }}",quickData:[{action:"运行查询",keyword:"Ctrl + Enter"},{action:"保存查询",keyword:"Ctrl + S"},{action:"格式化SQL",keyword:"Ctrl + Alt + L"},{action:"回退",keyword:"Ctrl + Z"},{action:"搜索",keyword:"Ctrl + F"}],gridData:[{expression:"{{ ds }}",mean:"the execution date as YYYY-MM-DD"},{expression:"{{ ds_nodash }}",mean:"the execution date as YYYYMMDD"},{expression:"{{ yesterday_ds }}",mean:"yesterday’s date as YYYY-MM-DD"},{expression:"{{ yesterday_ds_nodash }}",mean:"yesterday’s date as YYYYMMDD"},{expression:"{{ tomorrow_ds }}",mean:"tomorrow’s date as YYYY-MM-DD"},{expression:"{{ tomorrow_ds_nodash }}",mean:"tomorrow’s date as YYYYMMDD"},{expression:"{{ ts }}",mean:"same as execution_date.isoformat()"},{expression:"{{ ts_nodash }}",mean:"same as ts without - and :"},{expression:"{{ execution_date }}",mean:"the execution_date, (datetime.datetime)"},{expression:"{{ prev_execution_date }}",mean:"the previous execution date (if available)(datetime.datetime)"},{expression:"{{ next_execution_date }}",mean:"the next execution date (datetime.datetime)"},{expression:"{{ prev_2_execution_date }}",mean:"the previous  pre_execution_date (if available)(datetime.datetime) timezone: UTC+8, BEIJING"},{expression:"{{ ds_utc0 }}",mean:"the execution date as YYYY-MM-DD timezone: UTC+0"},{expression:"{{ ds_nodash_utc0 }}",mean:"the execution date as YYYYMMDD timezone: UTC+0"},{expression:"{{ yesterday_ds_utc0 }}",mean:"yesterday’s date as YYYY-MM-DD timezone: UTC+0"},{expression:"{{ yesterday_ds_nodash_utc0 }}",mean:"yesterday’s date as YYYYMMDD timezone: UTC+0"},{expression:"{{ tomorrow_ds_utc0 }}",mean:"tomorrow’s date as YYYY-MM-DD timezone: UTC+0"},{expression:"{{ tomorrow_ds_nodash_utc0 }}",mean:"tomorrow’s date as YYYYMMDD timezone: UTC+0"},{expression:"{{ execution_date_utc0 }}",mean:"the execution_date, (datetime.datetime) timezone: UTC+0"}],smartEngineObj:{smartEngineType:!1},progressObj:{},transfEditorType:!1,oldQuerySql:this.data.ildQuerySql||""}},computed:zn({controlType:function(){var t,e,n=!1;n=null==(t=this.data.result)?void 0:t.status;var r=null==(e=this.querySql)?void 0:e.split(";").filter((function(t){return t})).length;return 0===n&&1===r&&this.keyList.length},noDrag:function(){var t=this.folderList[0];return t?[t[this.defaultProps.label]]:[]},permission1:function(){var t={condition:"external",instead:!0};return t.condition_met=this.userInfo?this.userInfo.tenantName:"",t},permission:function(){var t={};return t.condition=qn["c"],t.condition_met=this.userInfo?this.userInfo.tenantName:"",t},sqlBoxStyle:function(){var t,e={},n=0;return this.unExecuteType&&(n=220),t=this.height?this.height+"px":"calc(100vh - ".concat(160+n,"px)"),e.height=t,JSON.parse(JSON.stringify(e))},unExecuteType:function(){var t,e;return e=null==(t=this.data.result)?void 0:t.status,e=void 0===e||-1===e?null:0===e||e,!!e},smartEngine:function(){var t=this;if(this.smartEngineObj&&this.smartEngineObj.smartEngineType){var e=this.engineList.find((function(e){return e.value===t.smartEngineObj.smartEngine})),n=e?e.label:this.smartEngineObj.smartEngine;return n||"XXX"}return"XXX"},engineDisabledType:function(){return this.engineDisabled||this.smartEngineObj&&this.smartEngineObj.smartEngineType},engFunctionShow:function(){var t=this,e=["spark-","presto_"];return e.some((function(e){return t.engine.includes(e)}))},disabledBtn:function(){var t=this.result;return!(0===t.status)},showScan:function(){return this.engine.startsWith("ares_")||this.engine.startsWith("presto_")},keyList:function(){var t=this.querySql||"",e=/\{\{[^(?!\{\{|\{)]+\}\}/g,n=t.match(e);if(n=n||[],n.length>0){var r=n.map((function(t){var e=t.indexOf("}}"),n=t.slice(2,e).trim();return n||""}));r=r.filter((function(t){return t})),r=Array.from(new Set(r));var i=r.map((function(t){return{key:t,value:""}}));return this.$set(this.sqlKeyObj,"regRes",n),i}return[]}},Object(f["c"])(["sqlList","sqlOptions","userInfo","folderList","engineList","region","catalog"])),watch:{oldQuerySql:function(t){Object(It["c"])(this.region,{name:this.data.name,oldQuerySql:t})},engine:function(t){if(this.engine.startsWith("spark-")?this.sqlKeyObj.keyList.forEach((function(t){qn["b"].includes(t.key)?t.disabled=!0:t.disabled=!1})):this.sqlKeyObj.keyList.forEach((function(t){t.disabled=!1})),this.activeTabName===this.data.name){if(this.retain)return;this.showShare=!1,Object(It["c"])(this.region,{name:this.data.name,title:this.data.title,querySql:this.querySql,uuid:this.uuid,engine:t,toolList:void 0,catalog:this.catalog}),this.data.result=void 0,this.$store.commit("SET_SQLLIST",{key:this.region,list:{engine:this.engine,name:this.data.name,once:!0,status:-1}}),this.initList()}},catalog:{handler:function(t){var e=this;this.$nextTick((function(){if(e.activeTabName===e.data.name){if(e.retain){var n;e.engine=e.engine?e.engine:null!=(n=e.engineList[0])&&n.value?e.engineList[0].value:""}else{var r=e.data.engine;r&&e.engineList.some((function(t){return t.value===r}))?e.engine=r:e.engine=e.engineList[0]?e.engineList[0].value:e.engine}Object(It["c"])(e.region,{name:e.data.name,engine:e.engine,catalog:t})}e.engineDisabled=e.catalogDisabledList.some((function(t){return e.engine.includes(t)}))}))},immediate:!0},uuid:function(){this.apiPathShow=!0},keyList:{handler:function(t){var e=this,n=this.sqlKeyObj.keyList.map((function(t){var e=t.key;return e})),r=this.keyList.map((function(t){var e=t.key;return e}));if(n.length<=0)this.$set(this.sqlKeyObj,"keyList",t);else if(n.length===r.length)r.forEach((function(t,r){n.includes(t)||(e.sqlKeyObj.keyList[r].key=t)}));else{var i=[];this.keyList.forEach((function(t,e){n.includes(t.key)||i.push([e,t])})),i.length>0&&i.forEach((function(t){e.sqlKeyObj.keyList.splice(t[0],0,t[1])}));var a=[];this.sqlKeyObj.keyList.forEach((function(t,e){r.includes(t.key)||a.unshift(e)})),a.length>0&&a.forEach((function(t){e.sqlKeyObj.keyList.splice(t,1)}))}},deep:!0,immediate:!0},"sqlKeyObj.keyList":{handler:function(){this.$store.commit("SET_SQLOPTIONS",{region:this.region,name:this.data.name,key:"keyList",value:this.sqlKeyObj.keyList}),this.sqlKeyObj.keyList.forEach((function(t){qn["b"].includes(t.key)?t.disabled=!0:t.disabled=!1}))},deep:!0},querySql:function(){Object(It["c"])(this.region,{name:this.data.name,title:this.data.title,querySql:this.querySql,uuid:this.uuid,engine:this.engine}),this.showScan&&(this.scanningLoading=!1,this.scanningStatus="")},data:{handler:function(t){t.result&&(this.result=t.result,this.running=this.result.running,t.result.keyList&&(this.sqlKeyObj.keyList=t.result.keyList),3!==t.result.status&&void 0!==t.result.status&&this.engine.startsWith("presto")&&(clearInterval(this.proGressTime),clearTimeout(this.progressSetTime),this.progressObj={loading:!1},this.$store.commit("SET_SQLOPTIONS",{region:this.region,name:this.data.name,key:"progressObj",value:{loading:!1}})))}},progressObj:{handler:function(t){if(t.loading&&t.stroe){var e=t.startDate,n=t.endDate||(new Date).getTime();(n-e)/1e3>=2?this.progressFn():this.awaitProgressFn(n-e)}},immediate:!0,deep:!0},activeTabName:{handler:function(t){t===this.data.name&&this.data.catalog&&this.SET_CATALOG(this.data.catalog)},immediate:!0}},mounted:function(){var t=this;document.onkeyup=function(e){"Escape"!==e.code&&27!==e.keycode||(t.fullscreen=!1)},this.regionSave=this.region,this.data.oldQuerySql&&(this.transfEditorType=!0,this.$nextTick((function(){t.$refs.transfMonaco.setCode(t.data.oldQuerySql)})));var e=this.sqlOptions&&this.sqlOptions[this.region];if(e){var n,r,i;this.sqlKeyObj.keyList=(null==(n=e[this.data.name])?void 0:n.keyList)||[],this.smartEngineObj=(null==(r=e[this.data.name])?void 0:r.smartEngineObj)||{};var a=(null==(i=e[this.data.name])?void 0:i.progressObj)||{};this.progressObj=zn(zn({},a),{},{stroe:!0})}},destroyed:function(){if(this.data.result){var t=this.data.result.running;t&&this.regionSave&&this.$store.commit("SET_SQLLIST",{key:this.regionSave,list:{engine:this.engine,running:!0,name:this.data.name,once:!1,status:3}})}clearInterval(this.timer),clearInterval(this.timerTow),clearInterval(this.timerInter),clearInterval(this.proGressTime),clearTimeout(this.progressSetTime)},inject:["initList","changeActiveTab","changeWidth","visible"],methods:zn(zn({},Object(f["d"])(["SET_CATALOG","SET_FOLDERLIST"])),{},{formatControlSql:function(t){var e=this,n=!1;return this.sqlKeyObj.keyList.forEach((function(r,i){r.value||qn["b"].includes(r.key)||n||(n=!0);var a=e.sqlKeyObj.regRes.find((function(t){return t.slice(2,-2).trim()===r.key}));qn["b"].includes(r.key)||(t=t.split(a).join(r.value))})),n&&this.$message({type:"warning",message:"请填写参数值"}),{sql:t,nullType:n}},controlSubmit:function(t,e){var n=this,r=zn(zn({},t),{},{region:this.region,originSql:window.btoa(encodeURIComponent(this.controlSql)),userName:this.userInfo.userName,engine:this.data.engine,catalog:this.data.catalog,database:Object(v["a"])("ds-query-database")||""});Object(u["t"])(r).then((function(t){console.log(t,"ss"),0===t.code&&(e(),n.$message.success("调度成功"),sessionStorage.setItem("ds-controlManager-refresh",1))}))},hnadelcontrol:function(){var t,e=this.formatControlSql(this.querySql),n=e.sql,r=e.nullType;r||(this.controlSql=n||"",null==(t=this.$refs.controlDial)||t.show())},handelCurrent:function(t){var e;null==(e=this.$refs.monaco)||e.handelCurrent(t)},addFile:function(t,e){var n,r=this,i={name:t.addFileName,level:e?e.level+1:1,parent_id:e?e.id:null==(n=this.folderList[0])?void 0:n.id,is_active:1,is_query:0};Object(u["h"])(i).then((function(t){0===t.code&&(r.$message({type:"success",message:"新建成功"}),r.getFolderList())}))},resetFolderName:function(t){var e=this,n={id:t.id+"",name:t[this.defaultProps.label]};Object(u["J"])(n).then((function(n){e.$message({type:"success",message:"修改成功"}),e.handelClickMove(t),e.getFolderList()}))},delFile:function(){var t=Pn(In().mark((function t(e){var n,r,i,a=this;return In().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={info:"",title:"",query_sql:"",engine:"",folderID:e.id,pageSize:30,pageNum:1},t.next=3,Object(u["ub"])(n);case 3:if(r=t.sent,i=r.data,!(i.list&&i.list.length>0)){t.next=8;break}return this.$message({type:"warning",message:"该文件夹下存在保存的sql,请先删除保存的sql再进行该操作"}),t.abrupt("return");case 8:Object(u["C"])({id:e.id+""}).then((function(t){a.$message({type:"success",message:"删除成功"}),a.form.folderID===e.id&&(a.form.folderID="",a.form.folderName=""),a.getFolderList()}));case 9:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),moveFile:function(t,e){var n={id:t.id+"",parent_id:e.id?e.id+"":null,is_query:"0"};this.folderMove(n)},folderMove:function(t){var e=this;Object(u["N"])(t).then((function(t){e.$message({type:"success",message:"操作成功"})})).finally((function(){e.getFolderList()}))},getFolderList:function(){var t=this;Object(u["gb"])().then((function(e){var n=e.data||[];t.SET_FOLDERLIST(n)}))},closeEditor:function(){this.transfEditorType=!1,this.oldQuerySql=""},awaitProgressFn:function(t){var e=this;setTimeout((function(){e.$set(e.progressObj,"dialog",!0),e.$store.commit("SET_SQLOPTIONS",{region:e.region,name:e.data.name,key:"progressObj",value:zn(zn({},e.progressObj),{},{dialog:!0})}),e.progressFn()}),t)},progressFn:function(){var t=this;if(this.progressObj.stroe&&(this.progressObj.stroe=!1),this.progressObj.loading){var e={step:this.progressObj["step"]?this.progressObj["step"]:1,uuid:this.uuid||this.data.uuid,query_id:this.progressObj["query_id"]?this.progressObj["query_id"]:""};Object(u["db"])(e).then((function(n){if(0===n.code){if(clearInterval(t.proGressTime),!t.progressObj.loading)return;n.data.query_id&&(e.query_id=n.data.query_id,e.step=e.step+1),n.data.estimatedSecond&&(e.step=e.step+1);var r=zn(zn({},n.data),{},{step:e.step});n.data.queryState&&(r["progressType"]=r["progressType"]?r["progressType"]:{},r["progressType"][n.data.queryState]=n.data.progress),t.$set(t,"progressObj",zn(zn({},t.progressObj),r)),t.$store.commit("SET_SQLOPTIONS",{region:t.region,name:t.data.name,key:"progressObj",value:Object.assign(t.progressObj,r)}),t.proGressTime=setInterval((function(){Object(u["db"])(e).then((function(n){if(t.progressObj.loading){n.data.query_id&&(e.query_id=n.data.query_id,e.step=e.step+1),n.data.estimatedSecond&&(e.step=e.step+1);var r=zn(zn({},n.data),{},{step:e.step});n.data.queryState&&(r["progressType"]=r["progressType"]?r["progressType"]:{},r["progressType"][n.data.queryState]=n.data.progress),t.$set(t,"progressObj",zn(zn({},t.progressObj),r)),t.$store.commit("SET_SQLOPTIONS",{region:t.region,name:t.data.name,key:"progressObj",value:Object.assign(t.progressObj,r)})}else clearInterval(t.proGressTime)})).catch((function(){clearInterval(t.proGressTime)}))}),4e3)}}))}},setSql:function(){var t=Pn(In().mark((function t(){return In().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.engine.startsWith("spark-")&&!this.engine.startsWith("presto_")){t.next=8;break}if(!this.sqlKeyObj.keyList.some((function(t){return qn["b"].includes(t.key)}))){t.next=5;break}this.result.editSql=this.querySql,t.next=8;break;case 5:return t.next=7,this.farmatSqlFn(this.querySql);case 7:this.result.editSql=t.sent.sql;case 8:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),shaerSubmit:function(t){var e=this,n=zn(zn({},t),{},{sharer:this.userInfo.userId,shareUrl:this.shareUrl,name:this.data.title.startsWith("query")?"":this.data.title});Object(u["i"])(n).then((function(t){e.$message({type:"success",message:"分享成功"})}))},handelClickMove:function(t){this.form.folderName=t[this.defaultProps.label],this.form.folderID=t.id,this.$refs.selectTree.visible=!1,this.$forceUpdate()},handletoolBarCommand:function(t){"dispatchFn"===t?this.dispatchFn():"DataScanning"===t?this.DataScanning():"apiPopoverFn"===t&&this.apiPopoverFn()},apiPopoverFn:function(){this.apiDialogStatus=!0,this.apiHistoryForm.path&&(this.apiForm.title=this.apiHistoryForm.title)},transGrammar:function(){var t=this;if(this.engFunctionShow)if(this.querySql)if(this.transfEditorType)this.handelTransSql();else{var e="您确定将Ares语法转换为Spark语法吗？",n=this.$createElement;this.$msgbox({title:"语法转换",message:n("p",null,[n("div",{style:"margin-bottom:5px;"},e)]),showCancelButton:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){t.handelTransSql()}))}else this.$message({type:"warning",message:"请先输入SQL!"})},handelTransSql:function(){var t=this,e=this.engine.includes("spark-"),n=this.transfEditorType?this.oldQuerySql:this.querySql;n=Object(It["e"])(n);try{var r=new FormData;r.append("sql",Object(U["strToBase64"])(n)),Object(u["yb"])(r).then((function(r){if("SUCCESS"===r.data.res){t.transfEditorType=!0;var i=n;if(e)t.$refs.monaco.setCode(Object(U["base64ToStr"])(r.data.sparkSql)),t.formatSql(),t.$message({type:"success",message:"语法转换成功"});else{var a,o=null==(a=t.engineList.find((function(t){return t.value.includes("spark-")})))?void 0:a.value;o&&(t.$message({type:"success",message:"语法转换成功"}),t.engine=o,t.$refs.monaco.setCode(Object(U["base64ToStr"])(r.data.sparkSql)),t.$refs.monaco.formatSql())}t.$nextTick((function(){t.$refs.transfMonaco.setCode(i)}))}else t.$notify({title:t.$t("common.error"),type:"error",dangerouslyUseHTMLString:!0,message:r.data.message+"<br />SQL脚本存在语法错误，无法完成转换!",duration:5e3})}))}catch(i){this.$notify({title:this.$t("common.error"),type:"error",dangerouslyUseHTMLString:!0,message:"SQL脚本存在语法错误，无法完成转换!",duration:5e3})}},copyPath:function(t){gt()(t,{format:"text/plain"}),this.$message({type:"success",message:"API Path已复制到剪贴板"})},cancelApi:function(){this.apiDialogStatus=!1,this.$refs.apiForm&&this.$refs.apiForm.resetFields()},saveApi:function(t){var e=this;if(this.engineList.length>0&&!this.engineList.some((function(t){return t.value===e.engine})))this.$message({type:"warning",message:"请切换引擎或数据源"});else{var n=this,r=this.sqlKeyObj.keyList.map((function(t){var e=t.key;return e})),i={id:this.apiHistoryForm.id,title:this.apiForm.title,engine:this.engine,region:this.region,catalog:this.catalog,querySql:this.querySql,uuid:this.uuid,param:r.join(",")},a="add"===t?u["e"]:u["Db"],o=function(t){a(t).then((function(t){var e=t.data.data;"1"===e?n.$message({type:"warning",message:"API 名称重复"}):(n.newApiPath=e,n.apiForm.title="",n.apiPathShow=!1,sessionStorage.setItem("ds-generateApi-refresh",1))}))};"update"===t?(i.title=this.apiHistoryForm.title,o(i)):this.$refs.apiForm.validate((function(t){t&&(delete i.id,o(i))}))}},dispatchFn:function(){var t=this,e={uuid:this.uuid,engine:this.engine,querySql:this.querySql};Object(u["f"])(e).then((function(e){window.open("".concat(t.$locationOrigin,"/task/step2HiveSQL?uuid=")+t.uuid)}))},farmatSqlFn:function(){var t=Pn(In().mark((function t(e){var n,r,i,a=this;return In().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=!1,!(this.keyList.length<=0)){t.next=3;break}return t.abrupt("return",{sql:e,nullType:n});case 3:if(this.redKey=[],r=this.sqlKeyObj.keyList.filter((function(t){return t.disabled})).map((function(t){return t.key})),!(r.length>0)){t.next=10;break}return t.next=8,Object(u["bb"])({jinja:r.join(",")});case 8:i=t.sent,Object.keys(i.data).forEach((function(t){var e=a.sqlKeyObj.keyList.findIndex((function(e){return e.key===t}));e>-1&&(a.sqlKeyObj.keyList[e].value=i.data[t])}));case 10:return n=this.sqlKeyObj.keyList.some((function(t){return""===t.value})),this.sqlKeyObj.keyList.forEach((function(t,n){t.value||a.redKey.push(t.key);var r=a.sqlKeyObj.regRes.find((function(e){return e.slice(2,-2).trim()===t.key}));e=e.split(r).join(t.value)})),n&&this.$message({type:"warning",message:"请填写参数值"}),t.abrupt("return",{sql:e,nullType:n});case 14:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),editPosition:function(t){this.editPositionData=t},DataScanning:function(){var t=Pn(In().mark((function t(e){var n,r,i,a,o,s=this;return In().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.scanningLoading){t.next=2;break}return t.abrupt("return");case 2:if(n="",this.engine?this.querySql||(n="请先输入SQL!"):n="请先选择引擎!",!n){t.next=7;break}return this.$message({type:"warning",message:n}),t.abrupt("return");case 7:return this.scanningLoading=!0,r=this.$refs.monaco.getSelection(),i=r||this.querySql,t.next=12,this.farmatSqlFn(i);case 12:if(a=t.sent,!a.nullType){t.next=15;break}return t.abrupt("return");case 15:o={uuid:Object(kn["a"])(),engine:this.engine,querySql:a.sql},Object(u["x"])(o).then((function(t){s.scanningStatus=t.data.scanSize})).catch((function(){s.scanningStatus="err"}));case 17:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),shareBtn:function(){var t,e=Object(U["getFormatUrl"])("uuid",this.uuid,location.hash);this.shareUrl=e,null==(t=this.$refs.shareDialog)||t.open()},dragEagle:function(t){var e=this,n=this.$refs.sqlBox;this.offsetHeight=n.offsetHeight,this.startY=t.clientY,document.addEventListener("mousemove",this.moveHandler),document.addEventListener("mouseup",(function(){document.removeEventListener("mousemove",e.moveHandler)}))},moveHandler:function(t){if(t.preventDefault(),!(t.clientY<=200)){var e=document.documentElement.clientHeight;if(!(e-t.clientY<=40)){var n=t.clientY-this.startY,r=this.offsetHeight+n;r>document.documentElement.clientHeight+200||r<200||(this.height=r)}}},switchFullscreen:function(){this.fullscreen=!this.fullscreen,this.changeWidth(!this.fullscreen)},changeAIsqlType:function(t,e){var n=this;if(t!==this.AIsqlType){if(this.AIsqlType=t,this.AIsqlType){var r,i,a={},o="init"===e?1:2;if(2===o)a.msg=(null==(r=this.data)||null==(i=r.result)?void 0:i.message)||"",a.sql=this.querySql;this.$nextTick((function(){var t;null==(t=n.$refs.AIsql)||t.init(o,a)}))}}else t&&"error"===e&&this.$nextTick((function(){var t,e,r,i={msg:(null==(t=n.data)||null==(e=t.result)?void 0:e.message)||"",sql:n.querySql};null==(r=n.$refs.AIsql)||r.init(2,i)}))},formatSql:function(){if(3===this.data.grade)return this.$message.warning("该查询你只有查看权限");this.$refs.monaco.formatSql()},execute:function(){var t=Pn(In().mark((function t(e,n){var r,i,a,o,s,l,u,c,f,h,p,d,m=this;return In().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(this.transfEditorType&&(this.transfEditorType=!1),3!==this.data.grade){t.next=3;break}return t.abrupt("return",this.$message.warning("该查询你只有查看权限"));case 3:if(!this.running){t.next=5;break}return t.abrupt("return");case 5:if(i="",this.engine?this.catalog?this.querySql?this.engineList.length>0&&!this.engineList.some((function(t){return t.value===m.engine}))&&(i="请切换引擎或数据源!"):i="请先输入SQL!":i="请先选择数据源!":i="请先选择引擎!",!i){t.next=10;break}return this.$message({type:"warning",message:i}),t.abrupt("return");case 10:return a=this.$refs.monaco.getSelection(),o=a||this.querySql,t.next=14,this.farmatSqlFn(o);case 14:if(s=t.sent,!s.nullType){t.next=17;break}return t.abrupt("return");case 17:l=Object(It["e"])(s.sql),u={},this.sqlKeyObj.keyList.forEach((function(t){u[t.key]=t.value})),c=n||l,this.running=!0,this.showShare&&(this.showShare=!1),this.uuid=Object(kn["a"])(),f={name:this.data.name,uuid:this.uuid,engine:this.engine,catalog:this.catalog,database:Object(v["a"])("ds-query-database")||"",querySql:c,querySqlParam:Object.keys(u).length>0?o:"",param:u,region:this.region},h=Object(It["a"])(),p=null==(r=this.engine)?void 0:r.includes("spark"),(1===this.form.submited||1===this.data.submited||h)&&(f.confirmedSmart=1),p&&(f.confirmedSmart=0),this.$store.commit("SET_SQLLIST",{key:this.region,list:{engine:this.engine,running:!0,name:this.data.name,once:!0,status:3}}),this.initList(),this.$nextTick((function(){m.$set(m.result,"executeDuration",0),m.result.status=3,m.result.fileSize="",m.result.scanSize="",m.timer=setInterval((function(){m.result.executeDuration+=1}),1e3)})),Object(It["c"])(this.region,{name:this.data.name,title:this.data.title,querySql:this.querySql,uuid:this.uuid,engine:this.engine,catalog:this.catalog}),this.$nextTick((function(){m.engine.includes("hive")&&m.handelExecute()})),this.performance(f),this.engine.startsWith("presto")&&!this.engine.includes("huawei")&&(d=(new Date).getTime(),this.progressObj={startDate:d,loading:!0,step:1},this.$store.commit("SET_SQLOPTIONS",{region:this.region,name:this.data.name,key:"progressObj",value:{startDate:d,loading:!0,step:1}}),this.progressSetTime=setTimeout((function(){m.$set(m.progressObj,"endDate",(new Date).getTime()),m.progressFn()}),2e3));case 36:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}(),performance:function(t){var e=this;this.resultOption.toolList=void 0,this.executeType=!0,t.isDatabend=this.isDatabend?0:1,this.$store.dispatch("saveSqueryList",t).then((function(t){t.data;e.result=zn({executeDuration:e.result.executeDuration},t),e.engine.startsWith("mysql_")&&(clearInterval(e.timerInter),Object(u["Z"])({uuid:e.uuid}).then((function(n){0===n.data.ready?(t.fileSize=n.data.fileSize,e.$store.commit("SET_SQLLIST",{key:e.region,list:t})):e.timerInter=setInterval((function(){Object(u["Z"])({uuid:e.uuid}).then((function(n){0===n.data.ready&&(clearInterval(e.timerInter),t.fileSize=n.data.fileSize,e.$store.commit("SET_SQLLIST",{key:e.region,list:t}))})).catch((function(t){console.log(t),clearInterval(e.timerInter)}))}),5e3)})).catch((function(t){console.log(t)}))),e.engine.startsWith("presto")&&(clearInterval(e.proGressTime),clearTimeout(e.progressSetTime),e.progressObj={loading:!1},e.$store.commit("SET_SQLOPTIONS",{region:e.region,name:e.data.name,key:"progressObj",value:{loading:!1}})),e.executeType=!1,e.isDatabend=!1,e.showShare=!0,e.running=!1,e.initList()})).catch((function(n){if(e.engine.startsWith("presto")&&(clearInterval(e.proGressTime),clearTimeout(e.progressSetTime),e.progressObj={loading:!1},e.$store.commit("SET_SQLOPTIONS",{region:e.region,name:e.data.name,key:"progressObj",value:{loading:!1}})),1001===n.data){Object(It["c"])(t.region,{name:e.data.name,uuid:""}),e.$store.commit("SET_SQLLIST",{key:t.region,list:{engine:t.engine,running:!0,name:e.data.name,once:!0,status:3}});var r=n.message.slice(n.message.lastIndexOf(":")+2);t.name=e.data.name,e.$set(e.smartEngineObj,"smartEngineType",!0),e.$set(e.smartEngineObj,"smartEngine",r),e.$set(e.smartEngineObj,"params",t),e.$store.commit("SET_SQLOPTIONS",{region:t.region,name:t.name,key:"smartEngineObj",value:{smartEngineType:!0,smartEngine:r,params:t}})}else e.result.status=1,e.result.codeStr=n.codeStr,e.result.message=n.message,403===n.data&&e.$alert(n.message,"提示(暂无数据权限)",{confirmButtonText:"去申请数据权限",callback:function(t){if("confirm"===t){if(n.errorZh){var r=n.errorZh.indexOf("："),i=n.errorZh.indexOf(" ");if(r>0){var a=n.errorZh.slice(r+1,i);return void window.open("".concat(e.$locationOrigin,"/meta/list?tableName=").concat(a))}}window.open("".concat(e.$locationOrigin,"/meta/list"))}}}),e.executeType=!1,e.isDatabend=!1,e.showShare=!0,e.running=!1,e.initList()})).finally((function(){sessionStorage.setItem("ds-historyTab-refresh",1),clearInterval(e.timer)}))},handelExecute:function(){var t;null==(t=this.$refs.result)||t.handelExecute()},smartEngineFn:function(t){var e=this;this.cpmType&&Object(It["f"])(this.cpmType),this.$set(this.result,"executeDuration",0),this.timer=setInterval((function(){e.result.executeDuration+=1}),1e3),this.smartEngineObj.smartEngineType=!1,this.$store.commit("SET_SQLOPTIONS",{region:this.smartEngineObj.params.region,name:this.smartEngineObj.params.name,key:"smartEngineObj",value:{smartEngineType:!1}}),t&&(this.retain=!0,setTimeout((function(){e.retain=!1}),200),this.engine=this.smartEngineObj.smartEngine);var n=t?this.smartEngineObj.smartEngine:this.smartEngineObj.params.engine;this.uuid=Object(kn["a"])();var r=zn(zn({},this.smartEngineObj.params),{},{engine:n,uuid:this.uuid,confirmedSmart:1});if(Object(It["c"])(r.region,{name:this.smartEngineObj.params.name,uuid:this.uuid,engine:n}),t&&this.$store.commit("SET_SQLLIST",{key:r.region,list:{engine:r.engine,running:!0,name:r.name,once:!0,status:3}}),r.engine.startsWith("presto")&&!this.engine.includes("huawei")){var i=(new Date).getTime();this.progressObj={startDate:i,loading:!0,step:1},this.$store.commit("SET_SQLOPTIONS",{region:r.region,name:r.name,key:"progressObj",value:{startDate:i,loading:!0,step:1}}),this.progressSetTime=setTimeout((function(){e.$set(e.progressObj,"endDate",(new Date).getTime()),e.progressFn()}),2e3)}this.performance(r)},cancel:function(){var t=this;if(this.uuid){if(this.isAccelerate){this.isAccelerate=!1,clearTimeout(this.accTime);var e={};return e.uuid=this.uuid,e.running=!1,e.engine=this.engine,e.once=!0,e.name=this.data.name,e.message="已取消",e.status=2,this.$store.commit("SET_SQLLIST",{key:this.region,list:e}),void this.initList()}Object(u["m"])(this.uuid).then((function(e){var n=e.data,r=t.sqlList[t.engine]||{},i=[];Object.keys(r).forEach((function(t){i.push(r[t].uuid)})),i.includes(t.uuid)||(n.uuid=t.uuid,n.running=!1,n.once=!0,n.engine=t.engine,n.name=t.data.name,t.timer&&clearTimeout(t.timer),t.$store.commit("SET_SQLLIST",{key:t.region,list:n}),t.$store.commit("SET_CANCELLEDlIST",{uuid:t.uuid,type:"add"}),t.showShare=!0,t.initList())}))}},save:function(){this.data.title.startsWith("query")||(this.form.title=this.data.title),this.dialogVisible=!0},openDialog:function(){this.$refs.saveMonaco.setCode(this.querySql)},closeDialog:function(){this.$refs.form.resetFields()},submit:function(t){var e=this;if(this.engineList.length>0&&!this.engineList.some((function(t){return t.value===e.engine})))this.$message({type:"warning",message:"请切换引擎或数据源"});else{var n={};this.sqlKeyObj.keyList.forEach((function(t){n[t.key]=t.value}));var r=zn(zn({},this.form),{},{querySql:this.querySql,engine:this.engine,region:this.region,catalog:this.catalog,param:n});this.$refs.form.validate((function(n){n&&(e.form&&1===e.form.submited?"determine"===t?(r.id=e.form.id,Object(u["Ab"])(r).then((function(t){e.$message({type:"success",message:"保存成功"}),Object(It["c"])(e.region,{name:e.data.name,title:e.form.title}),e.data.title=e.form.title}))):"saveAS"===t&&(delete r.id,Object(u["a"])(r).then((function(t){e.$message({type:"success",message:"保存成功"}),Object(It["c"])(e.region,{name:e.data.name,title:e.form.title}),e.data.title=e.form.title}))):Object(u["a"])(r).then((function(t){e.$message({type:"success",message:"保存成功"}),Object(It["c"])(e.region,{name:e.data.name,title:e.form.title}),e.data.title=e.form.title})),e.dialogVisible=!1,sessionStorage.setItem("ds-saveTab-refresh",1))}))}},insertContent:function(t){this.$refs.monaco.insertContent(t)},changeData:function(t){var e=this;this.form=t;var n=t.querySqlParam||t.querySql;this.$refs.monaco.setCode(n);var r=t.catalog||"";r&&this.SET_CATALOG(r),t.grade&&Object(It["c"])(this.region,{name:this.data.name,grade:t.grade}),this.$nextTick((function(){e.engine=t.engine}));var i={name:this.data.name,title:this.data.title,querySql:t.querySql,engine:t.engine||this.engine};if(t.uuid&&(i.uuid=t.uuid),t.catalog&&(i.catalog=t.catalog),Object(It["c"])(this.region,i),t.uuid)this.resultOption.toolList=void 0,this.retain=!0,setTimeout((function(){e.retain=!1}),500),t.path&&(this.apiHistoryForm=t,this.apiPathShow=!0),clearInterval(this.timer),this.uuid=t.uuid,this.running=!0,this.$store.commit("SET_SQLLIST",{key:this.region,list:{engine:t.engine||this.engine,status:3,name:this.data.name,once:!0,running:!0}}),this.initList(),this.$nextTick((function(){e.$set(e.result,"executeDuration",0),e.timer=setInterval((function(){e.result.executeDuration+=1}),1e3)})),Object(u["W"])(this.uuid).then((function(n){var r,i=n.data;if(3!==i.status){if(clearInterval(e.timer),e.running=!1,e.result=zn({executeDuration:e.result.executeDuration},i),i.name=e.data.name,i.once=!0,i.running=!1,i.param&&Object.keys(i.param).length>0){var a=[];Object.keys(i.param).forEach((function(t){a.push({key:t,value:i.param[t]})})),i.keyList=a}return e.$store.commit("SET_SQLLIST",{key:e.region,list:i}),e.showShare=!0,void e.initList()}if(t.engine.startsWith("presto")&&!e.engine.includes("huawei")){var o=(new Date).getTime();e.progressObj={startDate:o,loading:!0,step:1},e.$store.commit("SET_SQLOPTIONS",{region:e.region,name:e.data.name,key:"progressObj",value:{startDate:o,loading:!0,step:1}}),e.progressSetTime=setTimeout((function(){e.$set(e.progressObj,"endDate",(new Date).getTime()),e.progressFn()}),2e3)}null!=(r=t.engine)&&r.includes("hive")&&e.handelExecute(),e.timerTow=setInterval((function(){Object(u["W"])(e.uuid).then((function(t){var n=t.data;if(3!==n.status){if(clearInterval(e.timer),clearInterval(e.timerTow),e.running=!1,3!==e.result.status)return;if(e.result=zn({executeDuration:e.result.executeDuration},n),n.name=e.data.name,n.once=!0,n.running=!1,n.param&&Object.keys(n.param).length>0){var r=[];Object.keys(n.param).forEach((function(t){r.push({key:t,value:n.param[t]})})),n.keyList=r}e.$store.commit("SET_SQLLIST",{key:e.region,list:n}),e.showShare=!0,e.initList()}})).catch((function(){clearInterval(e.timer),clearInterval(e.timerTow)}))}),8e3)})).catch((function(t){clearInterval(e.timer),clearInterval(e.timerTow);var n={status:1};n.message=t.message||"查询出错",e.running=!1,e.result=zn({executeDuration:e.result.executeDuration},n),n.name=e.data.name,n.once=!0,n.engine=e.engine,n.running=!1,e.$store.commit("SET_SQLLIST",{key:e.region,list:n}),Object(It["c"])(e.region,{name:e.data.name,title:e.data.title,querySql:n.querySql,uuid:n.uuid,engine:n.engine}),e.showShare=!0,e.initList()}));else{this.form.submited=1,Object(It["c"])(this.region,{name:this.data.name,submited:1}),t.folderID&&(this.form.folderName=Rn(this.folderList,this.defaultProps["children"],t.folderID)),this.data.status=0;var a=t.param?t.param:{};if(Object.keys(a).length>0){var o=[];Object.keys(a).forEach((function(t){o.push({key:t,value:a[t]})})),this.sqlKeyObj.keyList=o}}}})},Un=Hn,Yn=(n("c9f8"),n("0703"),Object(N["a"])(Un,P,B,!1,null,"2b012723",null)),Vn=Yn.exports,Kn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tableContext"},[n("el-drawer",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{visible:t.drawer,direction:t.direction,"before-close":t.handleClose,size:"650px","element-loading-text":"创建中....","wrapper-closable":!1,"element-loading-spinner":"el-icon-loading","close-on-press-escape":!1},scopedSlots:t._u([{key:"title",fn:function(){return[n("div",{staticClass:"title"},[n("span",[t._v("\n          创建临时表\n          "),n("el-tooltip",{attrs:{placement:"left"},scopedSlots:t._u([{key:"content",fn:function(){return[t._v("\n              1.'创建临时表'可以帮助用户创建数据表并将本地的数据上传至存储服务器,进而完成查询任务"),n("br"),t._v("\n              2.用户创建的临时表会根据区域进行存储,例:用户在Presto AWS美东创建的临时表,那么只要是带有'AWS美东'区域的引擎下面就可以查找到此临时表"),n("br"),t._v("\n              3.创建的临时表默认存放到temp_database数据库中"),n("br"),t._v("\n              4.对于已创建的临时表,支持通过sql语句进行编辑修改和删除\n            ")]},proxy:!0}])},[t._v(" "),n("svg-icon",{staticClass:"svg_help",staticStyle:{"vertical-align":"middle","margin-top":"-3px"},attrs:{"icon-class":"help"}})],1)],1)])]},proxy:!0}])},[t._v(" "),n("div",{staticClass:"main"},[n("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"110px"}},[n("el-collapse",{model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[n("el-collapse-item",{attrs:{name:"1"}},[n("template",{slot:"title"},[t._v("\n              基础信息\n              "),n("span",{staticClass:"line"})]),t._v(" "),n("el-form-item",{attrs:{label:"区域: "}},[n("span",[t._v(t._s(t.regionName))]),t._v(" "),n("p",{staticClass:"tipsClass",staticStyle:{"margin-bottom":"-14px","margin-top":"-10px"}},[t._v('系统会根据"区域"创建临时表,带有此"区域"的引擎下 都会创建此临时表')])]),t._v(" "),n("el-form-item",{attrs:{label:"数据库: "}},[n("span",[t._v("temp_database "),n("span",{staticClass:"tipsClass"},[t._v("(创建的临时表默认存放到此数据库中)")])])]),t._v(" "),n("el-form-item",{attrs:{label:"数据表: ",prop:"tableName"}},[n("el-input",{staticStyle:{width:"320px"},attrs:{placeholder:"支持英文、数字以及下划线,不能以下划线开头"},model:{value:t.ruleForm.tableName,callback:function(e){t.$set(t.ruleForm,"tableName",e)},expression:"ruleForm.tableName"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"数据格式: "}},[n("el-select",{model:{value:t.ruleForm.storeFormat,callback:function(e){t.$set(t.ruleForm,"storeFormat",e)},expression:"ruleForm.storeFormat"}},[n("el-option",{attrs:{label:"CSV",value:"csv"}})],1)],1),t._v(" "),n("el-form-item",{attrs:{label:"存储时长: "}},[n("el-select",{model:{value:t.ruleForm.lifeCycle,callback:function(e){t.$set(t.ruleForm,"lifeCycle",e)},expression:"ruleForm.lifeCycle"}},t._l(t.lifeCycleList,(function(t,e){return n("el-option",{key:e,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),n("el-form-item",{attrs:{label:"描述: ",prop:"comment"}},[n("el-input",{attrs:{type:"textarea",maxlength:"256",rows:"3","show-word-limit":""},model:{value:t.ruleForm.comment,callback:function(e){t.$set(t.ruleForm,"comment",e)},expression:"ruleForm.comment"}})],1)],2),t._v(" "),n("el-collapse-item",{staticClass:"collapse",attrs:{name:"2"}},[n("template",{slot:"title"},[t._v("\n              上传数据\n              "),n("span",{staticClass:"line"})]),t._v(" "),n("p",{staticClass:"tipsClass"},[t._v("    上传数据,可以帮助用户解析表结构并完成数据存储,数据将存放到系统默认的目录中")]),t._v(" "),n("el-form-item",{staticClass:"upload",attrs:{prop:"field"},scopedSlots:t._u([{key:"label",fn:function(){return[n("span",[t._v("\n                  选择文件\n                  "),n("el-tooltip",{attrs:{content:"上传数据前,请您确保单元格中不存在回车换行,否则建表之后,会出现数据乱行的情况",placement:"top-start"}},[n("svg-icon",{staticClass:"svg_help",staticStyle:{"vertical-align":"middle","margin-top":"-3px"},attrs:{"icon-class":"help"}})],1),t._v("\n                  :\n                ")],1)]},proxy:!0}])},[t._v(" "),n("el-upload",{ref:"rebateUpload",staticClass:"upload-demo",attrs:{action:"",accept:t.accept,"on-remove":t.fileRemove,limit:1,"file-list":t.ruleForm.field,"on-exceed":t.fileExceed,"on-change":t.fileChange,"auto-upload":!1}},[n("el-button",{attrs:{size:"mini",type:"primary"}},[t._v("点击上传")]),t._v(" "),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("仅支持上传 .csv 文件格式的数据,上传数据量最大为50MB")])],1)],1),t._v(" "),n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:t.running&&t.percentage>0,expression:"running && percentage > 0"}],attrs:{label:t.percentageText+": ",prop:"desc"}},[n("el-progress",{staticStyle:{"margin-top":"8px"},attrs:{percentage:t.percentage}})],1)],2),t._v(" "),n("el-collapse-item",{staticClass:"collapse",attrs:{name:"3"}},[n("template",{staticClass:"title",slot:"title"},[n("span",[t._v("数据表结构")]),t._v(" "),n("span",{staticClass:"line"})]),t._v(" "),n("p",{staticClass:"tipsClass"},[t._v("    解析出来的表结构,字段类型默认显示为string,需要用户调整为正确的字段类型")]),t._v(" "),n("el-table",{staticStyle:{width:"100%"},attrs:{data:t.ruleForm.meta,border:""}},[n("el-table-column",{attrs:{label:"字段名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-form-item",{attrs:{prop:"meta."+e.$index+".name",rules:[{pattern:/^(?!_)[a-zA-Z0-9(?_)]+$/,message:"英文、数字、下划线,不能以下画线开头",trigger:"change"}]}},[n("el-input",{model:{value:e.row.name,callback:function(n){t.$set(e.row,"name",n)},expression:"scope.row.name"}})],1)]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"type",label:"字段类型"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-select",{staticStyle:{width:"100%"},model:{value:e.row.type,callback:function(n){t.$set(e.row,"type",n)},expression:"scope.row.type"}},t._l(t.options,(function(t,e){return n("el-option",{key:e,attrs:{label:t.label,value:t.value}})})),1)]}}])})],1)],2)],1)],1),t._v(" "),n("div",{staticClass:"btnClass"},[n("div",{staticClass:"btn"},[n("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("确 定")]),t._v(" "),n("el-button",{on:{click:t.clearDrawer}},[t._v("取 消")])],1)])],1)])],1)},Wn=[];function Xn(t){return Xn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xn(t)}function Jn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Zn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Jn(Object(n),!0).forEach((function(e){tr(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Jn(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function tr(t,e,n){return e=er(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function er(t){var e=nr(t,"string");return"symbol"===Xn(e)?e:String(e)}function nr(t,e){if("object"!==Xn(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Xn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var rr={name:"TemporaryTable",props:{direction:{type:String,default:"rtl"},drawer:{type:Boolean,default:!1}},data:function(){var t=this,e=function(e,n,r){var i={database:t.ruleForm.database,engine:"",region:t.region,catalog:t.catalog,tableName:n};Object(u["sb"])(i).then((function(t){"0"===t.data?r():"1"===t.data&&r(new Error("表名重复，请更换"))})).catch((function(){}))},n=function(e,n,r){t.ruleForm.field.length<=0&&r(new Error("请选择上传文件")),r()};return{percentage:0,percentageStatus:0,loading:!1,running:!1,cancelFileType:!1,activeNames:["1","2","3"],ruleForm:{database:"temp_database",tableName:"",lifeCycle:1,comment:"",storeFormat:"csv",field:[],location:"",meta:[]},rules:{tableName:[{required:!0,message:"请输入表名称",trigger:"blur"},{pattern:/^(?!_)[a-zA-Z0-9_]+$/,message:"仅支持英文、数字、以及下划线,不能以下画线开头的格式",trigger:"blur"},{validator:e,trigger:"blur"}],field:[{required:!0,validator:n,trigger:"change"}]},lifeCycleList:[{value:1,label:"一个月"},{value:3,label:"三个月"},{value:6,label:"六个月"}],options:[{label:"string",value:"string"},{label:"tinyint",value:"tinyint"},{label:"smallint",value:"smallint"},{label:"int",value:"int"},{label:"bigint",value:"bigint"},{label:"boolean",value:"boolean"},{label:"float",value:"float"},{label:"double",value:"double"},{label:"decimal(20,4)",value:"decimal(20,4)"}]}},computed:Zn(Zn({},Object(f["c"])(["engineList","regionList","region","catalog"])),{},{accept:function(){return".csv"},percentageText:function(){return["初始化状态","正在上传","已取消","已完成"][this.percentageStatus]},regionName:function(){var t=this;if(this.regionList.length>0){var e,n=null==(e=this.regionList.find((function(e){return e.name===t.region})))?void 0:e.name_zh;return n}return""}}),methods:{submit:function(){var t=this;this.$refs.ruleForm.validate((function(e,n){var r=Object.keys(n).some((function(t){return t.includes("meta")}));if(r&&t.$message({type:"warning",message:"字段名称仅支持英文、数字、以及下划线,不能以下画线开头的格式"}),e){if(t.cancelFileType)return void t.$message({type:"warning",message:"请重新上传文件"});t.loading=!0;var i={engine:"",region:t.region,catalog:t.catalog,database:t.ruleForm.database,tableName:t.ruleForm.tableName,comment:t.ruleForm.comment,location:t.ruleForm.location,meta:t.ruleForm.meta};Object(u["v"])(i).then((function(e){t.clearDrawer(),t.loading=!1,t.$parent.refreshConfig(),t.$message({type:"success",message:'您创建的数据表存储到了"'.concat(t.regionName,'"区域>temp_database中')})})).catch((function(){t.loading=!1}))}}))},cancelFile:function(){this.cancel&&this.cancel(),this.$message({type:"warning",message:"已取消,重新上传文件的话请先删除当前文件",duration:4e3}),this.cancelFileType=!0},fileChange:function(t,e){var n=this,r=this,i=p.a.CancelToken,a=this.beforeAvatarUpload(t);if(a||(this.ruleForm.field=e.splice(e.length-1,1)),a){this.ruleForm.field=e,this.$refs.ruleForm.validateField("field"),this.running=!0;var o=new FormData,s={headers:{"Content-Type":"multipart/form-data;"},timeout:6e5,cancelToken:new i((function(t){r.cancel=t})),onUploadProgress:function(t){n.onUploadProgress(t)}},l={lifeCycle:this.ruleForm.lifeCycle,engine_key:"",region:this.region,catalog:this.catalog,storeFormat:this.ruleForm.storeFormat,file:t.raw};Object.keys(l).forEach((function(t){o.append(t,l[t])})),Object(u["Fb"])(o,s).then((function(t){n.percentage=100,n.percentageStatus=3,n.ruleForm.meta=t.data.meta,n.ruleForm.location=t.data.location,n.cancelFileType=!1})).catch((function(){n.percentageStatus=2,n.cancelFileType=!0}))}},onUploadProgress:function(t){if(t&&t.lengthComputable){var e=Math.round(t.total/1024/1024);if(e<=1){var n=Math.round(t.loaded/t.total*100);this.percentage=n>99?99:n}else{var r=Math.round(t.loaded/t.total*100);r=Math.round((51-e)/50*r),this.percentage=r>99?99:r}}},beforeAvatarUpload:function(t){this.percentageStatus=1;var e=t.size/1024/1024<50;return e||this.$message.warning("上传文件不能超过 50MB!"),e},fileExceed:function(t){var e=this;this.cancel&&this.cancel(),this.$refs["rebateUpload"].clearFiles(),this.ruleForm.meta=[],setTimeout((function(){e.percentageStatus=1})),this.percentage=0,this.$set(this.ruleForm.field[0],"raw",t[0]),this.$set(this.ruleForm.field[0],"name",t[0].name),this.$set(this.ruleForm.field[0],"size",t[0].size),this.$set(this.ruleForm.field[0],"status","ready"),this.$set(this.ruleForm.field[0],"percentage",0),this.$set(this.ruleForm.field[0],"uid",t[0].uid),this.$refs["rebateUpload"].handleStart(t[0])},fileRemove:function(t,e){this.cancel&&this.cancel(),this.percentageStatus=0,this.percentage=0,this.running=!1,this.ruleForm.meta=[],this.ruleForm.field=e,this.$refs.ruleForm.validateField("field")},handleClose:function(t){this.clearDrawer(),t()},clearDrawer:function(){this.cancel&&this.cancel(),this.percentageStatus=0,this.running=!1,this.cancelFileType=!1,this.ruleForm.database="temp_database",this.ruleForm.tableName="",this.ruleForm.lifeCycle=1,this.ruleForm.storeFormat="csv",this.ruleForm.comment="",this.ruleForm.field=[],this.ruleForm.location="",this.ruleForm.meta=[],this.$refs.ruleForm.clearValidate(),this.$emit("update:drawer",!1)}}},ir=rr,ar=(n("764e"),Object(N["a"])(ir,Kn,Wn,!1,null,"286f2e82",null)),or=ar.exports,sr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrap_metadata"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.value,expression:"value"}],staticClass:"content",style:{width:t.width+"px"}},[n("i",{staticClass:"el-icon-close close_icon",on:{click:function(e){return t.update(!1)}}}),t._v(" "),n("el-tabs",{ref:"metadataTabs",staticClass:"metadataTabs",attrs:{closable:"",type:"card"},on:{"tab-remove":t.removeTab},model:{value:t.activeTable,callback:function(e){t.activeTable=e},expression:"activeTable"}},t._l(t.metaDataList,(function(e,r){return n("el-tab-pane",{key:e.table+e.database,staticClass:"tableTabs",attrs:{label:e.table,name:e.table+e.database}},[n("div",{staticClass:"title"},[n("svg-icon",{staticClass:"icon",attrs:{"icon-class":"table"}}),t._v(" "),n("span",{staticClass:"name ellipsis"},[t._v(t._s(e.table))]),t._v(" "),"$"!==e.owner?n("span",{staticClass:"owner"},[n("i",{staticClass:"el-icon-user"}),t._v(" "),n("span",{staticClass:"owner_name"},[t._v(t._s(e.owner))])]):t._e()],1),t._v(" "),n("el-tabs",{key:"0",staticClass:"tableDiatal",attrs:{type:"card"},on:{"tab-click":function(n){return t.handleClick(n,e,r)}},model:{value:e.type,callback:function(n){t.$set(e,"type",n)},expression:"item.type"}},[n("el-tooltip",{directives:[{name:"show",rawName:"v-show",value:"first"===e.type,expression:"item.type === 'first'"}],staticClass:"title_tips",attrs:{effect:"dark",placement:"bottom"},scopedSlots:t._u([{key:"content",fn:function(){return[t._v("\n              "+t._s("点击此按钮，可刷新元数据信息")+"\n            ")]},proxy:!0}],null,!0)},[t._v(" "),n("i",{class:[e.refreshing||e.metaLoading?"el-icon-loading":"el-icon-refresh"],on:{click:function(n){return t.clearTableCache(e,r)}}})]),t._v(" "),n("el-tab-pane",{attrs:{label:"元数据信息",name:"first"}},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.metaLoading,expression:"item.metaLoading"}],staticClass:"box_table",staticStyle:{width:"100%"},attrs:{data:e.metaData,stripe:""}},[n("el-table-column",{attrs:{label:"字段名","min-width":"120","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(r){return[n("el-button",{staticClass:"ellipsis cloumnClass",attrs:{type:"text"},on:{click:function(n){return t.setSql(e,r.row.columnName)}}},[t._v(t._s(r.row.columnName))])]}}],null,!0)}),t._v(" "),n("el-table-column",{attrs:{prop:"columnType",label:"字段类型","min-width":"120","show-overflow-tooltip":""}}),t._v(" "),n("el-table-column",{attrs:{prop:"columnComment",label:"字段描述","min-width":"130","show-overflow-tooltip":""}})],1)],1),t._v(" "),"hive"===e.catalog?n("el-tab-pane",{attrs:{label:"数据预览",name:"second"}},[e.viewData&&e.viewData.length>0?n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.viewLoading,expression:"item.viewLoading"}],staticClass:"box_table",staticStyle:{width:"100%"},attrs:{data:e.viewData,stripe:""}},t._l(e.viewData[0],(function(t,e){return n("el-table-column",{key:e,attrs:{prop:e,label:e,"min-width":"120","show-overflow-tooltip":""}})})),1):n("el-empty",{attrs:{description:"暂无数据"}})],1):t._e()],1)],1)})),1)],1)])},lr=[];function ur(t){return ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ur(t)}function cr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function fr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?cr(Object(n),!0).forEach((function(e){hr(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):cr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function hr(t,e,n){return e=pr(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pr(t){var e=dr(t,"string");return"symbol"===ur(e)?e:String(e)}function dr(t,e){if("object"!==ur(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==ur(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var mr={name:"MetadataView",props:{value:{type:Boolean,default:!1},width:{type:Number,default:0},region:{type:String,default:""}},data:function(){return{activeTable:"",metaDataList:[],menuRegion:{aws_ue1:"ue1",aws_sg:"sg1",huawei_sg:"sg2"}}},computed:fr({},Object(f["c"])(["metaData"])),watch:{region:function(t,e){var n=this;this.SET_METADATA({region:e,resultData:this.metaDataList}),this.$nextTick((function(){n.metaDataList=[];var e=n.metaData[t]||[];n.metaDataList=e,n.resetGetData(n.metaDataList)}))},activeTable:function(){this.SET_METADATA({region:this.region,resultData:this.metaDataList})}},created:function(){var t=this.metaData[this.region]||[];this.metaDataList=t,this.resetGetData(this.metaDataList)},methods:fr(fr({},Object(f["d"])(["SET_METADATA"])),{},{clearTableCache:function(t,e){var n=this;this.$set(t,"refreshing",!0);var r={engine:"",catalog:t.catalog,region:t.region,database:t.database,table:t.table};Object(u["r"])(r).then((function(r){0===r.code&&(n.getCols(t,e),n.getTableOwner(e))})).finally((function(){n.$set(t,"refreshing",!1)}))},resetGetData:function(t){var e=this;t.forEach((function(t,n){t.metaLoading&&e.getCols(t,n),t.viewLoading&&e.getData(t)}))},resetData:function(){this.metaDataList=[]},setSql:function(t,e){var n="select ".concat(e," from ").concat(t.database,".").concat(t.table," ");this.$parent.setSql(n)},removeTab:function(t){var e=this.metaDataList.findIndex((function(e){return e.table+e.database===t}));this.metaDataList.splice(e,1),0!==this.metaDataList.length?e<this.metaDataList.length?this.activeTable=this.metaDataList[e].table+this.metaDataList[e].database:this.activeTable=this.metaDataList[e-1].table+this.metaDataList[e-1].database:this.update(!1)},addTabs:function(t){var e,n,r=this;t.region=this.region||"",this.metaDataList.forEach((function(r,i){r.table===t.table&&r.database===t.database&&(e=r,n=i)})),e?(e.owner||this.getTableOwner(n),e.type=e.type?e.type:"first"):(t.type="first",this.metaDataList.length>=5?(this.$message.warning("最多展示5个数据表信息，此次查看将替换第1个数据表信息"),this.metaDataList.pop(),this.metaDataList.unshift(t),this.getTableOwner(0),this.getCols(t,0)):(this.metaDataList.push(t),this.getTableOwner(this.metaDataList.length-1),this.getCols(t,this.metaDataList.length-1))),this.$nextTick((function(){r.activeTable=t.table+t.database}))},handleClick:function(t,e,n){this.metaDataList[n].type=t.name,"second"!==t.name||e.viewData||this.getData(e)},getCols:function(t,e){var n=this;this.$set(this.metaDataList[e],"metaLoading",!0);var r={engine:"",catalog:t.catalog,region:t.region,database:t.database,table:t.table};Object(u["lb"])(r).then((function(t){var r=t.data;n.$set(n.metaDataList[e],"metaData",r)})).finally((function(){n.$set(n.metaDataList[e],"metaLoading",!1)}))},getData:function(t){var e=this;if("hive"===t.catalog){this.$set(t,"viewLoading",!0);var n={region:this.menuRegion[t.region]||"",table:"".concat(t.database,".").concat(t.table)};Object(c["t"])(n).then((function(n){if(Array.isArray(n.data)){var r=n.data||[];e.$set(t,"viewData",r)}else e.$message.error(n.data),e.$set(t,"viewData",[])})).catch((function(){e.$set(t,"viewData",[])})).finally((function(){e.$set(t,"viewLoading",!1)}))}},getTableOwner:function(t){var e=this;if(["hive","iceberg"].includes(this.metaDataList[t].catalog)){var n={catalog:this.metaDataList[t].catalog,table:this.metaDataList[t].table,database:this.metaDataList[t].database,region:this.region};Object(u["nb"])(n).then((function(n){var r;0===n.code&&e.$set(e.metaDataList[t],"owner",(null==(r=n.data)?void 0:r[0])||"_")}))}else this.$set(this.metaDataList[t],"owner","$")},update:function(t){this.$emit("update",t)}})},gr=mr,vr=(n("6cf8"),Object(N["a"])(gr,sr,lr,!1,null,"3710a5aa",null)),br=vr.exports;function yr(t){return yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yr(t)}function wr(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */wr=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var a=e&&e.prototype instanceof v?e:v,o=Object.create(a.prototype),s=new E(r||[]);return i(o,"_invoke",{value:S(t,n,s)}),o}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h="suspendedStart",p="suspendedYield",d="executing",m="completed",g={};function v(){}function b(){}function y(){}var w={};u(w,o,(function(){return this}));var _=Object.getPrototypeOf,k=_&&_(_(A([])));k&&k!==n&&r.call(k,o)&&(w=k);var D=y.prototype=v.prototype=Object.create(w);function x(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function n(i,a,o,s){var l=f(t[i],t,a);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==yr(c)&&r.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,o,s)}),(function(t){n("throw",t,o,s)})):e.resolve(c).then((function(t){u.value=t,o(u)}),(function(t){return n("throw",t,o,s)}))}s(l.arg)}var a;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return a=a?a.then(i,i):i()}})}function S(e,n,r){var i=h;return function(a,o){if(i===d)throw new Error("Generator is already running");if(i===m){if("throw"===a)throw o;return{value:t,done:!0}}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var l=O(s,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===h)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=d;var u=f(e,n,r);if("normal"===u.type){if(i=r.done?m:p,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=m,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var a=f(i,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,g;var o=a.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(yr(e)+" is not iterable")}return b.prototype=y,i(D,"constructor",{value:y,configurable:!0}),i(y,"constructor",{value:b,configurable:!0}),b.displayName=u(y,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u(t,l,"GeneratorFunction")),t.prototype=Object.create(D),t},e.awrap=function(t){return{__await:t}},x(C.prototype),u(C.prototype,s,(function(){return this})),e.AsyncIterator=C,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new C(c(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},x(D),u(D,l,"Generator"),u(D,o,(function(){return this})),u(D,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=A,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var l=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:A(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}function _r(t,e,n,r,i,a,o){try{var s=t[a](o),l=s.value}catch(u){return void n(u)}s.done?e(l):Promise.resolve(l).then(r,i)}function kr(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){_r(a,r,i,o,s,"next",t)}function s(t){_r(a,r,i,o,s,"throw",t)}o(void 0)}))}}function Dr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function xr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Dr(Object(n),!0).forEach((function(e){Cr(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Dr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Cr(t,e,n){return e=Sr(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sr(t){var e=Or(t,"string");return"symbol"===yr(e)?e:String(e)}function Or(t,e){if("object"!==yr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==yr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Lr=Object(kn["a"])(),Tr={components:{DataConfig:$,QueryTabItem:Vn,TemporaryTable:or,MetadataView:br},data:function(){return{regionCopy:Object(v["a"])("regionCopy")||"",drawer:!1,onceNum:!1,activeTabName:Lr,oldActiveTabName:"",queryList:[{name:Lr,title:"query1",grade:"",querySql:"",inputType:!1,uuid:"",result:{engine:"",executeDuration:0,fileSize:"",keyList:[{key:"",value:""}],meta:[],name:"",once:!1,param:{},queryId:"",querySql:"",querySqlParam:"",repeat_meta:{},result:[],running:!1,scanSize:"",status:null,uuid:""}}],leftWidth:16,offsetWidth:0,startX:0,addSaveDial:!1,saveList:[],saveListLoading:!1,total:0,params:{pageNum:1,pageSize:10,info:"",title:"",query_sql:""},mouseX:0,mouseY:0,addQuerySave:null,visible:!1,debounce:!1,metaDateWidth:400}},computed:xr(xr({},Object(f["c"])(["engineList","sqlList","region","regionList","userInfo","catalog","catalogList"])),{},{rightWidth:function(){var t=this.leftWidth+"%";return"calc(100% - ".concat(t).concat(this.visible?" - ".concat(this.metaDateWidth,"px"):"",")")}}),watch:{activeTabName:{handler:function(t,e){this.oldActiveTabName=e,this.changeactiveTabName(t)},immediate:!0},region:function(t,e){var n=this;if(this.visible=!1,e){var r=JSON.parse(Object(v["a"])("ds-query-sql-".concat(e)))||[];r.forEach((function(t){var r=n.oldActiveTabName===t.name?1:0;Object(It["c"])(e,{name:t.name,active:r})}))}this.sqlList[t]||this.setQueryStatus(),this.initSqlList(),this.$nextTick((function(){n.activeTabName&&(n.$refs[n.activeTabName][0].retain=!0,setTimeout((function(){n.$refs[n.activeTabName][0].retain=!1}),800))}))}},provide:function(){var t=this;return{initList:this.initList,changeWidth:this.changeWidth,visible:function(){return t.visible},positionTable:this.positionTable}},created:function(){var t=kr(wr().mark((function t(){var e,n,r,i,a,o=this;return wr().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.getRegionList();case 2:if(this.regionCopy||(this.regionCopy=null==(e=this.regionList[0])?void 0:e.name,Object(v["c"])("regionCopy",this.regionCopy),this.SET_REGION(this.regionCopy)),n=document.documentElement.clientWidth||document.body.clientWidth,n<1300&&(this.leftWidth=20),this.initSqlList(),!this.$route.query.uuid&&!this.$route.query.sqlId){t.next=24;break}if(this.onceNum=!0,r=function(t,e){if(o.region===t.region){if(o.queryList.length>=15)o.$message.warning({message:"最多添加15个查询窗口!"}),t.name=o.queryList[0].name;else if(1===o.queryList.length&&""===o.queryList[0].querySql)t.name=o.queryList[0].name;else{t.name=Object(kn["a"])();for(var n="",r=o.queryList.length+1;;){n="query".concat(r);var i=o.queryList.findIndex((function(t){return t.title===n}));if(i<=-1)break;r++}var a=t.querySql,s=t.param?t.param:{};Object.keys(s).length>0&&(a=t.querySqlParam||t.querySql,o.$nextTick((function(){var e=[];Object.keys(t.param).forEach((function(n){e.push({key:n,value:t.param[n]})})),o.$nextTick((function(){o.$refs[o.activeTabName][0].sqlKeyObj.keyList=e}))})));var l={name:t.name,title:n,querySql:a,engine:t.engine,catalog:t.catalog};"share"===e&&(l.uuid=o.$route.query.uuid),o.queryList.push(l),Object(It["c"])(o.region,l)}t.name===o.activeTabName&&o.$nextTick((function(){var e=t.querySql,n=t.param?t.param:{};Object.keys(n).length>0&&(e=t.querySqlParam||t.querySql,o.$nextTick((function(){var e=[];Object.keys(t.param).forEach((function(n){e.push({key:n,value:t.param[n]})})),o.$refs[o.activeTabName][0].sqlKeyObj.keyList=e}))),o.$refs[o.activeTabName][0].$refs.monaco.setCode(e)})),o.activeTabName=t.name,"share"===e&&o.$nextTick((function(){o.$refs[o.activeTabName][0].showShare=!0,o.$refs[o.activeTabName][0].uuid=o.$route.query.uuid,o.$refs[o.activeTabName][0].running=!0,o.$refs[o.activeTabName][0].result.executeDuration=0,o.timer=setInterval((function(){o.$refs[o.activeTabName][0].result.executeDuration+=1}),1e3)})),o.$nextTick((function(){o.$refs[o.activeTabName][0].engine=t.engine||"",Object(It["c"])(o.region,{name:t.name,grade:t.grade})}))}else o.regionChange(t.region),o.$nextTick((function(){if(o.queryList.length>=15)o.$message.warning({message:"最多添加15个查询窗口!"}),t.name=o.queryList[0].name;else if(1===o.queryList.length&&""===o.queryList[0].querySql)t.name=o.queryList[0].name;else{t.name=Object(kn["a"])();for(var n="",r=o.queryList.length+1;;){n="query".concat(r);var i=o.queryList.findIndex((function(t){return t.title===n}));if(i<=-1)break;r++}var a=t.querySql,s=t.param?t.param:{};Object.keys(s).length>0&&(a=t.querySqlParam||t.querySql,o.$nextTick((function(){var e=[];Object.keys(t.param).forEach((function(n){e.push({key:n,value:t.param[n]})})),o.$refs[o.activeTabName][0].sqlKeyObj.keyList=e})));var l={name:t.name,title:n,querySql:a,engine:t.engine,catalog:t.catalog};"share"===e&&(l.uuid=o.$route.query.uuid),o.queryList.push(l),Object(It["c"])(o.region,l)}t.name===o.activeTabName&&o.$nextTick((function(){var e=t.querySql,n=t.param?t.param:{};Object.keys(n).length>0&&(e=t.querySqlParam||t.querySql,o.$nextTick((function(){var e=[];Object.keys(t.param).forEach((function(n){e.push({key:n,value:t.param[n]})})),o.$refs[o.activeTabName][0].sqlKeyObj.keyList=e}))),o.$refs[o.activeTabName][0].$refs.monaco.setCode(e)})),o.activeTabName=t.name,"share"===e&&o.$nextTick((function(){o.$refs[o.activeTabName][0].showShare=!0,o.$refs[o.activeTabName][0].uuid=o.$route.query.uuid,o.$refs[o.activeTabName][0].running=!0,o.$refs[o.activeTabName][0].result.executeDuration=0,o.timer=setInterval((function(){o.$refs[o.activeTabName][0].result.executeDuration+=1}),1e3)})),o.$nextTick((function(){o.$refs[o.activeTabName][0].engine=t.engine||"",Object(It["c"])(o.region,{name:t.name,grade:t.grade})}))}));var u=t.catalog||"";u&&o.SET_CATALOG(u)},i={},t.prev=10,!this.$route.query.gradeID){t.next=17;break}return t.next=14,Object(u["ib"])({sharee:this.userInfo.userId,gradeID:this.$route.query.gradeID});case 14:return t.next=16,t.sent.data;case 16:i=t.sent;case 17:t.next=22;break;case 19:t.prev=19,t.t0=t["catch"](10),console.log(t.t0,"分享错误");case 22:this.$route.query.uuid&&(a=0,this.catalog&&this.region||(a=3e3),setTimeout((function(){Object(u["ab"])(o.$route.query.uuid).then((function(t){var e=t.data;e.grade=i.grade,r(e,"share");var n=JSON.parse(JSON.stringify(o.activeTabName));o.$store.commit("SET_SQLLIST",{key:o.region,list:{running:!0,status:3,name:n,once:!0}}),o.initList(),Object(u["W"])(o.$route.query.uuid).then((function(t){var e=t.data;e.name=n,e.running=!1,e.once=!0,o.$store.commit("SET_SQLLIST",{key:o.region,list:e}),o.initList(),o.$nextTick((function(){o.$refs[n][0].running=!1,o.$refs[n][0].result=e,clearInterval(o.timer)}))})),o.$route.query.BIID&&Object(u["S"])({id:o.$route.query.BIID}).then((function(t){var e=t.data[0];e.param=JSON.parse(e.param),e.param.form.id=e.id,e.param.form.querySql=e.querySql,e.param.form.content=e.content;var r=[{title:e.name,type:e.type,config:e.param,chartGrade:o.$route.query.chartGrade}];o.$refs[n][0].resultOption.toolList=r}))}))}),a)),this.$route.query.sqlId&&Object(u["hb"])(this.$route.query.sqlId).then((function(t){var e=t.data;e.grade=i,r(e,"save"),o.initList()}));case 24:g.$on(m.switchQueryTab,(function(t){if(t)if(t.region!==o.region)o.$confirm('从"已保存的查询"或者"历史查询"跳转至"数据查询"页面时，查询区域和当前区域不一致时，将关闭当前查询选项卡，未保存的查询将丢失，如有要保存的内容，请先保存！',"提示",{confirmButtonText:"切换",cancelButtonText:"取消"}).then((function(){o.regionChange(t.region),o.$nextTick((function(){if(o.queryList.length>=15)o.$confirm("您一次最多可以打开十五个查询,此查询将替换您的第一个查询选项卡,任何未保存的工作都将丢失。","提示",{confirmButtonText:"打开查询",cancelButtonText:"取消"}).then((function(){o.activeTabName=o.queryList[0].name,t.title&&(o.queryList[0].title=t.title,Object(It["c"])(o.region,{name:o.activeTabName,title:t.title})),o.$nextTick((function(){o.$refs[o.activeTabName][0].changeData(t)}))})).catch((function(){}));else{var e={};t.title&&(e.title=t.title),o.addTabExecute(e),o.$nextTick((function(){o.$refs[o.activeTabName][0].changeData(t)}))}}))})).catch((function(){}));else if(o.queryList.length>=15)o.$confirm("您一次最多可以打开十五个查询,此查询将替换您的第一个查询选项卡,任何未保存的工作都将丢失。","提示",{confirmButtonText:"打开查询",cancelButtonText:"取消"}).then((function(){o.activeTabName=o.queryList[0].name,t.title&&(o.queryList[0].title=t.title,Object(It["c"])(o.region,{name:o.activeTabName,title:t.title})),o.$nextTick((function(){o.$refs[o.activeTabName][0].changeData(t)}))})).catch((function(){}));else{var e={};t.title&&(e.title=t.title),o.addTabExecute(e),o.$nextTick((function(){o.$refs[o.activeTabName][0].changeData(t)}))}})),this.sqlList[this.region]||this.setQueryStatus();case 26:case"end":return t.stop()}}),t,this,[[10,19]])})));function e(){return t.apply(this,arguments)}return e}(),mounted:function(){document.addEventListener("click",this.mouseClick),document.body.onresize=function(){var t=document.documentElement.querySelector(".closeTabdropdownMenu");t&&(t.style.display="none")}},destroyed:function(){this.clearTimer(),document.removeEventListener("click",this.mouseClick),g.$off(m.switchQueryTab)},methods:xr(xr(xr({},Object(f["d"])(["SET_REGION","SET_CATALOG"])),Object(f["b"])(["getRegionList"])),{},{keyDownExecute:function(t){t&&this.$refs[t][0].execute()},setQueryStatus:function(){var t=this,e=this.queryList.map((function(t){var e=t.uuid,n=void 0!==e&&e;return n})).filter((function(t){return t}));0!==e.length&&Object(u["kb"])({uuidList:e}).then((function(e){var n=e.data||{};t.setStatus(n)}))},setStatus:function(t){var e=this;0!==Object.keys(t).length&&this.queryList.forEach((function(n,r){void 0!==t[n.uuid]&&(n.result=xr(xr({},n.result),{},{status:t[n.uuid]})||{status:t[n.uuid]},e.$set(e.queryList,r,xr({},n)),e.$store.commit("SET_SQLLIST",{key:e.region,list:{status:t[n.uuid],name:n.name}}))}))},positionTable:function(t){var e,n;t.table?null==(e=this.$refs.dataConfig)||e.refreshConfig("datas",t):null==(n=this.$refs.dataConfig)||n.tuckLockTable(t)},closeVisible:function(){var t;this.visible=!1,null==(t=this.$refs.MetadataView)||t.resetData()},lookMetadata:function(t){var e=this;setTimeout((function(){e.debounce||(e.visible=!0,e.$nextTick((function(){e.$refs.MetadataView.addTabs(t)})))}),500)},changeWidth:function(t){this.leftWidth=t?16:0},mouseClick:function(t){this.mouseX=t.pageX,this.mouseY=t.pageY},tableClick:function(t){var e=this;if(!(this.queryList.length>=15)&&"el-icon-plus"===t.target._prevClass){var n=document.documentElement.querySelector(".closeTabdropdown");n.click(),setTimeout((function(){var t=document.documentElement.querySelector(".closeTabdropdownMenu");t.style.top=e.mouseY+10+"px",t.style.left=e.mouseX-10+"px"}))}},handelInput:function(t){var e=Object(U["getStrByte"])(t.title,30);return e!==t.title?t.validMsg="中文限制15个字，英文30个字母":t.validMsg="",e},titleInputBlur:function(t){t.title.trim().length<=0?this.$message({type:"warning",message:"标题名称不能为空"}):(t.inputType=!1,Object(It["c"])(this.region,{name:t.name,title:t.title}))},addSaveSub:function(){var t,e=this;if(this.addQuerySave)if(this.queryList.length>=15)this.$message.warning({message:"最多添加15个查询窗口!"});else{var n=this.addQuerySave.engine||(null==(t=this.engineList[0])?void 0:t.value);this.addQuerySave.region!==this.region?this.$confirm("该查询区域和当前区域不一致时，将关闭当前查询选项卡，未保存的查询将丢失，如有要保存的内容，请先保存！","提示",{confirmButtonText:"切换",cancelButtonText:"取消"}).then((function(){e.regionChange(e.addQuerySave.region),e.$nextTick((function(){e.addTabExecute({querySql:e.addQuerySave.querySql,engine:n,title:e.addQuerySave.title})}))})).finally((function(){e.addQuerySave=null,e.addSaveDial=!1})):(this.addTabExecute({querySql:this.addQuerySave.querySql,engine:n,title:this.addQuerySave.title}),this.addQuerySave=null,this.addSaveDial=!1)}else this.addSaveDial=!1},saveDialClose:function(){this.addQuerySave=null,this.params.title="",this.params.query_sql=""},handleCurrentChange:function(t){this.params.pageNum=t,this.searchSaveList()},handleSizeChange:function(t){this.params.pageSize=t,this.searchSaveList()},searchSaveList:function(){var t=this;this.saveListLoading=!0;var e=xr({},this.params);Object(u["ub"])(e).then((function(e){var n=e.data;t.saveList=n.list||[],t.total=n.total||0})).finally((function(){t.saveListLoading=!1}))},addTabFn:function(t){if(this.queryList.length>=15)this.$message.warning({message:"最多添加15个查询窗口!"});else if("add"===t){var e,n=this.catalog||"";this.catalogList.includes(n)||(n=this.catalogList[0]);var r=(null==(e=this.engineList[0])?void 0:e.value)||"";this.addTabExecute({engine:r,catalog:n})}else if("save"===t){if(!this.region)return void this.$message.warning("请选择区域");this.addSaveDial=!0,this.searchSaveList()}},addTabExecute:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=Object(kn["a"])(),n="",r=JSON.parse(Object(v["a"])("ds-query-sql-".concat(this.region))),i=r?r.length+1:1,a=i;;){n="query".concat(a);var o=r.findIndex((function(t){return t.title===n}));if(o<=-1)break;a++}var s=Object.assign({name:e,title:n,engine:""},t);this.queryList.push(s),this.activeTabName=e,Object(It["c"])(this.region,s)},regionCopyChange:function(t){var e=this;this.region!==t&&this.$confirm("切换查询区域，将关闭其查询选项卡，未保存的查询将丢失，如有要保存的内容，请先保存！","提示",{confirmButtonText:"切换",cancelButtonText:"取消"}).then((function(){e.regionChange(t)})).catch((function(){e.regionCopy=e.region}))},regionChange:function(t){var e=this;this.regionCopy=t,Object(v["c"])("regionCopy",t),this.SET_REGION(t),this.initTabData(),this.changeactiveTabName(this.activeTabName),this.clearTimer();var n=this.sqlList[this.region];n&&Object.keys(n).forEach((function(t){e.$nextTick((function(){e.$refs[t]&&e.$refs[t][0]&&(e.$refs[t][0].showShare=!0)}))}))},refreshConfig:function(){this.$refs.dataConfig.refreshConfig()},changeDrawer:function(t){this.drawer=t},clearTimer:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"all";this.queryList.forEach((function(e){var n;"all"===t?(e.timer||e.timerTow)&&(clearInterval(e.timer),clearInterval(e.timerTow)):null!=(n=e.result)&&n.queryId&&(e.timer||e.timerTow)&&(clearInterval(e.timer),clearInterval(e.timerTow))}))},tabIcon:function(t){return 1===t.status?"err":2===t.status?"cancel":0===t.status?"succ":void 0},changeactiveTabName:function(t){this.initList(),this.refreshGetData(t)},refreshGetData:function(t){var e=this,n=this.queryList.findIndex((function(e){return e.name===t}));if(this.queryList.length>1&&0===n&&!0===this.onceNum)this.onceNum=!1;else{var r,i=n>-1?this.queryList[n].uuid:void 0,a=n>-1?this.queryList[n].catalog:void 0,o=n>-1?this.queryList[n].result:void 0,s=o?o.once:void 0;if(i&&!s)this.catalog!==a&&a&&this.SET_CATALOG(a),this.$nextTick((function(){r=e.$refs[t][0],clearInterval(r.timer1),r.result.status=3,r.uuid=i;var n=0;e.$set(r.result,"executeDuration",n),r.timer1=setInterval((function(){n+=1,r&&(r.result.executeDuration=n)}),1e3)})),this.$store.commit("SET_SQLLIST",{key:this.region,list:{running:!0,name:this.activeTabName,once:!0}}),this.initList(),Object(u["W"])(i).then((function(n){var a,o,s,l=n.data;if(3!==l.status){if(clearInterval(r.timer1),l.once=!0,l.name=t,l.running=!1,l.param&&Object.keys(l.param).length>0){var c=[];Object.keys(l.param).forEach((function(t){c.push({key:t,value:l.param[t]})})),l.keyList=c,r.$refs.monaco.setCode(l.querySqlParam)}return e.$store.commit("SET_SQLLIST",{key:e.region,list:l}),r.result=l,r.showShare=!0,r.uuid=i,r.running=!1,void e.initList()}if(l.engine.startsWith("presto")&&(null==(a=r)||!a.progressObj.tipInfo)&&!l.engine.includes("huawei")){var f,h=(new Date).getTime(),p=h+3e3;r.progressObj={startDate:h,loading:!0,step:1,endDate:p},e.$store.commit("SET_SQLOPTIONS",{region:l.region,name:e.activeTabName,key:"progressObj",value:{startDate:h,loading:!0,step:1,endDate:p}}),null==(f=r)||f.progressFn()}null!=(o=l.engine)&&o.includes("hive")&&(null==(s=r)||s.handelExecute()),r.timerTow=setInterval((function(){Object(u["W"])(i).then((function(n){var a=n.data;if(3!==a.status){if(clearInterval(r.timer1),clearInterval(r.timerTow),3!==r.result.status)return;if(a.once=!0,a.name=t,a.running=!1,a.param&&Object.keys(a.param).length>0){var o=[];Object.keys(a.param).forEach((function(t){o.push({key:t,value:a.param[t]})})),a.keyList=o,r.$refs.monaco.setCode(a.querySqlParam)}e.$store.commit("SET_SQLLIST",{key:e.region,list:a}),r.result=a,r.showShare=!0,r.uuid=i,r.running=!1,e.initList()}})).catch((function(){clearInterval(r.timer1),clearInterval(r.timerTow)}))}),8e3)})).catch((function(n){clearInterval(r.timer1),clearInterval(r.timerTow);var a={status:1};a.message=n.message||"查询出错",a.once=!0,a.name=t,a.running=!1,e.$store.commit("SET_SQLLIST",{key:e.region,list:a}),r.result=a,r.showShare=!0,r.uuid=i,r.running=!1,e.initList()}))}},initList:function(){var t=this.sqlList[this.region]||{},e=Object(v["a"])("ds-query-sql-".concat(this.region));if(e=e?JSON.parse(e):[],e.length>0)e.forEach((function(e,n){Object.keys(t).includes(e.name)&&(e.result=t[e.name]),e.inputType=!1})),this.queryList=e;else{var n={name:Lr,title:"query1",querySql:"",engine:""};this.queryList=[xr(xr({},n),{},{inputType:!1})],Object(It["c"])(this.region,n)}this.clearTimer("once")},initSqlList:function(){var t;this.initList();var e=(null==(t=this.queryList.find((function(t){return t.active})))?void 0:t.name)||this.queryList[0].name;this.activeTabName=e},dragEagle:function(t){var e=this,n=this.$refs.leftBox;this.offsetWidth=n.offsetWidth,this.startX=t.clientX,document.addEventListener("mousemove",this.moveHandler),document.addEventListener("mouseup",(function(){document.removeEventListener("mousemove",e.moveHandler)}))},moveHandler:function(t){t.preventDefault();var e=t.clientX-this.startX,n=this.offsetWidth+e;n<=0?n=0:n>=600&&(n=600);var r=n/this.$refs.queryTab.offsetWidth*100;this.leftWidth=r.toFixed(2)},initTabData:function(){this.queryList=[{name:Lr,title:"query1",querySql:""}],this.activeTabName=Lr},tabsEdit:function(t,e){if("remove"===e){if(this.queryList.length<=1)return;this.closeTab(t)}},openTab:function(t){this.activeTabName=t},closeTab:function(t){var e=this.queryList,n=this.activeTabName;n===t&&e.forEach((function(r,i){if(r.name===t){var a=e[i+1]||e[i-1];a&&(n=a.name)}})),this.activeTabName=n,this.queryList=e.filter((function(e){return e.name!==t})),Object(It["b"])(this.region,t),this.$store.commit("SET_SQLLIST",{key:this.region,list:{removeName:t}}),this.initList()},closeAll:function(){var t=this;this.$confirm("关闭所有选项卡将清除所有选项卡，包括尚未保存的查询。","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then((function(){t.initTabData(),Object(It["b"])(t.region),t.$store.commit("SET_SQLLIST",{key:t.region,list:void 0})})).catch((function(){}))},sqlCreateTable:function(t){this.$refs[this.activeTabName][0].insertContent("CREATE TABLE IF NOT EXISTS ".concat(t.db,".tableName (\n  name string COMMENT '名称',\n  id string COMMENT '唯一ID'\n) PARTITIONED BY (`dt` string) stored as parquet LOCATION 's3://XXX/XXXX/XX'"))},select:function(t,e,n){var r=this;this.debounce=!0,this.visible=!1,setTimeout((function(){r.debounce=!1}),2e3),"table"===t?this.$refs[this.activeTabName][0].insertContent("select * from ".concat(e,".").concat(n," limit 20")):"col"===t&&this.$refs[this.activeTabName][0].insertContent(n)},setSql:function(t){this.$refs[this.activeTabName][0].insertContent(t)}})},Er=Tr,Ar=(n("b615"),n("d665"),Object(N["a"])(Er,a,o,!1,null,"517bcdca",null)),jr=Ar.exports,Fr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"savedquery-box"},[n("div",{staticClass:"savedquery-content"},[n("div",{staticClass:"savedquery-left"},[t._m(0),t._v(" "),n("customTree",{ref:"customTree",attrs:{"tree-data":t.folderList,"default-props":t.defaultProps,options:t.treeOptions,"is-contextmenu":!0,"is-filter":!0,depth:3,"no-drag":t.noDrag},on:{moveFile:t.moveFile,delFile:t.delFile,resetFolderName:t.resetFolderName,addFile:t.addFile,"node-click":t.handelFolder}})],1),t._v(" "),n("div",{staticClass:"savedquery-right"},[n("div",{staticClass:"condition-box"},[n("div",{staticClass:"condition-search"},[n("div",{staticClass:"condition-item"},[n("span",{staticClass:"label"},[t._v("名称: ")]),t._v(" "),n("el-input",{staticClass:"condition-input",attrs:{placeholder:"请输入名称",clearable:"",size:"mini"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.params.title,callback:function(e){t.$set(t.params,"title",e)},expression:"params.title"}})],1),t._v(" "),n("div",{staticClass:"condition-item"},[n("span",{staticClass:"label"},[t._v("SQL: ")]),t._v(" "),n("el-input",{staticClass:"condition-input",attrs:{placeholder:"请输入sql",clearable:"",size:"mini"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.params.query_sql,callback:function(e){t.$set(t.params,"query_sql",e)},expression:"params.query_sql"}})],1),t._v(" "),n("div",{staticClass:"condition-item"},[n("span",{staticClass:"label"},[t._v("引擎: ")]),t._v(" "),n("el-select",{staticClass:"condition-input",attrs:{placeholder:"请选择引擎",clearable:"",size:"mini"},on:{change:t.search},model:{value:t.params.engine,callback:function(e){t.$set(t.params,"engine",e)},expression:"params.engine"}},t._l(t.engineListAll,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)]),t._v(" "),n("div",{staticClass:"reset_btn"},[n("el-button",{attrs:{size:"mini"},on:{click:t.resetSearch}},[t._v("重置")]),t._v(" "),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.search}},[t._v("查询")])],1)]),t._v(" "),n("div",{staticClass:"query-list"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticClass:"saveTable",staticStyle:{width:"100%"},attrs:{border:"",height:"calc(100vh - 192px)",data:t.list,"tooltip-effect":"dark table_overflow_tootip","cell-style":{padding:"0px",height:"36px"}},on:{"selection-change":t.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),n("el-table-column",{attrs:{label:"名称","min-width":"80","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{staticClass:"ellipsis saveName",attrs:{size:"mini",type:"text"},on:{click:function(n){return t.goQueryTab(e.row)}}},[t._v(t._s(e.row.title))])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"querySql",label:"查询","min-width":"550"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",disabled:t.isTipDisabled,content:r.querySql,placement:"bottom"}},[n("div",{staticClass:"ellipsis",on:{mouseenter:t.isShowTooltip}},[t._v(t._s(r.querySql))])])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"区域",width:"220","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(t.regionFormat(e.row.region)))])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"engineZh",label:"查询引擎",width:"180","show-overflow-tooltip":""}}),t._v(" "),n("el-table-column",{attrs:{prop:"description",label:"描述","min-width":"170","show-overflow-tooltip":""}}),t._v(" "),n("el-table-column",{attrs:{label:"操作",width:"120",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(n){return t.checkSql(e.row)}}},[t._v("查看")]),t._v(" "),n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(n){return t.shareBtn(e.row)}}},[t._v("分享")]),t._v(" "),n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(n){return t.moveQuery(e.row)}}},[t._v("移动")])]}}])})],1),t._v(" "),n("div",{staticClass:"footer"},[n("el-button",{attrs:{type:"danger",size:"mini",disabled:t.multipleSelection.length<=0,loading:t.deleting},on:{click:t.deleteHandler}},[t._v("删除")]),t._v(" "),n("el-pagination",{attrs:{background:"",total:t.total,"current-page":t.params.pageNum,"page-sizes":[10,20,30,50,100],"page-size":t.params.pageSize,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)])]),t._v(" "),n("el-dialog",{attrs:{width:"700px","close-on-click-modal":!1,visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e},opened:t.openDialog}},[n("div",{attrs:{slot:"title"},slot:"title"},[t._v("\n      SQL脚本"),n("span",{staticStyle:{color:"#909399"}},[t._v("(Query Engine: "+t._s(t.formatter(t.activeItem)||"-")+")")])]),t._v(" "),n("div",{staticStyle:{height:"350px"}},[n("monaco-editor",{ref:"showMonaco",attrs:{"read-only":!0,"render-line-highlight":"all","scroll-beyond-last-line":!1},model:{value:t.activeItem.querySql,callback:function(e){t.$set(t.activeItem,"querySql",e)},expression:"activeItem.querySql"}})],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("关闭")])],1)]),t._v(" "),n("el-dialog",{attrs:{width:"30%",title:"文件移动",visible:t.moveFileDialType},on:{"update:visible":function(e){t.moveFileDialType=e},close:t.moveClose}},[n("el-form",{ref:"moveFileForm",attrs:{"label-width":"80px",model:t.moveForm}},[n("el-form-item",{attrs:{label:"移动到 :",prop:"moveFileName",rules:[{required:!0,message:"请选择文件夹",trigger:"change"}]}},[n("el-select",{ref:"moveSelectTree",staticStyle:{width:"100%"},attrs:{placeholder:"请选择文件夹"},model:{value:t.moveForm.moveFileName,callback:function(e){t.$set(t.moveForm,"moveFileName",e)},expression:"moveForm.moveFileName"}},[n("el-option",{attrs:{hidden:"",value:""}}),t._v(" "),n("customTree",{attrs:{"tree-data":t.folderList,"default-props":t.defaultProps,"is-menu-icon":!1},on:{"node-click":t.handelClickMove}})],1)],1)],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.moveFileDialType=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:t.moveFilebtn}},[t._v("确 定")])],1)],1),t._v(" "),n("shareDialog",{ref:"shareDialog",attrs:{"share-url":t.shareUrl},on:{submitFn:t.shaerSubmit}})],1)},qr=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"savequery_title"},[n("span",{staticClass:"label"},[t._v("文件夹列表")])])}],Nr=n("b03b");function Ir(t){return Ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ir(t)}function $r(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */$r=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var a=e&&e.prototype instanceof v?e:v,o=Object.create(a.prototype),s=new E(r||[]);return i(o,"_invoke",{value:S(t,n,s)}),o}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h="suspendedStart",p="suspendedYield",d="executing",m="completed",g={};function v(){}function b(){}function y(){}var w={};u(w,o,(function(){return this}));var _=Object.getPrototypeOf,k=_&&_(_(A([])));k&&k!==n&&r.call(k,o)&&(w=k);var D=y.prototype=v.prototype=Object.create(w);function x(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function n(i,a,o,s){var l=f(t[i],t,a);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==Ir(c)&&r.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,o,s)}),(function(t){n("throw",t,o,s)})):e.resolve(c).then((function(t){u.value=t,o(u)}),(function(t){return n("throw",t,o,s)}))}s(l.arg)}var a;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return a=a?a.then(i,i):i()}})}function S(e,n,r){var i=h;return function(a,o){if(i===d)throw new Error("Generator is already running");if(i===m){if("throw"===a)throw o;return{value:t,done:!0}}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var l=O(s,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===h)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=d;var u=f(e,n,r);if("normal"===u.type){if(i=r.done?m:p,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=m,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var a=f(i,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,g;var o=a.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(Ir(e)+" is not iterable")}return b.prototype=y,i(D,"constructor",{value:y,configurable:!0}),i(y,"constructor",{value:b,configurable:!0}),b.displayName=u(y,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u(t,l,"GeneratorFunction")),t.prototype=Object.create(D),t},e.awrap=function(t){return{__await:t}},x(C.prototype),u(C.prototype,s,(function(){return this})),e.AsyncIterator=C,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new C(c(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},x(D),u(D,l,"Generator"),u(D,o,(function(){return this})),u(D,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=A,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var l=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:A(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}function Pr(t,e,n,r,i,a,o){try{var s=t[a](o),l=s.value}catch(u){return void n(u)}s.done?e(l):Promise.resolve(l).then(r,i)}function Br(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){Pr(a,r,i,o,s,"next",t)}function s(t){Pr(a,r,i,o,s,"throw",t)}o(void 0)}))}}function zr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Mr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?zr(Object(n),!0).forEach((function(e){Qr(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):zr(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Qr(t,e,n){return e=Gr(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gr(t){var e=Rr(t,"string");return"symbol"===Ir(e)?e:String(e)}function Rr(t,e){if("object"!==Ir(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Ir(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Hr={components:{MonacoEditor:Nr["a"],customTree:z["a"],shareDialog:Ct},data:function(){return{params:{info:"",title:"",query_sql:"",engine:"",folderID:null,pageSize:30,pageNum:1},total:0,list:[],loading:!1,deleting:!1,multipleSelection:[],dialogVisible:!1,activeItem:{title:"",userGroup:"",engine:"",querySql:""},treeOptions:{"expand-on-click-node":!1,draggable:!0},moveFileDialType:!1,moveQueryObj:{},moveForm:{moveFileName:""},defaultProps:{children:"child",label:"name"},moveToFileObject:{},shareUrl:"",isTipDisabled:!1}},computed:Mr(Mr({},Object(f["c"])(["userInfo","folderList","engineListAll","regionList"])),{},{noDrag:function(){var t=this.folderList[0];return t?[t[this.defaultProps.label]]:[]}}),created:function(){this.search(),this.getFolderList()},methods:Mr(Mr({},Object(f["d"])(["SET_FOLDERLIST"])),{},{isShowTooltip:function(t){var e=t.target.clientWidth,n=t.target.scrollWidth;this.isTipDisabled=!(n>e)},regionFormat:function(t){var e;return null==(e=this.regionList.find((function(e){return e.name===t})))?void 0:e.name_zh},resetSearch:function(){this.params.info="",this.params.title="",this.params.query_sql="",this.params.engine="",this.params.folderID=null,this.params.pageSize=30,this.params.pageNum=1,this.search()},handelFolder:function(t){this.params.folderID=0===t.level?"":t.id,this.getList()},shaerSubmit:function(t){var e=this,n=Mr(Mr({},t),{},{sharer:this.userInfo.userId,shareUrl:this.shareUrl,name:""});Object(u["i"])(n).then((function(t){e.$message({type:"success",message:"分享成功"})}))},addFile:function(t,e){var n,r=this,i={name:t.addFileName,level:e?e.level+1:1,parent_id:e?e.id:null==(n=this.folderList[0])?void 0:n.id,is_active:1,is_query:0};Object(u["h"])(i).then((function(t){0===t.code&&(r.$message({type:"success",message:"新建成功"}),r.getFolderList())}))},resetFolderName:function(t){var e=this,n={id:t.id+"",name:t[this.defaultProps.label]};Object(u["J"])(n).then((function(t){e.$message({type:"success",message:"修改成功"}),e.getFolderList()}))},delFile:function(){var t=Br($r().mark((function t(e){var n,r,i,a=this;return $r().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=this.params.info.trim(),n=n.replace(/\[/g,"%5B").replace(/\]/g,"%5D").replace(/\{/g,"%7B").replace(/\}/g,"%7D").replace(/\\/g,"%5C"),t.next=4,Object(u["ub"])(Mr(Mr({},this.params),{},{info:n,folderID:e.id}));case 4:if(r=t.sent,i=r.data,!(i.list&&i.list.length>0)){t.next=9;break}return this.$message({type:"warning",message:"该文件夹下存在保存的sql,请先删除保存的sql再进行该操作"}),t.abrupt("return");case 9:Object(u["C"])({id:e.id+""}).then((function(t){a.$message({type:"success",message:"删除成功"}),a.getFolderList()}));case 10:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),moveClose:function(){this.$refs.moveFileForm.resetFields()},moveFilebtn:function(){var t=this;this.$refs.moveFileForm.validate((function(e){if(e){t.moveFileDialType=!1;var n={id:t.moveQueryObj.id+"",parent_id:t.moveToFileObject.id+"",is_query:"1"};t.folderMove(n)}}))},handelClickMove:function(t){this.moveForm.moveFileName=t[this.defaultProps.label],this.moveToFileObject=t,this.$refs.moveSelectTree.blur()},moveQuery:function(t){this.moveFileDialType=!0,this.moveQueryObj=t},moveFile:function(t,e){var n={id:t.id+"",parent_id:e.id?e.id+"":null,is_query:"0"};this.folderMove(n)},folderMove:function(t){var e=this;Object(u["N"])(t).then((function(t){e.$message({type:"success",message:"操作成功"})})).finally((function(){e.getFolderList()}))},getFolderList:function(){var t=this;Object(u["gb"])().then((function(e){var n=e.data||[];t.SET_FOLDERLIST(n)}))},shareBtn:function(t){var e,n=t.id,r=Object(U["getFormatUrl"])("sqlId",n,location.hash);this.shareUrl=r,null==(e=this.$refs.shareDialog)||e.open()},formatter:function(t){if(this.engineListAll.length<=0)return"";var e=this.engineListAll.find((function(e){return e.value===t.engine}));return e&&e.label||""},getList:function(){var t=this;this.loading=!0;var e=this.params.info.trim();e=e.replace(/\[/g,"%5B").replace(/\]/g,"%5D").replace(/\{/g,"%7B").replace(/\}/g,"%7D").replace(/\\/g,"%5C"),Object(u["ub"])(Mr(Mr({},this.params),{},{info:e})).then((function(e){t.list=e.data.list,t.total=e.data.total})).finally((function(){t.loading=!1}))},search:function(){this.params.pageNum=1,this.getList()},handleCurrentChange:function(t){this.params.pageNum=t,this.getList()},handleSizeChange:function(t){this.params.pageSize=t,this.params.pageNum=1,this.getList()},handleSelectionChange:function(t){this.multipleSelection=t},deleteHandler:function(){var t=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var e=t.multipleSelection.map((function(t){return t.id}));t.deleting=!0,Object(u["F"])({id:e.join(",")}).then((function(e){t.$message({type:"success",message:"删除成功"}),t.search()})).finally((function(){t.deleting=!1}))})).catch((function(){}))},checkSql:function(t){this.activeItem=Mr({},t),this.dialogVisible=!0},openDialog:function(){this.$refs.showMonaco.setCode(this.activeItem.querySql)},goQueryTab:function(t){g.$emit(m.switchQueryTab,t)}})},Ur=Hr,Yr=(n("aeeb"),Object(N["a"])(Ur,Fr,qr,!1,null,"73053396",null)),Vr=Yr.exports,Kr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"history-box"},[n("div",{staticClass:"condition-box"},[n("div",{staticClass:"condition-search"},[n("div",{staticClass:"condition_item"},[n("span",{staticClass:"search_text"},[t._v("ID: ")]),t._v(" "),n("el-input",{staticClass:"condition-input",attrs:{size:"mini",placeholder:"执行ID",clearable:""},on:{input:function(e){t.params.query_id=t.checkNum(t.params.query_id)}},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.params.query_id,callback:function(e){t.$set(t.params,"query_id",e)},expression:"params.query_id"}})],1),t._v(" "),n("div",{staticClass:"condition_item"},[n("span",{staticClass:"search_text"},[t._v("SQL: ")]),t._v(" "),n("el-input",{staticClass:"condition-input",attrs:{size:"mini",placeholder:"查询sql",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.params.query_sql,callback:function(e){t.$set(t.params,"query_sql",e)},expression:"params.query_sql"}})],1),t._v(" "),n("div",{staticClass:"condition_item"},[n("span",{staticClass:"search_text"},[t._v("执行人: ")]),t._v(" "),n("el-input",{staticClass:"condition-input",attrs:{size:"mini",placeholder:"执行人",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.params.createBy,callback:function(e){t.$set(t.params,"createBy",e)},expression:"params.createBy"}})],1),t._v(" "),n("div",{staticClass:"condition_item"},[n("span",{staticClass:"search_text"},[t._v("引擎: ")]),t._v(" "),n("el-select",{staticClass:"condition-input",attrs:{placeholder:"请选择引擎",size:"mini",clearable:""},on:{change:t.search},model:{value:t.params.engine,callback:function(e){t.$set(t.params,"engine",e)},expression:"params.engine"}},t._l(t.engineListAll,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.label}})})),1)],1),t._v(" "),n("div",{staticClass:"condition_item"},[n("span",{staticClass:"search_text"},[t._v("状态: ")]),t._v(" "),n("el-select",{staticClass:"condition-input",attrs:{placeholder:"请选择状态",size:"mini",clearable:""},on:{change:t.search},model:{value:t.params.status,callback:function(e){t.$set(t.params,"status",e)},expression:"params.status"}},t._l(t.statusList,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)]),t._v(" "),n("div",{staticClass:"reset_btn"},[n("el-button",{attrs:{size:"mini"},on:{click:t.resetSearch}},[t._v("重置")]),t._v(" "),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.search}},[t._v("查询")])],1)]),t._v(" "),n("div",{staticClass:"query-list"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{border:"",data:t.list,stripe:"",height:"calc(100vh - 178px)","tooltip-effect":"dark table_overflow_tootip","cell-style":{padding:"0px",height:"36px"}}},[n("el-table-column",{directives:[{name:"permission",rawName:"v-permission",value:t.permission,expression:"permission"}],attrs:{label:"",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-radio",{attrs:{disabled:0!==e.row.status,label:e.row.uuid},on:{change:function(n){return t.changeCurrentDl(n,e.row)}},model:{value:t.uuid,callback:function(e){t.uuid=e},expression:"uuid"}},[t._v(" ")])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"执行ID",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"content"},[n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(n){return t.goQueryTab(e.row)}}},[t._v(t._s(e.row.id))]),t._v(" "),0===e.row.isDatabend?n("div",{staticClass:"tag"},[n("svg-icon",{attrs:{"icon-class":"accelerate"}}),t._v(" "),n("span",[t._v("已加速")])],1):t._e()],1)]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"querySql",label:"查询","min-width":"350"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",disabled:t.isTipDisabled,content:r.querySql,placement:"bottom"}},[n("div",{staticClass:"ellipsis",on:{mouseenter:t.isShowTooltip}},[t._v(t._s(r.querySql))])])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"createBy",label:"执行人",width:"120"}}),t._v(" "),n("el-table-column",{attrs:{label:"开始时间",width:"160"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(t._f("dataTime")(e.row.startTime))+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"状态",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{class:" status status"+e.row.status},[0===e.row.status?n("i",{staticClass:"el-icon-circle-check"}):t._e(),t._v(" "),1===e.row.status?n("i",{staticClass:"el-icon-circle-close"}):t._e(),t._v(" "),3===e.row.status?n("i",{staticClass:"el-icon-loading"}):t._e(),t._v(" "),2===e.row.status?n("svg-icon",{attrs:{"icon-class":"stop"}}):t._e(),t._v("\n            "+t._s(0===e.row.status?"已完成":2===e.row.status?"已取消":3===e.row.status?"运行中":"已失败")+"\n          ")],1)]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"executeDuration",label:"运行时间(秒)",width:"115"}}),t._v(" "),n("el-table-column",{attrs:{prop:"dataSize",label:"数据已扫描",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row.scanSize||e.row.dataSize)+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"dataSize",label:"下载量",width:"100"}}),t._v(" "),n("el-table-column",{attrs:{label:"区域",width:"220"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(t.regionFormat(e.row.region)))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"使用的查询引擎版本",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.isDatabend?n("span",[t._v("加速引擎")]):n("span",[t._v(t._s(e.row.engineLabel))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作",width:"80",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(n){return t.checkSql(e.row)}}},[t._v("查看")]),t._v(" "),n("el-button",{attrs:{size:"mini",type:"text",disabled:3===e.row.status},on:{click:function(n){return t.shareBtn(e.row)}}},[t._v("分享")])]}}])})],1),t._v(" "),n("div",{staticClass:"footer"},[n("el-dropdown",[n("el-button",{attrs:{type:"primary",size:"mini",disabled:!t.uuid||t.downloading}},[t._v("\n          下载\n          "),t.downloading?n("i",{staticClass:"el-icon-loading"}):n("i",{staticClass:"el-icon-arrow-up"})]),t._v(" "),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{nativeOn:{click:function(e){return t.download("")}}},[t._v("CSV")]),t._v(" "),n("el-dropdown-item",{nativeOn:{click:function(e){return t.download("pdf")}}},[t._v("PDF")])],1)],1),t._v(" "),n("el-pagination",{attrs:{background:"",total:t.total,"current-page":t.params.pageNum,"page-sizes":[10,20,30,50,100],"page-size":t.params.pageSize,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1),t._v(" "),n("el-dialog",{attrs:{width:"700px","close-on-click-modal":!1,visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e},opened:t.openDialog}},[n("div",{attrs:{slot:"title"},slot:"title"},[t._v("\n      SQL脚本"),n("span",{staticStyle:{color:"#909399"}},[t._v("(Query Engine: "+t._s(t.formatter(t.activeItem)||"-")+")")])]),t._v(" "),n("div",{staticStyle:{height:"350px"}},[n("monaco-editor",{ref:"showMonaco",attrs:{"read-only":!0,"render-line-highlight":"all","scroll-beyond-last-line":!1},model:{value:t.activeItem.querySql,callback:function(e){t.$set(t.activeItem,"querySql",e)},expression:"activeItem.querySql"}})],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("关闭")])],1)]),t._v(" "),n("shareDialog",{ref:"shareDialog",attrs:{"share-url":t.shareUrl},on:{submitFn:t.shaerSubmit}})],1)},Wr=[];function Xr(t){return Xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xr(t)}function Jr(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Jr=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var a=e&&e.prototype instanceof v?e:v,o=Object.create(a.prototype),s=new E(r||[]);return i(o,"_invoke",{value:S(t,n,s)}),o}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h="suspendedStart",p="suspendedYield",d="executing",m="completed",g={};function v(){}function b(){}function y(){}var w={};u(w,o,(function(){return this}));var _=Object.getPrototypeOf,k=_&&_(_(A([])));k&&k!==n&&r.call(k,o)&&(w=k);var D=y.prototype=v.prototype=Object.create(w);function x(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function n(i,a,o,s){var l=f(t[i],t,a);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==Xr(c)&&r.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,o,s)}),(function(t){n("throw",t,o,s)})):e.resolve(c).then((function(t){u.value=t,o(u)}),(function(t){return n("throw",t,o,s)}))}s(l.arg)}var a;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return a=a?a.then(i,i):i()}})}function S(e,n,r){var i=h;return function(a,o){if(i===d)throw new Error("Generator is already running");if(i===m){if("throw"===a)throw o;return{value:t,done:!0}}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var l=O(s,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===h)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=d;var u=f(e,n,r);if("normal"===u.type){if(i=r.done?m:p,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=m,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var a=f(i,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,g;var o=a.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(Xr(e)+" is not iterable")}return b.prototype=y,i(D,"constructor",{value:y,configurable:!0}),i(y,"constructor",{value:b,configurable:!0}),b.displayName=u(y,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u(t,l,"GeneratorFunction")),t.prototype=Object.create(D),t},e.awrap=function(t){return{__await:t}},x(C.prototype),u(C.prototype,s,(function(){return this})),e.AsyncIterator=C,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new C(c(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},x(D),u(D,l,"Generator"),u(D,o,(function(){return this})),u(D,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=A,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var l=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:A(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}function Zr(t,e,n,r,i,a,o){try{var s=t[a](o),l=s.value}catch(u){return void n(u)}s.done?e(l):Promise.resolve(l).then(r,i)}function ti(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){Zr(a,r,i,o,s,"next",t)}function s(t){Zr(a,r,i,o,s,"throw",t)}o(void 0)}))}}function ei(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function ni(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ei(Object(n),!0).forEach((function(e){ri(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ei(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ri(t,e,n){return e=ii(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ii(t){var e=ai(t,"string");return"symbol"===Xr(e)?e:String(e)}function ai(t,e){if("object"!==Xr(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Xr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var oi={components:{MonacoEditor:Nr["a"],shareDialog:Ct},data:function(){return{isTipDisabled:!1,currentObj:{},params:{info:"",task_id:"",query_id:"",query_sql:"",createBy:"",status:"",engine:"",pageSize:30,pageNum:1},total:0,list:[],loading:!1,uuid:null,dialogVisible:!1,activeItem:{title:"",userGroup:"",engine:"",querySql:""},downloading:!1,shareUrl:"",statusList:[{label:"已完成",value:0},{label:"已失败",value:1},{label:"已取消",value:2},{label:"运行中",value:3}]}},computed:ni(ni({},Object(f["c"])(["engineListAll","userInfo","regionList"])),{},{permission:function(){var t={condition:"external",instead:!0};return t.condition_met=this.userInfo?this.userInfo.tenantName:"",t}}),created:function(){this.search()},methods:{isShowTooltip:function(t){var e=t.target.clientWidth,n=t.target.scrollWidth;this.isTipDisabled=!(n>e)},checkNum:function(t){if(t)return(t=Number(t.replace(/[^\d.%\\]/g,"")))||""},resetSearch:function(){this.params.info="",this.params.task_id="",this.params.query_id="",this.params.query_sql="",this.params.createBy="",this.params.status="",this.params.engine="",this.params.pageSize=30,this.params.pageNum=1,this.search()},regionFormat:function(t){var e;return null==(e=this.regionList.find((function(e){return e.name===t})))?void 0:e.name_zh},shaerSubmit:function(t){var e=this,n=ni(ni({},t),{},{sharer:this.userInfo.userId,shareUrl:this.shareUrl,name:""});Object(u["i"])(n).then((function(t){e.$message({type:"success",message:"分享成功"})}))},shareBtn:function(t){var e,n=t.uuid,r=Object(U["getFormatUrl"])("uuid",n,location.hash);this.shareUrl=r,null==(e=this.$refs.shareDialog)||e.open()},getList:function(){var t=this;this.loading=!0;var e=this.params.info.trim();e=e.replace(/\[/g,"%5B").replace(/\]/g,"%5D").replace(/\{/g,"%7B").replace(/\}/g,"%7D").replace(/\\/g,"%5C"),Object(u["pb"])(ni(ni({},this.params),{},{info:e})).then((function(e){var n=e.data;t.list=n.list,t.total=n.total})).finally((function(){t.loading=!1}))},search:function(){this.params.pageNum=1,this.getList()},handleCurrentChange:function(t){this.params.pageNum=t,this.getList()},handleSizeChange:function(t){this.params.pageSize=t,this.params.pageNum=1,this.getList()},formatter:function(t){if(this.engineListAll.length<=0)return"";var e=this.engineListAll.find((function(e){return e.value===t.engine}));return e&&e.label||""},changeCurrentDl:function(t,e){this.currentObj=Object.assign({},e)},download:function(){var t=ti(Jr().mark((function t(e){var n,r,i,a=this;return Jr().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return this.downloading=!0,t.next=3,Object(u["Gb"])(this.uuid);case 3:n=t.sent.data,r=n||"pdf"===e?u["G"]:u["H"],i={responseType:"blob"},r({uuid:this.uuid,type:e},i).then((function(t){if(!n&&"pdf"!==e){var r=t.data||[];r.length>0&&r.forEach((function(t){var e=document.createElement("a");e.href=t.replace(/http:|https:/i,location.protocol),e.click()}))}})).finally((function(){a.downloading=!1}));case 7:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),checkSql:function(t){this.activeItem=ni({},t),this.dialogVisible=!0},openDialog:function(){this.$refs.showMonaco.setCode(this.activeItem.querySql)},goQueryTab:function(t){g.$emit(m.switchQueryTab,t)}}},si=oi,li=(n("ea29"),Object(N["a"])(si,Kr,Wr,!1,null,"617eb7fa",null)),ui=li.exports,ci=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"shartTab-box"},[n("div",{staticClass:"condition-box"},[n("div",{staticClass:"condition-search"},[n("div",{staticClass:"condition-item"},[n("span",{staticClass:"label"},[t._v("SQL: ")]),t._v(" "),n("el-input",{staticClass:"condition-input",attrs:{placeholder:"请输入sql",clearable:"",size:"mini"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.params.share_sql,callback:function(e){t.$set(t.params,"share_sql",e)},expression:"params.share_sql"}})],1),t._v(" "),n("div",{staticClass:"condition-item"},[n("span",{staticClass:"label"},[t._v("分享人: ")]),t._v(" "),n("el-input",{staticClass:"condition-input",attrs:{placeholder:"请输入分享人",clearable:"",size:"mini"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.params.sharer,callback:function(e){t.$set(t.params,"sharer",e)},expression:"params.sharer"}})],1),t._v(" "),n("div",{staticClass:"condition-item"},[n("span",{staticClass:"label"},[t._v("引擎: ")]),t._v(" "),n("el-select",{staticClass:"condition-input",attrs:{placeholder:"请选择引擎",clearable:"",size:"mini"},on:{change:t.search},model:{value:t.params.engine,callback:function(e){t.$set(t.params,"engine",e)},expression:"params.engine"}},t._l(t.engineListAll,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)]),t._v(" "),n("div",{staticClass:"reset_btn"},[n("el-button",{attrs:{size:"mini"},on:{click:t.resetSearch}},[t._v("重置")]),t._v(" "),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.search}},[t._v("查询")])],1)]),t._v(" "),n("div",{staticClass:"query-list"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{border:"",data:t.list,height:"calc(100vh - 180px)","tooltip-effect":"dark table_overflow_tootip","cell-style":{padding:"0px",height:"36px"}},on:{"selection-change":t.handleSelectionChange}},[n("el-table-column",{attrs:{label:"分享ID",width:"80","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.jumpSearch(e.row)}}},[t._v(t._s(e.row.id))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"名称",width:"100","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"content"},[t._v(t._s(e.row.name||"-"))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"查询"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"content"},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",disabled:t.isTipDisabled,content:e.row.sql,placement:"top",enterable:!1}},[n("div",{staticClass:"title",on:{mouseenter:t.isShowTooltip}},[t._v(t._s(e.row.sql))])]),t._v(" "),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"复制",placement:"top",enterable:!1}},[n("i",{staticClass:"el-icon-document-copy",on:{click:function(n){return t.copySql(e.row.sql)}}})])],1)]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"sharer",label:"分享人",width:"160","show-overflow-tooltip":""}}),t._v(" "),n("el-table-column",{attrs:{label:"所属数据区域",width:"220","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(t.regionFormat(e.row.region)))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"查询引擎",width:"200","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(t.engineFormat(e.row.engine)))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作",width:"80",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(n){return t.shareBtn(e.row)}}},[t._v("分享")])]}}])})],1),t._v(" "),n("div",{staticClass:"footer"},[n("el-pagination",{attrs:{background:"",total:t.total,"current-page":t.params.pageNum,"page-sizes":[10,20,30,50,100],"page-size":t.params.pageSize,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1),t._v(" "),n("shareDialog",{ref:"shareDialog",attrs:{"share-url":t.shareUrl,grade:t.grade},on:{submitFn:t.shaerSubmit}})],1)},fi=[];function hi(t){return hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hi(t)}function pi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function di(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?pi(Object(n),!0).forEach((function(e){mi(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pi(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function mi(t,e,n){return e=gi(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gi(t){var e=vi(t,"string");return"symbol"===hi(e)?e:String(e)}function vi(t,e){if("object"!==hi(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==hi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var bi={components:{shareDialog:Ct},data:function(){return{params:{share_sql:"",sharer:"",engine:"",pageSize:30,pageNum:1},total:0,list:[],loading:!1,shareUrl:"",grade:null,isTipDisabled:!1}},created:function(){this.search()},computed:di({},Object(f["c"])(["regionList","engineListAll","userInfo"])),methods:{isShowTooltip:function(t){var e=t.target.clientWidth,n=t.target.scrollWidth;this.isTipDisabled=!(n>e)},copySql:function(t){gt()(t,{format:"text/plain"}),this.$message({type:"success",message:"已复制到剪贴板"})},jumpSearch:function(t){var e;if(t.shareUrl||this.$message({type:"warning",message:"该分享数据有误"}),t.shareUrl&&t.shareUrl.includes("uuid")){var n=t.shareUrl.split("?")[1],r=n.split("&").find((function(t){return t.includes("uuid")}));e=r.split("=")[1]||""}var i=di(di({},t),{},{querySql:t.sql,uuid:e});g.$emit(m.switchQueryTab,i)},resetSearch:function(){this.params.sharer="",this.params.share_sql="",this.params.engine="",this.params.pageSize=30,this.params.pageNum=1,this.search()},engineFormat:function(t){var e;return(null==(e=this.engineListAll.find((function(e){return e.value===t})))?void 0:e.label)||t},regionFormat:function(t){var e;return(null==(e=this.regionList.find((function(e){return e.name===t})))?void 0:e.name_zh)||t},shaerSubmit:function(t){var e=this,n=di(di({},t),{},{sharer:this.userInfo.userId,shareUrl:this.shareUrl,name:""});Object(u["i"])(n).then((function(t){e.$message({type:"success",message:"分享成功"})}))},shareBtn:function(t){this.shareUrl=t.shareUrl||"",this.grade=t.grade,this.$refs.shareDialog.open()},getList:function(){var t=this;this.loading=!0,Object(u["jb"])(this.params).then((function(e){t.list=e.data.list,t.total=e.data.total})).finally((function(){t.loading=!1}))},search:function(){this.params.pageNum=1,this.getList()},handleCurrentChange:function(t){this.params.pageNum=t,this.getList()},handleSizeChange:function(t){this.params.pageSize=t,this.params.pageNum=1,this.getList()},handleSelectionChange:function(t){this.multipleSelection=t}}},yi=bi,wi=(n("c03f"),Object(N["a"])(yi,ci,fi,!1,null,"59003d36",null)),_i=wi.exports,ki=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"warrp"},[n("div",{staticClass:"search"},[n("el-row",{staticClass:"flex-search"},[n("div",{staticClass:"flex-item"},[n("div",{staticClass:"label"},[t._v("名 称:")]),t._v(" "),n("el-input",{staticClass:"condition-input",attrs:{size:"mini",placeholder:"请输入API名称",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.searchForm.title,callback:function(e){t.$set(t.searchForm,"title",e)},expression:"searchForm.title"}})],1),t._v(" "),n("div",{staticClass:"flex-item"},[n("div",{staticClass:"label"},[t._v("查 询:")]),t._v(" "),n("el-input",{staticClass:"condition-input",attrs:{size:"mini",placeholder:"请输入查询",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.searchForm.querySql,callback:function(e){t.$set(t.searchForm,"querySql",e)},expression:"searchForm.querySql"}})],1),t._v(" "),n("div",{staticClass:"flex-item"},[n("div",{staticClass:"label"},[t._v("引 擎:")]),t._v(" "),n("el-select",{staticClass:"condition-input",attrs:{placeholder:"请选择引擎",size:"mini",clearable:""},on:{change:t.search},model:{value:t.searchForm.engineZh,callback:function(e){t.$set(t.searchForm,"engineZh",e)},expression:"searchForm.engineZh"}},t._l(t.engineListAll,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),t._v(" "),n("div",{staticClass:"flex-item"},[n("div",{staticClass:"label"},[t._v("状 态:")]),t._v(" "),n("el-select",{staticClass:"condition-input",attrs:{placeholder:"请选择状态",size:"mini",clearable:""},on:{change:t.search},model:{value:t.searchForm.status,callback:function(e){t.$set(t.searchForm,"status",e)},expression:"searchForm.status"}},t._l(t.statusOptions,(function(t){return n("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)]),t._v(" "),n("div",{staticClass:"reset_btn"},[n("el-button",{attrs:{size:"mini"},on:{click:t.resetSearch}},[t._v("重置")]),t._v(" "),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.search}},[t._v("查询")])],1)],1),t._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticClass:"multipleTable",staticStyle:{width:"100%"},attrs:{border:"",data:t.tableData,"tooltip-effect":"dark table_overflow_tootip","cell-style":{padding:"0px",height:"36px"}},on:{"selection-change":t.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"55",selectable:t.checkSelectable}}),t._v(" "),n("el-table-column",{attrs:{label:"名称",width:"120","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{staticClass:"tableName ellipsis",attrs:{size:"mini",type:"text"},on:{click:function(n){return t.goQueryTab(e.row)}}},[t._v(t._s(e.row.title))])]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"API Path"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"content"},[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",disabled:t.isTipDisabled,content:e.row.path,placement:"top",enterable:!1}},[n("div",{staticClass:"title",on:{mouseenter:t.isShowTooltip}},[t._v(t._s(e.row.path))])]),t._v(" "),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"复制",placement:"top",enterable:!1}},[n("i",{staticClass:"el-icon-document-copy",on:{click:function(n){return t.copyPath(e.row.path)}}})])],1)]}}])}),t._v(" "),t._l(t.columnData,(function(e){return n("el-table-column",{key:e.prop,attrs:{prop:e.prop,label:e.label,width:e.width,"show-overflow-tooltip":"",formatter:t.formatter}})})),t._v(" "),n("el-table-column",{attrs:{label:"被调用次数",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-popover",{attrs:{"popper-class":"apiListCount",placement:"bottom","visible-arrow":!0,width:"230",trigger:"hover"}},[n("div",{staticClass:"context"},t._l(e.row.countInfo,(function(e){return n("div",{key:e.id},[t._v(t._s(e.createBy+" "+t.$utils.parseTime(e.createTime,"{y}-{m}-{d} {h}:{i}:{s}")+" 调用了API"))])})),0),t._v(" "),n("el-button",{attrs:{slot:"reference",type:"text",disabled:0===e.row.countInfo.length},slot:"reference"},[t._v(t._s(e.row.countInfo.length))])],1)]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(n){return t.checkSql(e.row)}}},[t._v("查看")]),t._v(" "),n("el-button",{attrs:{size:"mini",type:"text",disabled:0===e.row.status},on:{click:function(n){return t.upLine(e.row)}}},[t._v("上线")]),t._v(" "),n("el-button",{attrs:{size:"mini",type:"text",disabled:1===e.row.status},on:{click:function(n){return t.downLine(e.row)}}},[t._v("下线")])]}}])})],2),t._v(" "),n("div",{staticClass:"footer"},[n("el-button",{attrs:{type:"danger",size:"mini",disabled:t.selectData.length<=0,loading:t.deleting},on:{click:t.deleteHandler}},[t._v("删除")]),t._v(" "),n("el-pagination",{attrs:{background:"",total:t.total,"current-page":t.params.pageNum,"page-sizes":[10,20,30,50,100],"page-size":t.params.pageSize,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1),t._v(" "),n("el-dialog",{attrs:{width:"700px","close-on-click-modal":!1,visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e},opened:t.openDialog}},[n("div",{attrs:{slot:"title"},slot:"title"},[t._v("\n      SQL脚本"),n("span",{staticStyle:{color:"#909399"}},[t._v("(Query Engine: "+t._s(t.formatterEngine(t.activeItem)||"-")+")")])]),t._v(" "),n("div",{staticStyle:{height:"350px"}},[n("monaco-editor",{ref:"showMonaco",attrs:{"read-only":!0,"render-line-highlight":"all","scroll-beyond-last-line":!1},model:{value:t.activeItem.querySql,callback:function(e){t.$set(t.activeItem,"querySql",e)},expression:"activeItem.querySql"}})],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("关闭")])],1)])],1)},Di=[];function xi(t){return xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xi(t)}function Ci(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Ci=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",s=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var a=e&&e.prototype instanceof v?e:v,o=Object.create(a.prototype),s=new E(r||[]);return i(o,"_invoke",{value:S(t,n,s)}),o}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var h="suspendedStart",p="suspendedYield",d="executing",m="completed",g={};function v(){}function b(){}function y(){}var w={};u(w,o,(function(){return this}));var _=Object.getPrototypeOf,k=_&&_(_(A([])));k&&k!==n&&r.call(k,o)&&(w=k);var D=y.prototype=v.prototype=Object.create(w);function x(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function C(t,e){function n(i,a,o,s){var l=f(t[i],t,a);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==xi(c)&&r.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,o,s)}),(function(t){n("throw",t,o,s)})):e.resolve(c).then((function(t){u.value=t,o(u)}),(function(t){return n("throw",t,o,s)}))}s(l.arg)}var a;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return a=a?a.then(i,i):i()}})}function S(e,n,r){var i=h;return function(a,o){if(i===d)throw new Error("Generator is already running");if(i===m){if("throw"===a)throw o;return{value:t,done:!0}}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var l=O(s,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===h)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=d;var u=f(e,n,r);if("normal"===u.type){if(i=r.done?m:p,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=m,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var a=f(i,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,g;var o=a.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function L(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(L,this),this.reset(!0)}function A(e){if(e||""===e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(xi(e)+" is not iterable")}return b.prototype=y,i(D,"constructor",{value:y,configurable:!0}),i(y,"constructor",{value:b,configurable:!0}),b.displayName=u(y,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,u(t,l,"GeneratorFunction")),t.prototype=Object.create(D),t},e.awrap=function(t){return{__await:t}},x(C.prototype),u(C.prototype,s,(function(){return this})),e.AsyncIterator=C,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new C(c(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},x(D),u(D,l,"Generator"),u(D,o,(function(){return this})),u(D,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=A,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var l=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:A(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}function Si(t,e,n,r,i,a,o){try{var s=t[a](o),l=s.value}catch(u){return void n(u)}s.done?e(l):Promise.resolve(l).then(r,i)}function Oi(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){Si(a,r,i,o,s,"next",t)}function s(t){Si(a,r,i,o,s,"throw",t)}o(void 0)}))}}function Li(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ti(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Li(Object(n),!0).forEach((function(e){Ei(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Li(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Ei(t,e,n){return e=Ai(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ai(t){var e=ji(t,"string");return"symbol"===xi(e)?e:String(e)}function ji(t,e){if("object"!==xi(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==xi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Fi={name:"GenerateApi",components:{MonacoEditor:Nr["a"]},data:function(){return{dialogVisible:!1,activeItem:{},tableData:[],deleting:!1,tenantId:JSON.parse(sessionStorage.getItem("userInfo")).tenantId,searchForm:{title:"",path:"",querySql:"",param:"",createBy:"",status:"",engineZh:""},options:[],selectData:[],total:0,params:{pageNum:1,pageSize:30},statusOptions:[{label:"已上线",value:0},{label:"已下线",value:1}],columnData:[{prop:"querySql",label:"查询"},{prop:"region",label:"区域",width:"100"},{prop:"engineZh",label:"查询引擎",width:"140"},{prop:"createBy",label:"创建人",width:"120"},{prop:"updateTime",label:"更新时间",width:"160"},{prop:"status",label:"状态",width:"70"}],loading:!1,isTipDisabled:!1}},computed:Ti({},Object(f["c"])(["engineListAll","regionList"])),created:function(){this.search()},methods:{isShowTooltip:function(t){var e=t.target.clientWidth,n=t.target.scrollWidth;this.isTipDisabled=!(n>e)},resetSearch:function(){this.searchForm.title="",this.searchForm.path="",this.searchForm.querySql="",this.searchForm.param="",this.searchForm.createBy="",this.searchForm.status="",this.searchForm.engineZh="",this.params.pageNum=1,this.params.pageSize=30,this.search()},checkSelectable:function(t){return 1===t.status},upLine:function(t){var e=this,n=t.id;Object(u["y"])({id:n,status:0}).then((function(t){e.$message({type:"success",message:"上线成功"}),e.search()}))},downLine:function(t){var e=this,n=t.id;Object(u["y"])({id:n,status:1}).then((function(t){e.$message({type:"success",message:"下线成功"}),e.search()}))},copyPath:function(t){gt()(t,{format:"text/plain"}),this.$message({type:"success",message:"API路径已复制到剪贴板"})},checkSql:function(t){this.activeItem=Ti({},t),this.dialogVisible=!0},openDialog:function(){this.$refs.showMonaco.setCode(this.activeItem.querySql)},handleCurrentChange:function(t){this.params.pageNum=t,this.search()},handleSizeChange:function(t){this.params.pageSize=t,this.search()},deleteHandler:function(){var t=this,e=this.$refs.multipleTable.selection||[],n=e.map((function(t){var e=t.id;return e}));n=n.join(","),Object(u["B"])(n).then((function(e){t.$message({type:"success",message:"删除成功"}),t.search()}))},formatterEngine:function(t){if(this.engineListAll.length<=0)return"";var e=this.engineListAll.find((function(e){return e.value===t.engine}));return e&&e.label||""},formatter:function(t,e,n,r){return"status"===e.property?this.statusOptions.find((function(t){return t.value===n})).label:["createTime","updateTime"].includes(e.property)?this.$utils.parseTime(n,"{y}-{m}-{d} {h}:{i}:{s}"):"region"===e.property?null==(i=this.regionList.find((function(t){return t.name===n})))?void 0:i.name_zh:n;var i},remoteMethod:function(){var t=Oi(Ci().mark((function t(e){var n;return Ci().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""===e.trim()){t.next=11;break}return this.loadingSelect=!0,t.next=4,Object(vt["M"])({name:e,tenantId:this.tenantId});case 4:return t.next=6,t.sent.data;case 6:n=t.sent,this.loadingSelect=!1,this.options=n.length>0?n.map((function(t){return{label:t.name,value:t.name}})):[],t.next=12;break;case 11:this.options=[];case 12:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),goQueryTab:function(t){g.$emit(m.switchQueryTab,t)},handleSelectionChange:function(t){this.selectData=t},search:function(){var t=this;this.loading=!0;var e=JSON.parse(JSON.stringify(this.searchForm));Object.keys(e).forEach((function(t){e[t]||delete e[t],["path","querySql"].includes[t]&&(e[t]=e[t].replace(/\[/g,"%5B").replace(/\]/g,"%5D").replace(/\{/g,"%7B").replace(/\}/g,"%7D").replace(/\\/g,"%5C"))}));var n=Ti(Ti({},this.searchForm),this.params);Object(u["X"])(n).then((function(e){t.tableData=e.data.list,t.total=e.data.total})).finally((function(){t.loading=!1}))}}},qi=Fi,Ni=(n("35a9"),n("d4b9"),Object(N["a"])(qi,ki,Di,!1,null,"c0ce5aea",null)),Ii=Ni.exports,$i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"controlMan-box"},[n("div",{staticClass:"condition-box"},[n("div",{staticClass:"condition-search"},[n("div",{staticClass:"condition_item"},[n("span",{staticClass:"search_text"},[t._v("名称: ")]),t._v(" "),n("el-input",{staticClass:"condition-input",attrs:{size:"mini",placeholder:"查询名称",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.params.taskName,callback:function(e){t.$set(t.params,"taskName",e)},expression:"params.taskName"}})],1),t._v(" "),n("div",{staticClass:"condition_item"},[n("span",{staticClass:"search_text"},[t._v("SQL: ")]),t._v(" "),n("el-input",{staticClass:"condition-input",attrs:{size:"mini",placeholder:"查询sql",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.params.originSql,callback:function(e){t.$set(t.params,"originSql",e)},expression:"params.originSql"}})],1),t._v(" "),n("div",{staticClass:"condition_item"},[n("span",{staticClass:"search_text"},[t._v("执行人: ")]),t._v(" "),n("el-input",{staticClass:"condition-input",attrs:{size:"mini",placeholder:"执行人",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.params.userName,callback:function(e){t.$set(t.params,"userName",e)},expression:"params.userName"}})],1)]),t._v(" "),n("div",{staticClass:"reset_btn"},[n("el-button",{attrs:{size:"mini"},on:{click:t.resetSearch}},[t._v("重置")]),t._v(" "),n("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.search}},[t._v("查询")])],1)]),t._v(" "),n("div",{staticClass:"query-list"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{border:"",data:t.list,stripe:"",height:"calc(100vh - 178px)","tooltip-effect":"dark table_overflow_tootip","cell-style":{padding:"0px",height:"36px"}}},[n("el-table-column",{attrs:{type:"index",label:"序号",width:"50",index:t.indexMethod}}),t._v(" "),n("el-table-column",{attrs:{prop:"taskName",label:"名称","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[n("el-button",{attrs:{type:"text"},on:{click:function(e){return t.jump(r)}}},[t._v(t._s(r.taskName||"-"))])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"originSql",label:"查询","min-width":"250"},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.row;return[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",disabled:t.isTipDisabled,content:r.originSql,placement:"bottom"}},[n("div",{staticClass:"ellipsis",on:{mouseenter:t.isShowTooltip}},[t._v(t._s(r.originSql))])])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"userName",label:"执行人",width:"120"}}),t._v(" "),n("el-table-column",{attrs:{label:"创建时间","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(t.$utils.parseTime(e.row.createTime)||"-")+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"调度周期",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(t.formatLabel(e.row.schedule,t.cycleList))+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"最近运行状态","min-width":"120"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.taskInstances,(function(e,r){return n("el-popover",{key:r,attrs:{trigger:"hover",placement:"bottom"}},[n("p",[t._v("执行时间："+t._s(e.execution_date?t.$utils.parseTime(e.execution_date):"-"))]),t._v(" "),n("p",[t._v("执行状态："+t._s(t.offlineStateCode[e.state]||"-"))]),t._v(" "),n("p",[t._v("开始时间："+t._s(e.start_date?t.$utils.parseTime(e.start_date):"-"))]),t._v(" "),n("p",[t._v("结束时间："+t._s(e.end_date?t.$utils.parseTime(e.end_date):"-"))]),t._v(" "),n("p",[t._v("耗时："+t._s(e.duration||"-"))]),t._v(" "),n("span",{class:["circle","task-state",e.state],attrs:{slot:"reference"},slot:"reference"})])}))}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.status?n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(n){return t.suspendBtn(e.row,1)}}},[t._v("上线")]):t._e(),t._v(" "),1===e.row.status?n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(n){return t.suspendBtn(e.row,0)}}},[t._v("下线")]):t._e(),t._v(" "),n("el-button",{attrs:{disabled:1===e.row.status,size:"mini",type:"text"},on:{click:function(n){return t.suspendBtn(e.row,2)}}},[t._v("删除")])]}}])})],1),t._v(" "),n("div",{staticClass:"footer"},[n("el-pagination",{attrs:{background:"",total:t.total,"current-page":t.params.pageNum,"page-sizes":[10,20,30,50,100],"page-size":t.params.pageSize,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)])},Pi=[],Bi=n("b893");function zi(t){return zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},zi(t)}function Mi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Qi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Mi(Object(n),!0).forEach((function(e){Gi(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Mi(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Gi(t,e,n){return e=Ri(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ri(t){var e=Hi(t,"string");return"symbol"===zi(e)?e:String(e)}function Hi(t,e){if("object"!==zi(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==zi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var Ui={data:function(){return{cycleList:[{label:"分钟",value:"minutely"},{label:"小时",value:"hourly"},{label:"天",value:"daily"},{label:"周",value:"weekly"},{label:"月",value:"monthly"}],list:[],loading:!1,total:0,params:{taskId:null,taskName:"",originSql:"",userName:"",status:"",pageSize:30,pageNum:1},offlineStateCode:Bi["i"],isTipDisabled:!1}},inject:["changeActiveTab"],created:function(){this.getList()},methods:{isShowTooltip:function(t){var e=t.target.clientWidth,n=t.target.scrollWidth;this.isTipDisabled=!(n>e)},jump:function(t){this.changeActiveTab("historyTab",{task_id:+t.taskId})},formatLabel:function(t,e){var n;return(null==(n=e.find((function(e){return e.value===t})))?void 0:n.label)||"-"},resetSearch:function(){this.params={taskId:null,taskName:"",originSql:"",userName:"",pageSize:30,pageNum:1},this.getList()},suspendBtn:function(t,e){var n=this;2!==e?Object(u["zb"])({taskId:t.taskId,newStatus:e}).then((function(t){0===t.code&&(n.$message.success("操作成功"),n.getList())})):this.delBtn(t)},delBtn:function(t){var e=this;this.$confirm("您要确定是否要删除该定时任务？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(u["zb"])({taskId:t.taskId,newStatus:2}).then((function(t){0===t.code&&(e.$message.success("操作成功"),e.getList())}))}))},search:function(){this.params.pageNum=1,this.getList()},handleCurrentChange:function(t){this.params.pageNum=t,this.getList()},handleSizeChange:function(t){this.params.pageSize=t,this.params.pageNum=1,this.getList()},indexMethod:function(t){return(this.params.pageNum-1)*this.params.pageSize+t+1},getTaskInstance:function(t){var e=this,n=t.map((function(t){var e=t.taskId;return e}));Object(Lt["R"])({ids:n.join(",")}).then((function(n){var r=n.data||{},i=function(n){var i,a=t.find((function(t){return t.taskId===Number(n)}));a&&e.$set(a,"taskInstances",null==(i=r[n])?void 0:i.slice(-7))};for(var a in r)i(a)}))},getList:function(){var t=this;this.loading=!0,Object(u["s"])(Qi(Qi({},this.params),{},{taskId:+this.params.taskId})).then((function(e){t.list=e.list||[],t.total=e.total||0,t.getTaskInstance(t.list)})).finally((function(){t.loading=!1}))}}},Yi=Ui,Vi=(n("ff6e"),Object(N["a"])(Yi,$i,Pi,!1,null,"2f3ff31e",null)),Ki=Vi.exports;function Wi(t){return Wi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wi(t)}function Xi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Ji(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Xi(Object(n),!0).forEach((function(e){Zi(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xi(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Zi(t,e,n){return e=ta(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ta(t){var e=ea(t,"string");return"symbol"===Wi(e)?e:String(e)}function ea(t,e){if("object"!==Wi(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==Wi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var na={components:{QueryTab:jr,SavedTab:Vr,HistoryTab:ui,shareTab:_i,generateApi:Ii,ControlManager:Ki},data:function(){return{activeTab:"queryTab",permissionType:!0}},created:function(){var t=this;g.$on(m.switchQueryTab,(function(e){t.activeTab="queryTab"}));var e=this.$route.query.active;e&&this.changeActiveTab(e)},provide:function(){return{changeActiveTab:this.changeActiveTab}},computed:Ji(Ji({},Object(f["c"])(["userInfo"])),{},{permission:function(){var t={};return t.condition=qn["c"],t.condition_met=this.userInfo?this.userInfo.tenantName:"",t.callBack=this.permissionFn,t}}),destroyed:function(){g.$off(m.switchQueryTab)},methods:{permissionFn:function(t){this.permissionType=t},changeActiveTab:function(t,e){var n=this;this.activeTab=t,this.$nextTick((function(){e&&Object.assign(n.$refs[t].params,e),n.$refs[t].search()}))},handleClick:function(t){this.$refs[t.name]&&sessionStorage.getItem("ds-".concat(t.name,"-refresh"))&&(this.$refs[t.name].search(),"saveTab"===t.name&&this.$refs[t.name].getFolderList(),sessionStorage.removeItem("ds-".concat(t.name,"-refresh")))}}},ra=na,ia=(n("8d76"),n("b06b"),Object(N["a"])(ra,r,i,!1,null,"31584bbc",null));e["default"]=ia.exports},"60f6":function(t,e,n){},6628:function(t,e,n){"use strict";n("4a55")},"6cf8":function(t,e,n){"use strict";n("7d6d")},7581:function(t,e,n){"use strict";n("3b14")},"764e":function(t,e,n){"use strict";n("198d")},7732:function(t,e,n){"use strict";n("8648")},"7bd7":function(t,e,n){},"7c5c":function(t,e,n){(function(t,n){n(e)})(0,(function(t){"use strict";function e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,l(r.key),r)}}function n(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function r(){return r=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},r.apply(this,arguments)}function i(t,e){if(t){if("string"===typeof t)return a(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(t,e):void 0}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(n)return(n=n.call(t)).next.bind(n);if(Array.isArray(t)||(n=i(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0;return function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(t,e){if("object"!==typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}function l(t){var e=s(t,"string");return"symbol"===typeof e?e:String(e)}function u(){return{async:!1,baseUrl:null,breaks:!1,extensions:null,gfm:!0,headerIds:!0,headerPrefix:"",highlight:null,hooks:null,langPrefix:"language-",mangle:!0,pedantic:!1,renderer:null,sanitize:!1,sanitizer:null,silent:!1,smartypants:!1,tokenizer:null,walkTokens:null,xhtml:!1}}function c(e){t.defaults=e}t.defaults=u();var f=/[&<>"']/,h=new RegExp(f.source,"g"),p=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,d=new RegExp(p.source,"g"),m={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},g=function(t){return m[t]};function v(t,e){if(e){if(f.test(t))return t.replace(h,g)}else if(p.test(t))return t.replace(d,g);return t}var b=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi;function y(t){return t.replace(b,(function(t,e){return e=e.toLowerCase(),"colon"===e?":":"#"===e.charAt(0)?"x"===e.charAt(1)?String.fromCharCode(parseInt(e.substring(2),16)):String.fromCharCode(+e.substring(1)):""}))}var w=/(^|[^\[])\^/g;function _(t,e){t="string"===typeof t?t:t.source,e=e||"";var n={replace:function(e,r){return r=r.source||r,r=r.replace(w,"$1"),t=t.replace(e,r),n},getRegex:function(){return new RegExp(t,e)}};return n}var k=/[^\w:]/g,D=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function x(t,e,n){if(t){var r;try{r=decodeURIComponent(y(n)).replace(k,"").toLowerCase()}catch(i){return null}if(0===r.indexOf("javascript:")||0===r.indexOf("vbscript:")||0===r.indexOf("data:"))return null}e&&!D.test(n)&&(n=T(e,n));try{n=encodeURI(n).replace(/%25/g,"%")}catch(i){return null}return n}var C={},S=/^[^:]+:\/*[^/]*$/,O=/^([^:]+:)[\s\S]*$/,L=/^([^:]+:\/*[^/]*)[\s\S]*$/;function T(t,e){C[" "+t]||(S.test(t)?C[" "+t]=t+"/":C[" "+t]=j(t,"/",!0)),t=C[" "+t];var n=-1===t.indexOf(":");return"//"===e.substring(0,2)?n?e:t.replace(O,"$1")+e:"/"===e.charAt(0)?n?e:t.replace(L,"$1")+e:t+e}var E={exec:function(){}};function A(t,e){var n=t.replace(/\|/g,(function(t,e,n){var r=!1,i=e;while(--i>=0&&"\\"===n[i])r=!r;return r?"|":" |"})),r=n.split(/ \|/),i=0;if(r[0].trim()||r.shift(),r.length>0&&!r[r.length-1].trim()&&r.pop(),r.length>e)r.splice(e);else while(r.length<e)r.push("");for(;i<r.length;i++)r[i]=r[i].trim().replace(/\\\|/g,"|");return r}function j(t,e,n){var r=t.length;if(0===r)return"";var i=0;while(i<r){var a=t.charAt(r-i-1);if(a!==e||n){if(a===e||!n)break;i++}else i++}return t.slice(0,r-i)}function F(t,e){if(-1===t.indexOf(e[1]))return-1;for(var n=t.length,r=0,i=0;i<n;i++)if("\\"===t[i])i++;else if(t[i]===e[0])r++;else if(t[i]===e[1]&&(r--,r<0))return i;return-1}function q(t){t&&t.sanitize&&!t.silent&&console.warn("marked(): sanitize and sanitizer parameters are deprecated since version 0.7.0, should not be used and will be removed in the future. Read more here: https://marked.js.org/#/USING_ADVANCED.md#options")}function N(t,e){if(e<1)return"";var n="";while(e>1)1&e&&(n+=t),e>>=1,t+=t;return n+t}function I(t,e,n,r){var i=e.href,a=e.title?v(e.title):null,o=t[1].replace(/\\([\[\]])/g,"$1");if("!"!==t[0].charAt(0)){r.state.inLink=!0;var s={type:"link",raw:n,href:i,title:a,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,s}return{type:"image",raw:n,href:i,title:a,text:v(o)}}function $(t,e){var n=t.match(/^(\s+)(?:```)/);if(null===n)return e;var r=n[1];return e.split("\n").map((function(t){var e=t.match(/^\s+/);if(null===e)return t;var n=e[0];return n.length>=r.length?t.slice(r.length):t})).join("\n")}var P=function(){function e(e){this.options=e||t.defaults}var n=e.prototype;return n.space=function(t){var e=this.rules.block.newline.exec(t);if(e&&e[0].length>0)return{type:"space",raw:e[0]}},n.code=function(t){var e=this.rules.block.code.exec(t);if(e){var n=e[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:e[0],codeBlockStyle:"indented",text:this.options.pedantic?n:j(n,"\n")}}},n.fences=function(t){var e=this.rules.block.fences.exec(t);if(e){var n=e[0],r=$(n,e[3]||"");return{type:"code",raw:n,lang:e[2]?e[2].trim().replace(this.rules.inline._escapes,"$1"):e[2],text:r}}},n.heading=function(t){var e=this.rules.block.heading.exec(t);if(e){var n=e[2].trim();if(/#$/.test(n)){var r=j(n,"#");this.options.pedantic?n=r.trim():r&&!/ $/.test(r)||(n=r.trim())}return{type:"heading",raw:e[0],depth:e[1].length,text:n,tokens:this.lexer.inline(n)}}},n.hr=function(t){var e=this.rules.block.hr.exec(t);if(e)return{type:"hr",raw:e[0]}},n.blockquote=function(t){var e=this.rules.block.blockquote.exec(t);if(e){var n=e[0].replace(/^ *>[ \t]?/gm,""),r=this.lexer.state.top;this.lexer.state.top=!0;var i=this.lexer.blockTokens(n);return this.lexer.state.top=r,{type:"blockquote",raw:e[0],tokens:i,text:n}}},n.list=function(t){var e=this.rules.block.list.exec(t);if(e){var n,r,i,a,o,s,l,u,c,f,h,p,d=e[1].trim(),m=d.length>1,g={type:"list",raw:"",ordered:m,start:m?+d.slice(0,-1):"",loose:!1,items:[]};d=m?"\\d{1,9}\\"+d.slice(-1):"\\"+d,this.options.pedantic&&(d=m?d:"[*+-]");var v=new RegExp("^( {0,3}"+d+")((?:[\t ][^\\n]*)?(?:\\n|$))");while(t){if(p=!1,!(e=v.exec(t)))break;if(this.rules.block.hr.test(t))break;if(n=e[0],t=t.substring(n.length),u=e[2].split("\n",1)[0].replace(/^\t+/,(function(t){return" ".repeat(3*t.length)})),c=t.split("\n",1)[0],this.options.pedantic?(a=2,h=u.trimLeft()):(a=e[2].search(/[^ ]/),a=a>4?1:a,h=u.slice(a),a+=e[1].length),s=!1,!u&&/^ *$/.test(c)&&(n+=c+"\n",t=t.substring(c.length+1),p=!0),!p){var b=new RegExp("^ {0,"+Math.min(3,a-1)+"}(?:[*+-]|\\d{1,9}[.)])((?:[ \t][^\\n]*)?(?:\\n|$))"),y=new RegExp("^ {0,"+Math.min(3,a-1)+"}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)"),w=new RegExp("^ {0,"+Math.min(3,a-1)+"}(?:```|~~~)"),_=new RegExp("^ {0,"+Math.min(3,a-1)+"}#");while(t){if(f=t.split("\n",1)[0],c=f,this.options.pedantic&&(c=c.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),w.test(c))break;if(_.test(c))break;if(b.test(c))break;if(y.test(t))break;if(c.search(/[^ ]/)>=a||!c.trim())h+="\n"+c.slice(a);else{if(s)break;if(u.search(/[^ ]/)>=4)break;if(w.test(u))break;if(_.test(u))break;if(y.test(u))break;h+="\n"+c}s||c.trim()||(s=!0),n+=f+"\n",t=t.substring(f.length+1),u=c.slice(a)}}g.loose||(l?g.loose=!0:/\n *\n *$/.test(n)&&(l=!0)),this.options.gfm&&(r=/^\[[ xX]\] /.exec(h),r&&(i="[ ] "!==r[0],h=h.replace(/^\[[ xX]\] +/,""))),g.items.push({type:"list_item",raw:n,task:!!r,checked:i,loose:!1,text:h}),g.raw+=n}g.items[g.items.length-1].raw=n.trimRight(),g.items[g.items.length-1].text=h.trimRight(),g.raw=g.raw.trimRight();var k=g.items.length;for(o=0;o<k;o++)if(this.lexer.state.top=!1,g.items[o].tokens=this.lexer.blockTokens(g.items[o].text,[]),!g.loose){var D=g.items[o].tokens.filter((function(t){return"space"===t.type})),x=D.length>0&&D.some((function(t){return/\n.*\n/.test(t.raw)}));g.loose=x}if(g.loose)for(o=0;o<k;o++)g.items[o].loose=!0;return g}},n.html=function(t){var e=this.rules.block.html.exec(t);if(e){var n={type:"html",raw:e[0],pre:!this.options.sanitizer&&("pre"===e[1]||"script"===e[1]||"style"===e[1]),text:e[0]};if(this.options.sanitize){var r=this.options.sanitizer?this.options.sanitizer(e[0]):v(e[0]);n.type="paragraph",n.text=r,n.tokens=this.lexer.inline(r)}return n}},n.def=function(t){var e=this.rules.block.def.exec(t);if(e){var n=e[1].toLowerCase().replace(/\s+/g," "),r=e[2]?e[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline._escapes,"$1"):"",i=e[3]?e[3].substring(1,e[3].length-1).replace(this.rules.inline._escapes,"$1"):e[3];return{type:"def",tag:n,raw:e[0],href:r,title:i}}},n.table=function(t){var e=this.rules.block.table.exec(t);if(e){var n={type:"table",header:A(e[1]).map((function(t){return{text:t}})),align:e[2].replace(/^ *|\| *$/g,"").split(/ *\| */),rows:e[3]&&e[3].trim()?e[3].replace(/\n[ \t]*$/,"").split("\n"):[]};if(n.header.length===n.align.length){n.raw=e[0];var r,i,a,o,s=n.align.length;for(r=0;r<s;r++)/^ *-+: *$/.test(n.align[r])?n.align[r]="right":/^ *:-+: *$/.test(n.align[r])?n.align[r]="center":/^ *:-+ *$/.test(n.align[r])?n.align[r]="left":n.align[r]=null;for(s=n.rows.length,r=0;r<s;r++)n.rows[r]=A(n.rows[r],n.header.length).map((function(t){return{text:t}}));for(s=n.header.length,i=0;i<s;i++)n.header[i].tokens=this.lexer.inline(n.header[i].text);for(s=n.rows.length,i=0;i<s;i++)for(o=n.rows[i],a=0;a<o.length;a++)o[a].tokens=this.lexer.inline(o[a].text);return n}}},n.lheading=function(t){var e=this.rules.block.lheading.exec(t);if(e)return{type:"heading",raw:e[0],depth:"="===e[2].charAt(0)?1:2,text:e[1],tokens:this.lexer.inline(e[1])}},n.paragraph=function(t){var e=this.rules.block.paragraph.exec(t);if(e){var n="\n"===e[1].charAt(e[1].length-1)?e[1].slice(0,-1):e[1];return{type:"paragraph",raw:e[0],text:n,tokens:this.lexer.inline(n)}}},n.text=function(t){var e=this.rules.block.text.exec(t);if(e)return{type:"text",raw:e[0],text:e[0],tokens:this.lexer.inline(e[0])}},n.escape=function(t){var e=this.rules.inline.escape.exec(t);if(e)return{type:"escape",raw:e[0],text:v(e[1])}},n.tag=function(t){var e=this.rules.inline.tag.exec(t);if(e)return!this.lexer.state.inLink&&/^<a /i.test(e[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(e[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(e[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(e[0])&&(this.lexer.state.inRawBlock=!1),{type:this.options.sanitize?"text":"html",raw:e[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,text:this.options.sanitize?this.options.sanitizer?this.options.sanitizer(e[0]):v(e[0]):e[0]}},n.link=function(t){var e=this.rules.inline.link.exec(t);if(e){var n=e[2].trim();if(!this.options.pedantic&&/^</.test(n)){if(!/>$/.test(n))return;var r=j(n.slice(0,-1),"\\");if((n.length-r.length)%2===0)return}else{var i=F(e[2],"()");if(i>-1){var a=0===e[0].indexOf("!")?5:4,o=a+e[1].length+i;e[2]=e[2].substring(0,i),e[0]=e[0].substring(0,o).trim(),e[3]=""}}var s=e[2],l="";if(this.options.pedantic){var u=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(s);u&&(s=u[1],l=u[3])}else l=e[3]?e[3].slice(1,-1):"";return s=s.trim(),/^</.test(s)&&(s=this.options.pedantic&&!/>$/.test(n)?s.slice(1):s.slice(1,-1)),I(e,{href:s?s.replace(this.rules.inline._escapes,"$1"):s,title:l?l.replace(this.rules.inline._escapes,"$1"):l},e[0],this.lexer)}},n.reflink=function(t,e){var n;if((n=this.rules.inline.reflink.exec(t))||(n=this.rules.inline.nolink.exec(t))){var r=(n[2]||n[1]).replace(/\s+/g," ");if(r=e[r.toLowerCase()],!r){var i=n[0].charAt(0);return{type:"text",raw:i,text:i}}return I(n,r,n[0],this.lexer)}},n.emStrong=function(t,e,n){void 0===n&&(n="");var r=this.rules.inline.emStrong.lDelim.exec(t);if(r&&(!r[3]||!n.match(/(?:[0-9A-Za-z\xAA\xB2\xB3\xB5\xB9\xBA\xBC-\xBE\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u0660-\u0669\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07C0-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0966-\u096F\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09E6-\u09F1\u09F4-\u09F9\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A66-\u0A6F\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AE6-\u0AEF\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B66-\u0B6F\u0B71-\u0B77\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0BE6-\u0BF2\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C66-\u0C6F\u0C78-\u0C7E\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CE6-\u0CEF\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D58-\u0D61\u0D66-\u0D78\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0DE6-\u0DEF\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E50-\u0E59\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0ED0-\u0ED9\u0EDC-\u0EDF\u0F00\u0F20-\u0F33\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F-\u1049\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u1090-\u1099\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1369-\u137C\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u17E0-\u17E9\u17F0-\u17F9\u1810-\u1819\u1820-\u1878\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1946-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u19D0-\u19DA\u1A00-\u1A16\u1A20-\u1A54\u1A80-\u1A89\u1A90-\u1A99\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B50-\u1B59\u1B83-\u1BA0\u1BAE-\u1BE5\u1C00-\u1C23\u1C40-\u1C49\u1C4D-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2070\u2071\u2074-\u2079\u207F-\u2089\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2150-\u2189\u2460-\u249B\u24EA-\u24FF\u2776-\u2793\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2CFD\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u3192-\u3195\u31A0-\u31BF\u31F0-\u31FF\u3220-\u3229\u3248-\u324F\u3251-\u325F\u3280-\u3289\u32B1-\u32BF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA830-\uA835\uA840-\uA873\uA882-\uA8B3\uA8D0-\uA8D9\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA900-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF-\uA9D9\uA9E0-\uA9E4\uA9E6-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA50-\uAA59\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uABF0-\uABF9\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]|\uD800[\uDC00-\uDC0B\uDC0D-\uDC26\uDC28-\uDC3A\uDC3C\uDC3D\uDC3F-\uDC4D\uDC50-\uDC5D\uDC80-\uDCFA\uDD07-\uDD33\uDD40-\uDD78\uDD8A\uDD8B\uDE80-\uDE9C\uDEA0-\uDED0\uDEE1-\uDEFB\uDF00-\uDF23\uDF2D-\uDF4A\uDF50-\uDF75\uDF80-\uDF9D\uDFA0-\uDFC3\uDFC8-\uDFCF\uDFD1-\uDFD5]|\uD801[\uDC00-\uDC9D\uDCA0-\uDCA9\uDCB0-\uDCD3\uDCD8-\uDCFB\uDD00-\uDD27\uDD30-\uDD63\uDD70-\uDD7A\uDD7C-\uDD8A\uDD8C-\uDD92\uDD94\uDD95\uDD97-\uDDA1\uDDA3-\uDDB1\uDDB3-\uDDB9\uDDBB\uDDBC\uDE00-\uDF36\uDF40-\uDF55\uDF60-\uDF67\uDF80-\uDF85\uDF87-\uDFB0\uDFB2-\uDFBA]|\uD802[\uDC00-\uDC05\uDC08\uDC0A-\uDC35\uDC37\uDC38\uDC3C\uDC3F-\uDC55\uDC58-\uDC76\uDC79-\uDC9E\uDCA7-\uDCAF\uDCE0-\uDCF2\uDCF4\uDCF5\uDCFB-\uDD1B\uDD20-\uDD39\uDD80-\uDDB7\uDDBC-\uDDCF\uDDD2-\uDE00\uDE10-\uDE13\uDE15-\uDE17\uDE19-\uDE35\uDE40-\uDE48\uDE60-\uDE7E\uDE80-\uDE9F\uDEC0-\uDEC7\uDEC9-\uDEE4\uDEEB-\uDEEF\uDF00-\uDF35\uDF40-\uDF55\uDF58-\uDF72\uDF78-\uDF91\uDFA9-\uDFAF]|\uD803[\uDC00-\uDC48\uDC80-\uDCB2\uDCC0-\uDCF2\uDCFA-\uDD23\uDD30-\uDD39\uDE60-\uDE7E\uDE80-\uDEA9\uDEB0\uDEB1\uDF00-\uDF27\uDF30-\uDF45\uDF51-\uDF54\uDF70-\uDF81\uDFB0-\uDFCB\uDFE0-\uDFF6]|\uD804[\uDC03-\uDC37\uDC52-\uDC6F\uDC71\uDC72\uDC75\uDC83-\uDCAF\uDCD0-\uDCE8\uDCF0-\uDCF9\uDD03-\uDD26\uDD36-\uDD3F\uDD44\uDD47\uDD50-\uDD72\uDD76\uDD83-\uDDB2\uDDC1-\uDDC4\uDDD0-\uDDDA\uDDDC\uDDE1-\uDDF4\uDE00-\uDE11\uDE13-\uDE2B\uDE80-\uDE86\uDE88\uDE8A-\uDE8D\uDE8F-\uDE9D\uDE9F-\uDEA8\uDEB0-\uDEDE\uDEF0-\uDEF9\uDF05-\uDF0C\uDF0F\uDF10\uDF13-\uDF28\uDF2A-\uDF30\uDF32\uDF33\uDF35-\uDF39\uDF3D\uDF50\uDF5D-\uDF61]|\uD805[\uDC00-\uDC34\uDC47-\uDC4A\uDC50-\uDC59\uDC5F-\uDC61\uDC80-\uDCAF\uDCC4\uDCC5\uDCC7\uDCD0-\uDCD9\uDD80-\uDDAE\uDDD8-\uDDDB\uDE00-\uDE2F\uDE44\uDE50-\uDE59\uDE80-\uDEAA\uDEB8\uDEC0-\uDEC9\uDF00-\uDF1A\uDF30-\uDF3B\uDF40-\uDF46]|\uD806[\uDC00-\uDC2B\uDCA0-\uDCF2\uDCFF-\uDD06\uDD09\uDD0C-\uDD13\uDD15\uDD16\uDD18-\uDD2F\uDD3F\uDD41\uDD50-\uDD59\uDDA0-\uDDA7\uDDAA-\uDDD0\uDDE1\uDDE3\uDE00\uDE0B-\uDE32\uDE3A\uDE50\uDE5C-\uDE89\uDE9D\uDEB0-\uDEF8]|\uD807[\uDC00-\uDC08\uDC0A-\uDC2E\uDC40\uDC50-\uDC6C\uDC72-\uDC8F\uDD00-\uDD06\uDD08\uDD09\uDD0B-\uDD30\uDD46\uDD50-\uDD59\uDD60-\uDD65\uDD67\uDD68\uDD6A-\uDD89\uDD98\uDDA0-\uDDA9\uDEE0-\uDEF2\uDFB0\uDFC0-\uDFD4]|\uD808[\uDC00-\uDF99]|\uD809[\uDC00-\uDC6E\uDC80-\uDD43]|\uD80B[\uDF90-\uDFF0]|[\uD80C\uD81C-\uD820\uD822\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD80D[\uDC00-\uDC2E]|\uD811[\uDC00-\uDE46]|\uD81A[\uDC00-\uDE38\uDE40-\uDE5E\uDE60-\uDE69\uDE70-\uDEBE\uDEC0-\uDEC9\uDED0-\uDEED\uDF00-\uDF2F\uDF40-\uDF43\uDF50-\uDF59\uDF5B-\uDF61\uDF63-\uDF77\uDF7D-\uDF8F]|\uD81B[\uDE40-\uDE96\uDF00-\uDF4A\uDF50\uDF93-\uDF9F\uDFE0\uDFE1\uDFE3]|\uD821[\uDC00-\uDFF7]|\uD823[\uDC00-\uDCD5\uDD00-\uDD08]|\uD82B[\uDFF0-\uDFF3\uDFF5-\uDFFB\uDFFD\uDFFE]|\uD82C[\uDC00-\uDD22\uDD50-\uDD52\uDD64-\uDD67\uDD70-\uDEFB]|\uD82F[\uDC00-\uDC6A\uDC70-\uDC7C\uDC80-\uDC88\uDC90-\uDC99]|\uD834[\uDEE0-\uDEF3\uDF60-\uDF78]|\uD835[\uDC00-\uDC54\uDC56-\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDEA5\uDEA8-\uDEC0\uDEC2-\uDEDA\uDEDC-\uDEFA\uDEFC-\uDF14\uDF16-\uDF34\uDF36-\uDF4E\uDF50-\uDF6E\uDF70-\uDF88\uDF8A-\uDFA8\uDFAA-\uDFC2\uDFC4-\uDFCB\uDFCE-\uDFFF]|\uD837[\uDF00-\uDF1E]|\uD838[\uDD00-\uDD2C\uDD37-\uDD3D\uDD40-\uDD49\uDD4E\uDE90-\uDEAD\uDEC0-\uDEEB\uDEF0-\uDEF9]|\uD839[\uDFE0-\uDFE6\uDFE8-\uDFEB\uDFED\uDFEE\uDFF0-\uDFFE]|\uD83A[\uDC00-\uDCC4\uDCC7-\uDCCF\uDD00-\uDD43\uDD4B\uDD50-\uDD59]|\uD83B[\uDC71-\uDCAB\uDCAD-\uDCAF\uDCB1-\uDCB4\uDD01-\uDD2D\uDD2F-\uDD3D\uDE00-\uDE03\uDE05-\uDE1F\uDE21\uDE22\uDE24\uDE27\uDE29-\uDE32\uDE34-\uDE37\uDE39\uDE3B\uDE42\uDE47\uDE49\uDE4B\uDE4D-\uDE4F\uDE51\uDE52\uDE54\uDE57\uDE59\uDE5B\uDE5D\uDE5F\uDE61\uDE62\uDE64\uDE67-\uDE6A\uDE6C-\uDE72\uDE74-\uDE77\uDE79-\uDE7C\uDE7E\uDE80-\uDE89\uDE8B-\uDE9B\uDEA1-\uDEA3\uDEA5-\uDEA9\uDEAB-\uDEBB]|\uD83C[\uDD00-\uDD0C]|\uD83E[\uDFF0-\uDFF9]|\uD869[\uDC00-\uDEDF\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF38\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD87E[\uDC00-\uDE1D]|\uD884[\uDC00-\uDF4A])/))){var i=r[1]||r[2]||"";if(!i||i&&(""===n||this.rules.inline.punctuation.exec(n))){var a,o,s=r[0].length-1,l=s,u=0,c="*"===r[0][0]?this.rules.inline.emStrong.rDelimAst:this.rules.inline.emStrong.rDelimUnd;c.lastIndex=0,e=e.slice(-1*t.length+s);while(null!=(r=c.exec(e)))if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],a)if(o=a.length,r[3]||r[4])l+=o;else if(!((r[5]||r[6])&&s%3)||(s+o)%3){if(l-=o,!(l>0)){o=Math.min(o,o+l+u);var f=t.slice(0,s+r.index+(r[0].length-a.length)+o);if(Math.min(s,o)%2){var h=f.slice(1,-1);return{type:"em",raw:f,text:h,tokens:this.lexer.inlineTokens(h)}}var p=f.slice(2,-2);return{type:"strong",raw:f,text:p,tokens:this.lexer.inlineTokens(p)}}}else u+=o}}},n.codespan=function(t){var e=this.rules.inline.code.exec(t);if(e){var n=e[2].replace(/\n/g," "),r=/[^ ]/.test(n),i=/^ /.test(n)&&/ $/.test(n);return r&&i&&(n=n.substring(1,n.length-1)),n=v(n,!0),{type:"codespan",raw:e[0],text:n}}},n.br=function(t){var e=this.rules.inline.br.exec(t);if(e)return{type:"br",raw:e[0]}},n.del=function(t){var e=this.rules.inline.del.exec(t);if(e)return{type:"del",raw:e[0],text:e[2],tokens:this.lexer.inlineTokens(e[2])}},n.autolink=function(t,e){var n,r,i=this.rules.inline.autolink.exec(t);if(i)return"@"===i[2]?(n=v(this.options.mangle?e(i[1]):i[1]),r="mailto:"+n):(n=v(i[1]),r=n),{type:"link",raw:i[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}},n.url=function(t,e){var n;if(n=this.rules.inline.url.exec(t)){var r,i;if("@"===n[2])r=v(this.options.mangle?e(n[0]):n[0]),i="mailto:"+r;else{var a;do{a=n[0],n[0]=this.rules.inline._backpedal.exec(n[0])[0]}while(a!==n[0]);r=v(n[0]),i="www."===n[1]?"http://"+n[0]:n[0]}return{type:"link",raw:n[0],text:r,href:i,tokens:[{type:"text",raw:r,text:r}]}}},n.inlineText=function(t,e){var n,r=this.rules.inline.text.exec(t);if(r)return n=this.lexer.state.inRawBlock?this.options.sanitize?this.options.sanitizer?this.options.sanitizer(r[0]):v(r[0]):r[0]:v(this.options.smartypants?e(r[0]):r[0]),{type:"text",raw:r[0],text:n}},e}(),B={newline:/^(?: *(?:\n|$))+/,code:/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,fences:/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,hr:/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,heading:/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/,html:"^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))",def:/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/,table:E,lheading:/^((?:.|\n(?!\n))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,_paragraph:/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,text:/^[^\n]+/,_label:/(?!\s*\])(?:\\.|[^\[\]\\])+/,_title:/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/};B.def=_(B.def).replace("label",B._label).replace("title",B._title).getRegex(),B.bullet=/(?:[*+-]|\d{1,9}[.)])/,B.listItemStart=_(/^( *)(bull) */).replace("bull",B.bullet).getRegex(),B.list=_(B.list).replace(/bull/g,B.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+B.def.source+")").getRegex(),B._tag="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",B._comment=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,B.html=_(B.html,"i").replace("comment",B._comment).replace("tag",B._tag).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),B.paragraph=_(B._paragraph).replace("hr",B.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",B._tag).getRegex(),B.blockquote=_(B.blockquote).replace("paragraph",B.paragraph).getRegex(),B.normal=r({},B),B.gfm=r({},B.normal,{table:"^ *([^\\n ].*\\|.*)\\n {0,3}(?:\\| *)?(:?-+:? *(?:\\| *:?-+:? *)*)(?:\\| *)?(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)"}),B.gfm.table=_(B.gfm.table).replace("hr",B.hr).replace("heading"," {0,3}#{1,6} ").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",B._tag).getRegex(),B.gfm.paragraph=_(B._paragraph).replace("hr",B.hr).replace("heading"," {0,3}#{1,6} ").replace("|lheading","").replace("table",B.gfm.table).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",B._tag).getRegex(),B.pedantic=r({},B.normal,{html:_("^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\s[^'\"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))").replace("comment",B._comment).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:E,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:_(B.normal._paragraph).replace("hr",B.hr).replace("heading"," *#{1,6} *[^\n]").replace("lheading",B.lheading).replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").getRegex()});var z={escape:/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:E,tag:"^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",link:/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/,reflink:/^!?\[(label)\]\[(ref)\]/,nolink:/^!?\[(ref)\](?:\[\])?/,reflinkSearch:"reflink|nolink(?!\\()",emStrong:{lDelim:/^(?:\*+(?:([punct_])|[^\s*]))|^_+(?:([punct*])|([^\s_]))/,rDelimAst:/^(?:[^_*\\]|\\.)*?\_\_(?:[^_*\\]|\\.)*?\*(?:[^_*\\]|\\.)*?(?=\_\_)|(?:[^*\\]|\\.)+(?=[^*])|[punct_](\*+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\*+)(?=[punct_\s]|$)|[punct_\s](\*+)(?=[^punct*_\s])|[\s](\*+)(?=[punct_])|[punct_](\*+)(?=[punct_])|(?:[^punct*_\s\\]|\\.)(\*+)(?=[^punct*_\s])/,rDelimUnd:/^(?:[^_*\\]|\\.)*?\*\*(?:[^_*\\]|\\.)*?\_(?:[^_*\\]|\\.)*?(?=\*\*)|(?:[^_\\]|\\.)+(?=[^_])|[punct*](\_+)(?=[\s]|$)|(?:[^punct*_\s\\]|\\.)(\_+)(?=[punct*\s]|$)|[punct*\s](\_+)(?=[^punct*_\s])|[\s](\_+)(?=[punct*])|[punct*](\_+)(?=[punct*])/},code:/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,br:/^( {2,}|\\)\n(?!\s*$)/,del:E,text:/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,punctuation:/^([\spunctuation])/};function M(t){return t.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…")}function Q(t){var e,n,r="",i=t.length;for(e=0;e<i;e++)n=t.charCodeAt(e),Math.random()>.5&&(n="x"+n.toString(16)),r+="&#"+n+";";return r}z._punctuation="!\"#$%&'()+\\-.,/:;<=>?@\\[\\]`^{|}~",z.punctuation=_(z.punctuation).replace(/punctuation/g,z._punctuation).getRegex(),z.blockSkip=/\[[^\]]*?\]\([^\)]*?\)|`[^`]*?`|<[^>]*?>/g,z.escapedEmSt=/(?:^|[^\\])(?:\\\\)*\\[*_]/g,z._comment=_(B._comment).replace("(?:--\x3e|$)","--\x3e").getRegex(),z.emStrong.lDelim=_(z.emStrong.lDelim).replace(/punct/g,z._punctuation).getRegex(),z.emStrong.rDelimAst=_(z.emStrong.rDelimAst,"g").replace(/punct/g,z._punctuation).getRegex(),z.emStrong.rDelimUnd=_(z.emStrong.rDelimUnd,"g").replace(/punct/g,z._punctuation).getRegex(),z._escapes=/\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/g,z._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,z._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,z.autolink=_(z.autolink).replace("scheme",z._scheme).replace("email",z._email).getRegex(),z._attribute=/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/,z.tag=_(z.tag).replace("comment",z._comment).replace("attribute",z._attribute).getRegex(),z._label=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,z._href=/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/,z._title=/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/,z.link=_(z.link).replace("label",z._label).replace("href",z._href).replace("title",z._title).getRegex(),z.reflink=_(z.reflink).replace("label",z._label).replace("ref",B._label).getRegex(),z.nolink=_(z.nolink).replace("ref",B._label).getRegex(),z.reflinkSearch=_(z.reflinkSearch,"g").replace("reflink",z.reflink).replace("nolink",z.nolink).getRegex(),z.normal=r({},z),z.pedantic=r({},z.normal,{strong:{start:/^__|\*\*/,middle:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,endAst:/\*\*(?!\*)/g,endUnd:/__(?!_)/g},em:{start:/^_|\*/,middle:/^()\*(?=\S)([\s\S]*?\S)\*(?!\*)|^_(?=\S)([\s\S]*?\S)_(?!_)/,endAst:/\*(?!\*)/g,endUnd:/_(?!_)/g},link:_(/^!?\[(label)\]\((.*?)\)/).replace("label",z._label).getRegex(),reflink:_(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",z._label).getRegex()}),z.gfm=r({},z.normal,{escape:_(z.escape).replace("])","~|])").getRegex(),_extended_email:/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/,url:/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/}),z.gfm.url=_(z.gfm.url,"i").replace("email",z.gfm._extended_email).getRegex(),z.breaks=r({},z.gfm,{br:_(z.br).replace("{2,}","*").getRegex(),text:_(z.gfm.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()});var G=function(){function e(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||t.defaults,this.options.tokenizer=this.options.tokenizer||new P,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};var n={block:B.normal,inline:z.normal};this.options.pedantic?(n.block=B.pedantic,n.inline=z.pedantic):this.options.gfm&&(n.block=B.gfm,this.options.breaks?n.inline=z.breaks:n.inline=z.gfm),this.tokenizer.rules=n}e.lex=function(t,n){var r=new e(n);return r.lex(t)},e.lexInline=function(t,n){var r=new e(n);return r.inlineTokens(t)};var r=e.prototype;return r.lex=function(t){var e;t=t.replace(/\r\n|\r/g,"\n"),this.blockTokens(t,this.tokens);while(e=this.inlineQueue.shift())this.inlineTokens(e.src,e.tokens);return this.tokens},r.blockTokens=function(t,e){var n,r,i,a,o=this;void 0===e&&(e=[]),t=this.options.pedantic?t.replace(/\t/g,"    ").replace(/^ +$/gm,""):t.replace(/^( *)(\t+)/gm,(function(t,e,n){return e+"    ".repeat(n.length)}));while(t)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some((function(r){return!!(n=r.call({lexer:o},t,e))&&(t=t.substring(n.raw.length),e.push(n),!0)}))))if(n=this.tokenizer.space(t))t=t.substring(n.raw.length),1===n.raw.length&&e.length>0?e[e.length-1].raw+="\n":e.push(n);else if(n=this.tokenizer.code(t))t=t.substring(n.raw.length),r=e[e.length-1],!r||"paragraph"!==r.type&&"text"!==r.type?e.push(n):(r.raw+="\n"+n.raw,r.text+="\n"+n.text,this.inlineQueue[this.inlineQueue.length-1].src=r.text);else if(n=this.tokenizer.fences(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.heading(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.hr(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.blockquote(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.list(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.html(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.def(t))t=t.substring(n.raw.length),r=e[e.length-1],!r||"paragraph"!==r.type&&"text"!==r.type?this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title}):(r.raw+="\n"+n.raw,r.text+="\n"+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=r.text);else if(n=this.tokenizer.table(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.lheading(t))t=t.substring(n.raw.length),e.push(n);else if(i=t,this.options.extensions&&this.options.extensions.startBlock&&function(){var e=1/0,n=t.slice(1),r=void 0;o.options.extensions.startBlock.forEach((function(t){r=t.call({lexer:this},n),"number"===typeof r&&r>=0&&(e=Math.min(e,r))})),e<1/0&&e>=0&&(i=t.substring(0,e+1))}(),this.state.top&&(n=this.tokenizer.paragraph(i)))r=e[e.length-1],a&&"paragraph"===r.type?(r.raw+="\n"+n.raw,r.text+="\n"+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):e.push(n),a=i.length!==t.length,t=t.substring(n.raw.length);else if(n=this.tokenizer.text(t))t=t.substring(n.raw.length),r=e[e.length-1],r&&"text"===r.type?(r.raw+="\n"+n.raw,r.text+="\n"+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):e.push(n);else if(t){var s="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(s);break}throw new Error(s)}return this.state.top=!0,e},r.inline=function(t,e){return void 0===e&&(e=[]),this.inlineQueue.push({src:t,tokens:e}),e},r.inlineTokens=function(t,e){var n,r,i,a=this;void 0===e&&(e=[]);var o,s,l,u=t;if(this.tokens.links){var c=Object.keys(this.tokens.links);if(c.length>0)while(null!=(o=this.tokenizer.rules.inline.reflinkSearch.exec(u)))c.includes(o[0].slice(o[0].lastIndexOf("[")+1,-1))&&(u=u.slice(0,o.index)+"["+N("a",o[0].length-2)+"]"+u.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}while(null!=(o=this.tokenizer.rules.inline.blockSkip.exec(u)))u=u.slice(0,o.index)+"["+N("a",o[0].length-2)+"]"+u.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);while(null!=(o=this.tokenizer.rules.inline.escapedEmSt.exec(u)))u=u.slice(0,o.index+o[0].length-2)+"++"+u.slice(this.tokenizer.rules.inline.escapedEmSt.lastIndex),this.tokenizer.rules.inline.escapedEmSt.lastIndex--;while(t)if(s||(l=""),s=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some((function(r){return!!(n=r.call({lexer:a},t,e))&&(t=t.substring(n.raw.length),e.push(n),!0)}))))if(n=this.tokenizer.escape(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.tag(t))t=t.substring(n.raw.length),r=e[e.length-1],r&&"text"===n.type&&"text"===r.type?(r.raw+=n.raw,r.text+=n.text):e.push(n);else if(n=this.tokenizer.link(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.reflink(t,this.tokens.links))t=t.substring(n.raw.length),r=e[e.length-1],r&&"text"===n.type&&"text"===r.type?(r.raw+=n.raw,r.text+=n.text):e.push(n);else if(n=this.tokenizer.emStrong(t,u,l))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.codespan(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.br(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.del(t))t=t.substring(n.raw.length),e.push(n);else if(n=this.tokenizer.autolink(t,Q))t=t.substring(n.raw.length),e.push(n);else if(this.state.inLink||!(n=this.tokenizer.url(t,Q))){if(i=t,this.options.extensions&&this.options.extensions.startInline&&function(){var e=1/0,n=t.slice(1),r=void 0;a.options.extensions.startInline.forEach((function(t){r=t.call({lexer:this},n),"number"===typeof r&&r>=0&&(e=Math.min(e,r))})),e<1/0&&e>=0&&(i=t.substring(0,e+1))}(),n=this.tokenizer.inlineText(i,M))t=t.substring(n.raw.length),"_"!==n.raw.slice(-1)&&(l=n.raw.slice(-1)),s=!0,r=e[e.length-1],r&&"text"===r.type?(r.raw+=n.raw,r.text+=n.text):e.push(n);else if(t){var f="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(f);break}throw new Error(f)}}else t=t.substring(n.raw.length),e.push(n);return e},n(e,null,[{key:"rules",get:function(){return{block:B,inline:z}}}]),e}(),R=function(){function e(e){this.options=e||t.defaults}var n=e.prototype;return n.code=function(t,e,n){var r=(e||"").match(/\S*/)[0];if(this.options.highlight){var i=this.options.highlight(t,r);null!=i&&i!==t&&(n=!0,t=i)}return t=t.replace(/\n$/,"")+"\n",r?'<pre><code class="'+this.options.langPrefix+v(r)+'">'+(n?t:v(t,!0))+"</code></pre>\n":"<pre><code>"+(n?t:v(t,!0))+"</code></pre>\n"},n.blockquote=function(t){return"<blockquote>\n"+t+"</blockquote>\n"},n.html=function(t){return t},n.heading=function(t,e,n,r){if(this.options.headerIds){var i=this.options.headerPrefix+r.slug(n);return"<h"+e+' id="'+i+'">'+t+"</h"+e+">\n"}return"<h"+e+">"+t+"</h"+e+">\n"},n.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},n.list=function(t,e,n){var r=e?"ol":"ul",i=e&&1!==n?' start="'+n+'"':"";return"<"+r+i+">\n"+t+"</"+r+">\n"},n.listitem=function(t){return"<li>"+t+"</li>\n"},n.checkbox=function(t){return"<input "+(t?'checked="" ':"")+'disabled="" type="checkbox"'+(this.options.xhtml?" /":"")+"> "},n.paragraph=function(t){return"<p>"+t+"</p>\n"},n.table=function(t,e){return e&&(e="<tbody>"+e+"</tbody>"),"<table>\n<thead>\n"+t+"</thead>\n"+e+"</table>\n"},n.tablerow=function(t){return"<tr>\n"+t+"</tr>\n"},n.tablecell=function(t,e){var n=e.header?"th":"td",r=e.align?"<"+n+' align="'+e.align+'">':"<"+n+">";return r+t+"</"+n+">\n"},n.strong=function(t){return"<strong>"+t+"</strong>"},n.em=function(t){return"<em>"+t+"</em>"},n.codespan=function(t){return"<code>"+t+"</code>"},n.br=function(){return this.options.xhtml?"<br/>":"<br>"},n.del=function(t){return"<del>"+t+"</del>"},n.link=function(t,e,n){if(t=x(this.options.sanitize,this.options.baseUrl,t),null===t)return n;var r='<a href="'+t+'"';return e&&(r+=' title="'+e+'"'),r+=">"+n+"</a>",r},n.image=function(t,e,n){if(t=x(this.options.sanitize,this.options.baseUrl,t),null===t)return n;var r='<img src="'+t+'" alt="'+n+'"';return e&&(r+=' title="'+e+'"'),r+=this.options.xhtml?"/>":">",r},n.text=function(t){return t},e}(),H=function(){function t(){}var e=t.prototype;return e.strong=function(t){return t},e.em=function(t){return t},e.codespan=function(t){return t},e.del=function(t){return t},e.html=function(t){return t},e.text=function(t){return t},e.link=function(t,e,n){return""+n},e.image=function(t,e,n){return""+n},e.br=function(){return""},t}(),U=function(){function t(){this.seen={}}var e=t.prototype;return e.serialize=function(t){return t.toLowerCase().trim().replace(/<[!\/a-z].*?>/gi,"").replace(/[\u2000-\u206F\u2E00-\u2E7F\\'!"#$%&()*+,./:;<=>?@[\]^`{|}~]/g,"").replace(/\s/g,"-")},e.getNextSafeSlug=function(t,e){var n=t,r=0;if(this.seen.hasOwnProperty(n)){r=this.seen[t];do{r++,n=t+"-"+r}while(this.seen.hasOwnProperty(n))}return e||(this.seen[t]=r,this.seen[n]=0),n},e.slug=function(t,e){void 0===e&&(e={});var n=this.serialize(t);return this.getNextSafeSlug(n,e.dryrun)},t}(),Y=function(){function e(e){this.options=e||t.defaults,this.options.renderer=this.options.renderer||new R,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new H,this.slugger=new U}e.parse=function(t,n){var r=new e(n);return r.parse(t)},e.parseInline=function(t,n){var r=new e(n);return r.parseInline(t)};var n=e.prototype;return n.parse=function(t,e){void 0===e&&(e=!0);var n,r,i,a,o,s,l,u,c,f,h,p,d,m,g,v,b,w,_,k="",D=t.length;for(n=0;n<D;n++)if(f=t[n],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[f.type]&&(_=this.options.extensions.renderers[f.type].call({parser:this},f),!1!==_||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(f.type)))k+=_||"";else switch(f.type){case"space":continue;case"hr":k+=this.renderer.hr();continue;case"heading":k+=this.renderer.heading(this.parseInline(f.tokens),f.depth,y(this.parseInline(f.tokens,this.textRenderer)),this.slugger);continue;case"code":k+=this.renderer.code(f.text,f.lang,f.escaped);continue;case"table":for(u="",l="",a=f.header.length,r=0;r<a;r++)l+=this.renderer.tablecell(this.parseInline(f.header[r].tokens),{header:!0,align:f.align[r]});for(u+=this.renderer.tablerow(l),c="",a=f.rows.length,r=0;r<a;r++){for(s=f.rows[r],l="",o=s.length,i=0;i<o;i++)l+=this.renderer.tablecell(this.parseInline(s[i].tokens),{header:!1,align:f.align[i]});c+=this.renderer.tablerow(l)}k+=this.renderer.table(u,c);continue;case"blockquote":c=this.parse(f.tokens),k+=this.renderer.blockquote(c);continue;case"list":for(h=f.ordered,p=f.start,d=f.loose,a=f.items.length,c="",r=0;r<a;r++)g=f.items[r],v=g.checked,b=g.task,m="",g.task&&(w=this.renderer.checkbox(v),d?g.tokens.length>0&&"paragraph"===g.tokens[0].type?(g.tokens[0].text=w+" "+g.tokens[0].text,g.tokens[0].tokens&&g.tokens[0].tokens.length>0&&"text"===g.tokens[0].tokens[0].type&&(g.tokens[0].tokens[0].text=w+" "+g.tokens[0].tokens[0].text)):g.tokens.unshift({type:"text",text:w}):m+=w),m+=this.parse(g.tokens,d),c+=this.renderer.listitem(m,b,v);k+=this.renderer.list(c,h,p);continue;case"html":k+=this.renderer.html(f.text);continue;case"paragraph":k+=this.renderer.paragraph(this.parseInline(f.tokens));continue;case"text":c=f.tokens?this.parseInline(f.tokens):f.text;while(n+1<D&&"text"===t[n+1].type)f=t[++n],c+="\n"+(f.tokens?this.parseInline(f.tokens):f.text);k+=e?this.renderer.paragraph(c):c;continue;default:var x='Token with "'+f.type+'" type was not found.';if(this.options.silent)return void console.error(x);throw new Error(x)}return k},n.parseInline=function(t,e){e=e||this.renderer;var n,r,i,a="",o=t.length;for(n=0;n<o;n++)if(r=t[n],this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[r.type]&&(i=this.options.extensions.renderers[r.type].call({parser:this},r),!1!==i||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(r.type)))a+=i||"";else switch(r.type){case"escape":a+=e.text(r.text);break;case"html":a+=e.html(r.text);break;case"link":a+=e.link(r.href,r.title,this.parseInline(r.tokens,e));break;case"image":a+=e.image(r.href,r.title,r.text);break;case"strong":a+=e.strong(this.parseInline(r.tokens,e));break;case"em":a+=e.em(this.parseInline(r.tokens,e));break;case"codespan":a+=e.codespan(r.text);break;case"br":a+=e.br();break;case"del":a+=e.del(this.parseInline(r.tokens,e));break;case"text":a+=e.text(r.text);break;default:var s='Token with "'+r.type+'" type was not found.';if(this.options.silent)return void console.error(s);throw new Error(s)}return a},e}(),V=function(){function e(e){this.options=e||t.defaults}var n=e.prototype;return n.preprocess=function(t){return t},n.postprocess=function(t){return t},e}();function K(t,e,n){return function(r){if(r.message+="\nPlease report this to https://github.com/markedjs/marked.",t){var i="<p>An error occurred:</p><pre>"+v(r.message+"",!0)+"</pre>";return e?Promise.resolve(i):n?void n(null,i):i}if(e)return Promise.reject(r);if(!n)throw r;n(r)}}function W(t,e){return function(n,i,a){"function"===typeof i&&(a=i,i=null);var o=r({},i);i=r({},X.defaults,o);var s=K(i.silent,i.async,a);if("undefined"===typeof n||null===n)return s(new Error("marked(): input parameter is undefined or null"));if("string"!==typeof n)return s(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));if(q(i),i.hooks&&(i.hooks.options=i),a){var l,u=i.highlight;try{i.hooks&&(n=i.hooks.preprocess(n)),l=t(n,i)}catch(d){return s(d)}var c=function(t){var n;if(!t)try{i.walkTokens&&X.walkTokens(l,i.walkTokens),n=e(l,i),i.hooks&&(n=i.hooks.postprocess(n))}catch(d){t=d}return i.highlight=u,t?s(t):a(null,n)};if(!u||u.length<3)return c();if(delete i.highlight,!l.length)return c();var f=0;return X.walkTokens(l,(function(t){"code"===t.type&&(f++,setTimeout((function(){u(t.text,t.lang,(function(e,n){if(e)return c(e);null!=n&&n!==t.text&&(t.text=n,t.escaped=!0),f--,0===f&&c()}))}),0))})),void(0===f&&c())}if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(n):n).then((function(e){return t(e,i)})).then((function(t){return i.walkTokens?Promise.all(X.walkTokens(t,i.walkTokens)).then((function(){return t})):t})).then((function(t){return e(t,i)})).then((function(t){return i.hooks?i.hooks.postprocess(t):t}))["catch"](s);try{i.hooks&&(n=i.hooks.preprocess(n));var h=t(n,i);i.walkTokens&&X.walkTokens(h,i.walkTokens);var p=e(h,i);return i.hooks&&(p=i.hooks.postprocess(p)),p}catch(d){return s(d)}}}function X(t,e,n){return W(G.lex,Y.parse)(t,e,n)}V.passThroughHooks=new Set(["preprocess","postprocess"]),X.options=X.setOptions=function(t){return X.defaults=r({},X.defaults,t),c(X.defaults),X},X.getDefaults=u,X.defaults=t.defaults,X.use=function(){for(var t=X.defaults.extensions||{renderers:{},childTokens:{}},e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];n.forEach((function(e){var n=r({},e);if(n.async=X.defaults.async||n.async||!1,e.extensions&&(e.extensions.forEach((function(e){if(!e.name)throw new Error("extension name required");if(e.renderer){var n=t.renderers[e.name];t.renderers[e.name]=n?function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var a=e.renderer.apply(this,r);return!1===a&&(a=n.apply(this,r)),a}:e.renderer}if(e.tokenizer){if(!e.level||"block"!==e.level&&"inline"!==e.level)throw new Error("extension level must be 'block' or 'inline'");t[e.level]?t[e.level].unshift(e.tokenizer):t[e.level]=[e.tokenizer],e.start&&("block"===e.level?t.startBlock?t.startBlock.push(e.start):t.startBlock=[e.start]:"inline"===e.level&&(t.startInline?t.startInline.push(e.start):t.startInline=[e.start]))}e.childTokens&&(t.childTokens[e.name]=e.childTokens)})),n.extensions=t),e.renderer&&function(){var t=X.defaults.renderer||new R,r=function(n){var r=t[n];t[n]=function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];var s=e.renderer[n].apply(t,a);return!1===s&&(s=r.apply(t,a)),s}};for(var i in e.renderer)r(i);n.renderer=t}(),e.tokenizer&&function(){var t=X.defaults.tokenizer||new P,r=function(n){var r=t[n];t[n]=function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];var s=e.tokenizer[n].apply(t,a);return!1===s&&(s=r.apply(t,a)),s}};for(var i in e.tokenizer)r(i);n.tokenizer=t}(),e.hooks&&function(){var t=X.defaults.hooks||new V,r=function(n){var r=t[n];V.passThroughHooks.has(n)?t[n]=function(i){if(X.defaults.async)return Promise.resolve(e.hooks[n].call(t,i)).then((function(e){return r.call(t,e)}));var a=e.hooks[n].call(t,i);return r.call(t,a)}:t[n]=function(){for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];var s=e.hooks[n].apply(t,a);return!1===s&&(s=r.apply(t,a)),s}};for(var i in e.hooks)r(i);n.hooks=t}(),e.walkTokens){var i=X.defaults.walkTokens;n.walkTokens=function(t){var n=[];return n.push(e.walkTokens.call(this,t)),i&&(n=n.concat(i.call(this,t))),n}}X.setOptions(n)}))},X.walkTokens=function(t,e){for(var n,r=[],i=function(){var t=n.value;switch(r=r.concat(e.call(X,t)),t.type){case"table":for(var i,a=o(t.header);!(i=a()).done;){var s=i.value;r=r.concat(X.walkTokens(s.tokens,e))}for(var l,u=o(t.rows);!(l=u()).done;)for(var c,f=l.value,h=o(f);!(c=h()).done;){var p=c.value;r=r.concat(X.walkTokens(p.tokens,e))}break;case"list":r=r.concat(X.walkTokens(t.items,e));break;default:X.defaults.extensions&&X.defaults.extensions.childTokens&&X.defaults.extensions.childTokens[t.type]?X.defaults.extensions.childTokens[t.type].forEach((function(n){r=r.concat(X.walkTokens(t[n],e))})):t.tokens&&(r=r.concat(X.walkTokens(t.tokens,e)))}},a=o(t);!(n=a()).done;)i();return r},X.parseInline=W(G.lexInline,Y.parseInline),X.Parser=Y,X.parser=Y.parse,X.Renderer=R,X.TextRenderer=H,X.Lexer=G,X.lexer=G.lex,X.Tokenizer=P,X.Slugger=U,X.Hooks=V,X.parse=X;var J=X.options,Z=X.setOptions,tt=X.use,et=X.walkTokens,nt=X.parseInline,rt=X,it=Y.parse,at=G.lex;t.Hooks=V,t.Lexer=G,t.Parser=Y,t.Renderer=R,t.Slugger=U,t.TextRenderer=H,t.Tokenizer=P,t.getDefaults=u,t.lexer=at,t.marked=X,t.options=J,t.parse=rt,t.parseInline=nt,t.parser=it,t.setOptions=Z,t.use=tt,t.walkTokens=et}))},"7c9a":function(t,e,n){"use strict";n("60f6")},"7d6d":function(t,e,n){},"7d99":function(t,e,n){"use strict";n.d(e,"y",(function(){return a})),n.d(e,"e",(function(){return o})),n.d(e,"w",(function(){return s})),n.d(e,"m",(function(){return l})),n.d(e,"x",(function(){return u})),n.d(e,"c",(function(){return c})),n.d(e,"t",(function(){return f})),n.d(e,"v",(function(){return h})),n.d(e,"b",(function(){return p})),n.d(e,"h",(function(){return d})),n.d(e,"s",(function(){return m})),n.d(e,"q",(function(){return g})),n.d(e,"a",(function(){return v})),n.d(e,"o",(function(){return b})),n.d(e,"A",(function(){return y})),n.d(e,"g",(function(){return w})),n.d(e,"d",(function(){return _})),n.d(e,"z",(function(){return k})),n.d(e,"p",(function(){return D})),n.d(e,"E",(function(){return x})),n.d(e,"F",(function(){return C})),n.d(e,"G",(function(){return S})),n.d(e,"H",(function(){return O})),n.d(e,"I",(function(){return L})),n.d(e,"l",(function(){return T})),n.d(e,"i",(function(){return E})),n.d(e,"k",(function(){return A})),n.d(e,"B",(function(){return j})),n.d(e,"C",(function(){return F})),n.d(e,"j",(function(){return q})),n.d(e,"f",(function(){return N})),n.d(e,"D",(function(){return I})),n.d(e,"u",(function(){return $})),n.d(e,"r",(function(){return P})),n.d(e,"n",(function(){return B}));var r=n("7258"),i="/metadata";function a(t){return r["b"].get("".concat(i,"/table/search"),{params:t})}function o(t){return r["b"].post("".concat(i,"/role/batchGrantPrivilegeToUser"),t)}function s(t){return r["b"].get("".concat(i,"/history/input"),{params:t})}function l(t){return r["b"].get("".concat(i,"/history/del"),{params:t})}function u(t){return r["b"].get("".concat(i,"/history/table"),{params:t})}function c(t){return r["b"].post("".concat(i,"/table/add"),t,{timeout:6e4})}function f(t){return r["b"].get("".concat(i,"/table/data"),{params:t})}function h(t){return r["b"].get("".concat(i,"/table/dbList"),{params:t})}function p(t){return r["b"].post("".concat(i,"/table/createdb"),t)}function d(t){return r["b"].get("".concat(i,"/table/check"),{params:t})}function m(t){return r["b"].post("".concat(i,"/table/changeDetail"),t)}function g(t){return r["b"].post("".concat(i,"/table/alterColumn"),t,{timeout:6e4})}function v(t){return r["b"].post("".concat(i,"/table/addColumn"),t,{timeout:6e4})}function b(t){return r["b"].post("".concat(i,"/dict/"),t)}function y(t){return r["b"].post("".concat(i,"/table/route"),t)}function w(t){return r["b"].post("".concat(i,"/table/checkCreate"),t)}function _(t){return r["b"].get("".concat(i,"/table/alterOwner"),{params:t})}function k(t){return r["b"].post("".concat(i,"/role/grantPrivilegeToUser"),t)}function D(t){return r["b"].post("".concat(i,"/auth/doAuth"),t)}function x(t){return r["b"].post("".concat(i,"/table/tableOutputInfo"),t)}function C(t){return r["b"].post("".concat(i,"/table/tablePrivilegeInfo"),t)}function S(t){return r["b"].post("".concat(i,"/table/tableProfileInfo"),t)}function O(t){return r["b"].post("".concat(i,"/table/tableStorageInfo"),t)}function L(t){return r["b"].post("".concat(i,"/table/tableSummaryDescInfo"),t)}function T(t){return r["b"].get("".concat(i,"/table/dbList"),{params:t})}function E(t){return r["b"].post("".concat(i,"/table/collect"),t)}function A(t){return r["b"].get("".concat(i,"/table/column"),{params:t})}function j(t){return r["b"].get("".concat(i,"/table/searchOne"),{params:t})}function F(t){return r["b"].post("".concat(i,"/tags/search"),t)}function q(t){return r["b"].get("".concat(i,"/table/collectList"),{params:t})}function N(t){return r["b"].post("".concat(i,"/blood"),t,{timeout:12e4})}function I(t){return r["b"].get("".concat(i,"/table/sensitivityLevel"),{params:t})}function $(t){return r["b"].get("".concat(i,"/table/getdb"),{params:t})}function P(t){return r["b"].post("".concat(i,"/table/updatedb"),t)}function B(t){return r["b"].post("".concat(i,"/table/deletedb"),t)}},"7ea2":function(t,e,n){"use strict";n.d(e,"m",(function(){return a})),n.d(e,"a",(function(){return o})),n.d(e,"t",(function(){return s})),n.d(e,"l",(function(){return l})),n.d(e,"g",(function(){return u})),n.d(e,"o",(function(){return c})),n.d(e,"p",(function(){return f})),n.d(e,"q",(function(){return h})),n.d(e,"r",(function(){return p})),n.d(e,"s",(function(){return d})),n.d(e,"n",(function(){return m})),n.d(e,"b",(function(){return g})),n.d(e,"f",(function(){return v})),n.d(e,"c",(function(){return b})),n.d(e,"d",(function(){return y})),n.d(e,"e",(function(){return w})),n.d(e,"i",(function(){return _})),n.d(e,"k",(function(){return k})),n.d(e,"j",(function(){return D})),n.d(e,"h",(function(){return x}));var r=n("7258"),i="/ds_task/flinkcluster";function a(t){return r["b"].get("".concat(i,"/page?"),{params:t})}function o(t){return r["b"].post("".concat(i,"/add"),t)}function s(t){return r["b"].put("".concat(i,"/update"),t)}function l(t){return r["b"].get("".concat(i,"/get?id=").concat(t))}function u(t){return r["b"].delete("".concat(i,"/delete"),{params:{id:t}})}function c(t){return r["b"].post("/cluster-service/cloud/resource/add",t,{timeout:6e5})}function f(t){return r["b"].delete("/cluster-service/cloud/resource/delete/".concat(t))}function h(t){return r["b"].get("/cluster-service/cloud/resource/getOne",{params:t})}function p(t){return r["b"].get("/cluster-service/cloud/resource/search",{params:t})}function d(t){return r["b"].post("/cluster-service/cloud/resource/update",t,{timeout:6e5})}function m(t){return r["b"].get("/cluster-service/cloud/resource/getRegion",{params:t})}function g(t){return r["b"].post("/cluster-service/cloud/data/add",t,{timeout:6e5})}function v(t){return r["b"].post("/cluster-service/cloud/data/update",t,{timeout:6e5})}function b(t){return r["b"].delete("/cluster-service/cloud/data/delete",{params:t})}function y(t){return r["b"].get("/cluster-service/cloud/data/getOne",{params:t})}function w(t){return r["b"].get("/cluster-service/cloud/data/search",{params:t})}function _(t){return r["b"].get("/cluster-service/cluster/service/roles",{params:t})}function k(t){return r["b"].get("/cluster-service/cluster/vpcs",{params:t})}function D(t){return r["b"].get("/cluster-service/cluster/subnets",{params:t})}function x(t){return r["b"].get("/cluster-service/cluster/security/groups",{params:t})}},"7f55":function(t,e,n){"use strict";n("a495")},"83e0":function(t,e,n){},8648:function(t,e,n){},"89b6":function(t,e,n){"use strict";n.d(e,"e",(function(){return L})),n.d(e,"c",(function(){return A})),n.d(e,"b",(function(){return j})),n.d(e,"d",(function(){return N})),n.d(e,"a",(function(){return I}));var r=n("dce8"),i=n("cbe5"),a=n("d498"),o=n("20c8"),s=n("857d"),l=n("4a3f"),u=n("6d8b"),c=n("1687"),f=n("401b"),h=n("7d6c"),p=2*Math.PI,d=o["a"].CMD,m=["top","right","bottom","left"];function g(t,e,n,r,i){var a=n.width,o=n.height;switch(t){case"top":r.set(n.x+a/2,n.y-e),i.set(0,-1);break;case"bottom":r.set(n.x+a/2,n.y+o+e),i.set(0,1);break;case"left":r.set(n.x-e,n.y+o/2),i.set(-1,0);break;case"right":r.set(n.x+a+e,n.y+o/2),i.set(1,0);break}}function v(t,e,n,r,i,a,o,l,u){o-=t,l-=e;var c=Math.sqrt(o*o+l*l);o/=c,l/=c;var f=o*n+t,h=l*n+e;if(Math.abs(r-i)%p<1e-4)return u[0]=f,u[1]=h,c-n;if(a){var d=r;r=Object(s["a"])(i),i=Object(s["a"])(d)}else r=Object(s["a"])(r),i=Object(s["a"])(i);r>i&&(i+=p);var m=Math.atan2(l,o);if(m<0&&(m+=p),m>=r&&m<=i||m+p>=r&&m+p<=i)return u[0]=f,u[1]=h,c-n;var g=n*Math.cos(r)+t,v=n*Math.sin(r)+e,b=n*Math.cos(i)+t,y=n*Math.sin(i)+e,w=(g-o)*(g-o)+(v-l)*(v-l),_=(b-o)*(b-o)+(y-l)*(y-l);return w<_?(u[0]=g,u[1]=v,Math.sqrt(w)):(u[0]=b,u[1]=y,Math.sqrt(_))}function b(t,e,n,r,i,a,o,s){var l=i-t,u=a-e,c=n-t,f=r-e,h=Math.sqrt(c*c+f*f);c/=h,f/=h;var p=l*c+u*f,d=p/h;s&&(d=Math.min(Math.max(d,0),1)),d*=h;var m=o[0]=t+d*c,g=o[1]=e+d*f;return Math.sqrt((m-i)*(m-i)+(g-a)*(g-a))}function y(t,e,n,r,i,a,o){n<0&&(t+=n,n=-n),r<0&&(e+=r,r=-r);var s=t+n,l=e+r,u=o[0]=Math.min(Math.max(i,t),s),c=o[1]=Math.min(Math.max(a,e),l);return Math.sqrt((u-i)*(u-i)+(c-a)*(c-a))}var w=[];function _(t,e,n){var r=y(e.x,e.y,e.width,e.height,t.x,t.y,w);return n.set(w[0],w[1]),r}function k(t,e,n){for(var r,i,a=0,o=0,s=0,u=0,c=1/0,f=e.data,h=t.x,p=t.y,m=0;m<f.length;){var g=f[m++];1===m&&(a=f[m],o=f[m+1],s=a,u=o);var _=c;switch(g){case d.M:s=f[m++],u=f[m++],a=s,o=u;break;case d.L:_=b(a,o,f[m],f[m+1],h,p,w,!0),a=f[m++],o=f[m++];break;case d.C:_=Object(l["e"])(a,o,f[m++],f[m++],f[m++],f[m++],f[m],f[m+1],h,p,w),a=f[m++],o=f[m++];break;case d.Q:_=Object(l["l"])(a,o,f[m++],f[m++],f[m],f[m+1],h,p,w),a=f[m++],o=f[m++];break;case d.A:var k=f[m++],D=f[m++],x=f[m++],C=f[m++],S=f[m++],O=f[m++];m+=1;var L=!!(1-f[m++]);r=Math.cos(S)*x+k,i=Math.sin(S)*C+D,m<=1&&(s=r,u=i);var T=(h-k)*C/x+k;_=v(k,D,C,S,S+O,L,T,p,w),a=Math.cos(S+O)*x+k,o=Math.sin(S+O)*C+D;break;case d.R:s=a=f[m++],u=o=f[m++];var E=f[m++],A=f[m++];_=y(s,u,E,A,h,p,w);break;case d.Z:_=b(a,o,s,u,h,p,w,!0),a=s,o=u;break}_<c&&(c=_,n.set(w[0],w[1]))}return c}var D=new r["a"],x=new r["a"],C=new r["a"],S=new r["a"],O=new r["a"];function L(t,e){if(t){var n=t.getTextGuideLine(),a=t.getTextContent();if(a&&n){var o=t.textGuideLineConfig||{},s=[[0,0],[0,0],[0,0]],l=o.candidates||m,u=a.getBoundingRect().clone();u.applyTransform(a.getComputedTransform());var f=1/0,h=o.anchor,p=t.getComputedTransform(),d=p&&Object(c["d"])([],p),v=e.get("length2")||0;h&&C.copy(h);for(var b=0;b<l.length;b++){var y=l[b];g(y,0,u,D,S),r["a"].scaleAndAdd(x,D,S,v),x.transform(d);var w=t.getBoundingRect(),O=h?h.distance(x):t instanceof i["b"]?k(x,t.path,C):_(x,w,C);O<f&&(f=O,x.transform(p),C.transform(p),C.toArray(s[0]),x.toArray(s[1]),D.toArray(s[2]))}A(s,e.get("minTurnAngle")),n.setShape({points:s})}}}var T=[],E=new r["a"];function A(t,e){if(e<=180&&e>0){e=e/180*Math.PI,D.fromArray(t[0]),x.fromArray(t[1]),C.fromArray(t[2]),r["a"].sub(S,D,x),r["a"].sub(O,C,x);var n=S.len(),i=O.len();if(!(n<.001||i<.001)){S.scale(1/n),O.scale(1/i);var a=S.dot(O),o=Math.cos(e);if(o<a){var s=b(x.x,x.y,C.x,C.y,D.x,D.y,T,!1);E.fromArray(T),E.scaleAndAdd(O,s/Math.tan(Math.PI-e));var l=C.x!==x.x?(E.x-x.x)/(C.x-x.x):(E.y-x.y)/(C.y-x.y);if(isNaN(l))return;l<0?r["a"].copy(E,x):l>1&&r["a"].copy(E,C),E.toArray(t[1])}}}}function j(t,e,n){if(n<=180&&n>0){n=n/180*Math.PI,D.fromArray(t[0]),x.fromArray(t[1]),C.fromArray(t[2]),r["a"].sub(S,x,D),r["a"].sub(O,C,x);var i=S.len(),a=O.len();if(!(i<.001||a<.001)){S.scale(1/i),O.scale(1/a);var o=S.dot(e),s=Math.cos(n);if(o<s){var l=b(x.x,x.y,C.x,C.y,D.x,D.y,T,!1);E.fromArray(T);var u=Math.PI/2,c=Math.acos(O.dot(e)),f=u+c-n;if(f>=u)r["a"].copy(E,C);else{E.scaleAndAdd(O,l/Math.tan(Math.PI/2-f));var h=C.x!==x.x?(E.x-x.x)/(C.x-x.x):(E.y-x.y)/(C.y-x.y);if(isNaN(h))return;h<0?r["a"].copy(E,x):h>1&&r["a"].copy(E,C)}E.toArray(t[1])}}}}function F(t,e,n,r){var i="normal"===n,a=i?t:t.ensureState(n);a.ignore=e;var o=r.get("smooth");o&&!0===o&&(o=.3),a.shape=a.shape||{},o>0&&(a.shape.smooth=o);var s=r.getModel("lineStyle").getLineStyle();i?t.useStyle(s):a.style=s}function q(t,e){var n=e.smooth,r=e.points;if(r)if(t.moveTo(r[0][0],r[0][1]),n>0&&r.length>=3){var i=f["e"](r[0],r[1]),a=f["e"](r[1],r[2]);if(!i||!a)return t.lineTo(r[1][0],r[1][1]),void t.lineTo(r[2][0],r[2][1]);var o=Math.min(i,a)*n,s=f["h"]([],r[1],r[0],o/i),l=f["h"]([],r[1],r[2],o/a),u=f["h"]([],s,l,.5);t.bezierCurveTo(s[0],s[1],s[0],s[1],u[0],u[1]),t.bezierCurveTo(l[0],l[1],l[0],l[1],r[2][0],r[2][1])}else for(var c=1;c<r.length;c++)t.lineTo(r[c][0],r[c][1])}function N(t,e,n){var r=t.getTextGuideLine(),i=t.getTextContent();if(i){for(var o=e.normal,s=o.get("show"),l=i.ignore,c=0;c<h["a"].length;c++){var f=h["a"][c],p=e[f],d="normal"===f;if(p){var m=p.get("show"),g=d?l:Object(u["M"])(i.states[f]&&i.states[f].ignore,l);if(g||!Object(u["M"])(m,s)){var v=d?r:r&&r.states[f];v&&(v.ignore=!0);continue}r||(r=new a["a"],t.setTextGuideLine(r),d||!l&&s||F(r,!0,"normal",e.normal),t.stateProxy&&(r.stateProxy=t.stateProxy)),F(r,!1,f,p)}}if(r){Object(u["i"])(r.style,n),r.style.fill=null;var b=o.get("showAbove"),y=t.textGuideLineConfig=t.textGuideLineConfig||{};y.showAbove=b||!1,r.buildPath=q}}else r&&t.removeTextGuideLine()}function I(t,e){e=e||"labelLine";for(var n={normal:t.getModel(e)},r=0;r<h["g"].length;r++){var i=h["g"][r];n[i]=t.getModel([i,e])}return n}},"8d76":function(t,e,n){"use strict";n("58cb")},"8df6":function(t,e,n){},a08d:function(t,e,n){},a0f7:function(t,e,n){},a495:function(t,e,n){},a95b:function(t,e,n){t.exports={globalFont:"Helvetica Neue,Helvetica,PingFang SC,Avenir,Segoe UI,Arial,sans-serif,Hiragino Sans GB,Microsoft YaHei",navbarHeight:"45px",menuText:"#445782",menuActiveText:"#3782ff",subMenuActiveText:"#3782ff",menuBg:"#f7f9ff",menuHover:"#dfebff",subMenuBg:"#1f2d3d",subMenuHover:"#dfebff",sideBarWidth:"244px"}},abef:function(t,e,n){},aced:function(t,e,n){"use strict";n("dcc7")},aeeb:function(t,e,n){"use strict";n("1c36")},b06b:function(t,e,n){"use strict";n("d93c")},b098:function(t,e,n){},b199:function(t,e,n){"use strict";n.d(e,"y",(function(){return a})),n.d(e,"W",(function(){return o})),n.d(e,"E",(function(){return s})),n.d(e,"p",(function(){return l})),n.d(e,"ab",(function(){return u})),n.d(e,"s",(function(){return c})),n.d(e,"r",(function(){return f})),n.d(e,"t",(function(){return h})),n.d(e,"Q",(function(){return p})),n.d(e,"T",(function(){return d})),n.d(e,"A",(function(){return m})),n.d(e,"O",(function(){return g})),n.d(e,"B",(function(){return v})),n.d(e,"q",(function(){return b})),n.d(e,"e",(function(){return y})),n.d(e,"g",(function(){return w})),n.d(e,"d",(function(){return _})),n.d(e,"ib",(function(){return k})),n.d(e,"n",(function(){return D})),n.d(e,"Y",(function(){return x})),n.d(e,"I",(function(){return C})),n.d(e,"H",(function(){return S})),n.d(e,"c",(function(){return O})),n.d(e,"hb",(function(){return L})),n.d(e,"m",(function(){return T})),n.d(e,"j",(function(){return E})),n.d(e,"f",(function(){return A})),n.d(e,"bb",(function(){return j})),n.d(e,"J",(function(){return F})),n.d(e,"F",(function(){return q})),n.d(e,"h",(function(){return N})),n.d(e,"db",(function(){return I})),n.d(e,"z",(function(){return $})),n.d(e,"R",(function(){return P})),n.d(e,"u",(function(){return B})),n.d(e,"D",(function(){return z})),n.d(e,"P",(function(){return M})),n.d(e,"w",(function(){return Q})),n.d(e,"Z",(function(){return G})),n.d(e,"C",(function(){return R})),n.d(e,"eb",(function(){return H})),n.d(e,"a",(function(){return U})),n.d(e,"fb",(function(){return Y})),n.d(e,"cb",(function(){return V})),n.d(e,"G",(function(){return K})),n.d(e,"U",(function(){return W})),n.d(e,"i",(function(){return X})),n.d(e,"k",(function(){return J})),n.d(e,"K",(function(){return Z})),n.d(e,"L",(function(){return tt})),n.d(e,"N",(function(){return et})),n.d(e,"M",(function(){return nt})),n.d(e,"b",(function(){return rt})),n.d(e,"l",(function(){return it})),n.d(e,"o",(function(){return at})),n.d(e,"S",(function(){return ot})),n.d(e,"gb",(function(){return st})),n.d(e,"X",(function(){return lt})),n.d(e,"v",(function(){return ut})),n.d(e,"V",(function(){return ct}));var r=n("7258"),i="/ds_task/task";function a(t){return r["b"].post("/ds_task/metadata/search",t,{timeout:12e4})}function o(){return r["b"].get("/ds_task/sysdict/getTemplateList")}function s(t){return r["b"].get("/ds_task/dict/list",{params:t})}function l(t){return r["b"].get("/ds_task/artifact/list",{params:t})}function u(t){return r["b"].get("/ds_task/artifactversion/list",{params:t})}function c(t){return r["b"].get("/ds_task/flinkcluster/list",{params:t})}function f(t){return r["b"].get("/ds_task/flinkcluster/auto",{params:t})}function h(t){return r["b"].get("/ds_task/flinkcluster/noauto",{params:t})}function p(t){return r["b"].get("".concat(i,"/get"),{params:t})}function d(t){return r["b"].get("".concat(i,"/page"),{params:t,timeout:6e4})}function m(t){return r["b"].post("/ds_task/metadata/getddl",t)}function g(t){return r["b"].get("".concat(i,"/getInsertSql"),{params:t,timeout:6e5})}function v(t){return r["b"].post("/ds_task/metadata/getdispalyddl",t)}function b(t){return r["b"].get("".concat(i,"/getChildDependencies"),{params:{id:t}})}function y(t){return r["b"].get("".concat(i,"/backfill"),{params:t})}function w(t){return r["b"].put("".concat(i,"/onlineAndOffline"),null,{params:t})}function _(t){return r["b"].post("".concat(i,"/add"),t)}function k(t){return r["b"].put("".concat(i,"/update"),t)}function D(t){return r["b"].delete("".concat(i,"/new/delete"),{params:t})}function x(t){return r["b"].get("/ds_task/user/list",{params:{name:t}})}function C(t){return r["b"].get("/ds_task/label/list",{params:{name:t}})}function S(t){return r["b"].get("/ds_task/label/get",{params:{id:t}})}function O(t){return r["b"].post("/ds_task/label/add",t)}function L(t){return r["b"].put("/ds_task/label/update",t)}function T(t){return r["b"].delete("/ds_task/label/delete",{params:{id:t}})}function E(t){return r["b"].patch("/ds_task/collect/add",null,{params:t})}function A(t){return r["b"].get("/ds_task/collect/cancel",{params:t})}function j(t){return r["b"].get("/ds_task/collect/my",{params:t})}function F(t){return r["b"].get("/ds_task/task/listforlabel",{params:{name:t}})}function q(t){return r["b"].get("/ds_task/task/iam",{params:t})}function N(t){return r["b"].post("/ds_task/task/check",t,{timeout:18e4})}function I(t){return r["b"].get("/ds_task/task/name/search",{params:{name:t}})}function $(t){return r["b"].get("/ds_task/task/backfillDateDetail",{params:t})}function P(t){return r["b"].get("/ds_task/task/last7",{params:t})}function B(t){return r["b"].get("/ds_task/user/getEffectiveCostList",{params:{name:t}})}function z(t){return r["b"].get("/ds_task/task/getGitSqlFile",{params:t})}function M(t){return r["b"].post("/ds_task/task/sqlTbls",t,{headers:{"Content-Type":"multipart/form-data"}})}function Q(t){return r["b"].post("/ds_task/task/getCrontab",t)}function G(t){return r["b"].get("/ds_task/taskversion/pages",{params:t})}function R(){return r["b"].get("/ds_task/auditlog/type?module=task")}function H(t){return r["b"].get("/ds_task/taskversion/verionSwitch",{params:t})}function U(t){return r["b"].post("/ds_task/task/addAndStart",t)}function Y(t){return r["b"].post("/ds_task/task/updateAndStart",t)}function V(t){return r["b"].post("/ds_task/task/date/preview",t)}function K(t){return r["b"].post("/ds_task/task/mergeSmallFiles/jars",t)}function W(t){return r["b"].post("/ds_task/task/getTasks",t)}function X(t){return r["b"].post("/ds_task/task/checkPath",t,{headers:{"Content-Type":"multipart/form-data"}})}function J(t){return r["b"].post("/ds_task/task/fastBackfill?taskId="+t.taskId,t)}function Z(t){return r["b"].get("/ds_task/task/renderContent",{params:t})}function tt(t){return r["b"].post("/ds_task/metadata/preview",t)}function et(t){return r["b"].get("/ds_task/actor/sources/page",{params:t})}function nt(t){return r["b"].get("/ds_task/taskfolder/listFolder",{params:t})}function rt(t){return r["b"].post("/ds_task/taskfolder/saveFolder",t)}function it(t){return r["b"].get("/ds_task/taskfolder/deleteFolder",{params:t})}function at(t){return r["b"].post("/ds_task/taskfolder/editFolder",t)}function ot(t){return r["b"].get("/ds_task/taskfolder/listTask",{params:t})}function st(t){return r["b"].post("/ds_task/taskfolder/updateTask",t)}function lt(t){return r["b"].get("/ds_task/wechatAlert/listById?id=".concat(t))}function ut(t){return r["b"].post("/pipeline/cron/get",t)}function ct(t){return r["b"].get("/ds_task/task/templateRendering",{params:t})}},b615:function(t,e,n){"use strict";n("c569")},b893:function(t,e,n){"use strict";n.d(e,"n",(function(){return u})),n.d(e,"c",(function(){return f})),n.d(e,"j",(function(){return h})),n.d(e,"m",(function(){return p})),n.d(e,"o",(function(){return d})),n.d(e,"a",(function(){return m})),n.d(e,"i",(function(){return g})),n.d(e,"k",(function(){return v})),n.d(e,"l",(function(){return w})),n.d(e,"h",(function(){return _})),n.d(e,"e",(function(){return k})),n.d(e,"d",(function(){return D})),n.d(e,"b",(function(){return x})),n.d(e,"g",(function(){return C})),n.d(e,"f",(function(){return S}));var r=n("7ea2"),i=n("4360");function a(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */a=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},s="function"==typeof Symbol?Symbol:{},l=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function f(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,n){return t[e]=n}}function h(t,e,n,r){var a=e&&e.prototype instanceof y?e:y,o=Object.create(a.prototype),s=new j(r||[]);return i(o,"_invoke",{value:L(t,n,s)}),o}function p(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",m="suspendedYield",g="executing",v="completed",b={};function y(){}function w(){}function _(){}var k={};f(k,l,(function(){return this}));var D=Object.getPrototypeOf,x=D&&D(D(F([])));x&&x!==n&&r.call(x,l)&&(k=x);var C=_.prototype=y.prototype=Object.create(k);function S(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function n(i,a,s,l){var u=p(t[i],t,a);if("throw"!==u.type){var c=u.arg,f=c.value;return f&&"object"==o(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,s,l)}),(function(t){n("throw",t,s,l)})):e.resolve(f).then((function(t){c.value=t,s(c)}),(function(t){return n("throw",t,s,l)}))}l(u.arg)}var a;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return a=a?a.then(i,i):i()}})}function L(e,n,r){var i=d;return function(a,o){if(i===g)throw new Error("Generator is already running");if(i===v){if("throw"===a)throw o;return{value:t,done:!0}}for(r.method=a,r.arg=o;;){var s=r.delegate;if(s){var l=T(s,r);if(l){if(l===b)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===d)throw i=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=g;var u=p(e,n,r);if("normal"===u.type){if(i=r.done?v:m,u.arg===b)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=v,r.method="throw",r.arg=u.arg)}}}function T(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),b;var a=p(i,e.iterator,n.arg);if("throw"===a.type)return n.method="throw",n.arg=a.arg,n.delegate=null,b;var o=a.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,b):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,b)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function F(e){if(e||""===e){var n=e[l];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}throw new TypeError(o(e)+" is not iterable")}return w.prototype=_,i(C,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:w,configurable:!0}),w.displayName=f(_,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,f(t,c,"GeneratorFunction")),t.prototype=Object.create(C),t},e.awrap=function(t){return{__await:t}},S(O.prototype),f(O.prototype,u,(function(){return this})),e.AsyncIterator=O,e.async=function(t,n,r,i,a){void 0===a&&(a=Promise);var o=new O(h(t,n,r,i),a);return e.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},S(C),f(C,c,"Generator"),f(C,l,(function(){return this})),f(C,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=F,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var a=this.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],s=o.completion;if("root"===o.tryLoc)return i("end");if(o.tryLoc<=this.prev){var l=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(l&&u){if(this.prev<o.catchLoc)return i(o.catchLoc,!0);if(this.prev<o.finallyLoc)return i(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return i(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return i(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var a=i;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var o=a?a.completion:{};return o.type=t,o.arg=e,a?(this.method="next",this.next=a.finallyLoc,b):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),b},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),A(n),b}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;A(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:F(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),b}},e}function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e,n,r,i,a,o){try{var s=t[a](o),l=s.value}catch(u){return void n(u)}s.done?e(l):Promise.resolve(l).then(r,i)}function l(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var a=t.apply(e,n);function o(t){s(a,r,i,o,l,"next",t)}function l(t){s(a,r,i,o,l,"throw",t)}o(void 0)}))}}var u={StreamingSQL:"step2FlinkSQL",StreamingJAR:"step2FlinkJar",Metis2Hive:"step2Metis",MysqlCDC2Hive:"step2CDC",Mysql2Lakehouse:"step2Hive",Mysql2Hive:"step2Hive",File2Lakehouse:"step2File",Mysql2Hudi:"step2Hudi",Hive2Hive:"step2HiveSQL",DataMigration:"step2HCCloud",SPARKJAR:"step2SparkJar",Hive2Sharestore:"step2ShareStore",Hive2Clickhouse:"step2ClickHouse",Hive2Mysql:"step2MySql",Hive2Doris:"step2Doris",PythonShell:"step2Shell",Db2Hive:"step2DB",Hive2Redis:"step2Redis",Hive2Redshift:"step2Redshift",MergeSmallFiles:"step2FileMerge",Hive2File:"step2Hive2File",TfJob:"step2TrainingModel"},c=i["a"].getters["isCloud"],f=[{title:"数据接入 Data Ingestion",list:[{label:"DB -> Lakehouse",templateCode:"step2Hive",path:"step2Hive",content:"该模板适用于拉取各类关系型DataBase数据到Lakehouse湖仓，提供离线全量和实时增量同步方案。"},{label:"File -> Lakehouse",templateCode:"File2Lakehouse",path:"step2File",content:"该模板适用于将对象存储(如AWS S3、OBS、KS3等)或分布式文件存储(如HDFS等)中存储的各种格式(如csv、json、paruet、orc等)的文件数据同步到Lakehouse湖仓中。"},{label:"Kafka -> Lakehouse",templateCode:"Metis2Hive",path:"step2Metis",content:"Kafka2Lakehouse统一模板，对接Kafka/Metis，透传至Lakehouse表。",isGray:!0}]},{title:"湖仓处理 Data Transformation",list:[{label:"Lakehouse -> Lakehouse",templateCode:"Hive2Hive",path:"step2HiveSQL",content:"基于Hive SQL/Spark SQL数据处理，不同的执行引擎语法略有差异，请参考官方语法。"}]},{title:"数据导出 Data Digestion",list:[{label:"Lakehouse -> Doris",templateCode:"Hive2Doris",path:"step2Doris",content:"用于数据的导出处理，可将数据从Lakehouse导出到Doris中。"},{label:"Lakehouse -> File",templateCode:"Hive2File",path:"step2Hive2File",content:"用于Lakehouse数据导出到文件的任务，可以支持以邮件的方式将文件发送给用户。"},{label:"Lakehouse -> MySQL",templateCode:"Hive2Mysql",path:"step2MySql",content:"用于数据的导出处理，可将数据从Lakehouse导出到MySQL中。"},{label:"Lakehouse -> ClickHouse",content:"用于数据的导出处理，可将数据从Lakehouse导出到ClickHouse中。",isGray:!0},{label:"Lakehouse -> Redshift",content:"适用于将S3文件中结构化数据映射到Aws Redshift表中的业务场景。",isGray:!0}]}],h=[{title:"数据接入 Data Ingestion",list:[{label:"Spark Jar",templateCode:"SPARKJAR",path:"step2SparkJar",content:"用于湖仓数据的基于Jar包的数据处理，一般用于更加复杂的数据处理逻辑。"},{label:"Shell/Python脚本",templateCode:"PythonShell",path:"step2Shell",content:"用于python和shell脚本任务的执行。"}]},{title:"湖仓处理 Lakehouse ETL",list:[{label:"Flink Jar",templateCode:"StreamingJAR",path:"step2FlinkJar",content:"通过上传Flink Jar包的方式，进行流式数据处理。",isGray:!0},{label:"Flink SQL",templateCode:"StreamingSQL",path:"step2FlinkSQL",content:"流式任务的统一模板，基于SQL查询的方式（Flink SQL）进行数据处理。Metis日志处理，统一归集到此处通过SQL的方式进行处理。",isGray:!0}]}],p={CREATED:"#8896B3",INITIALIZING:"rgba(146, 112, 202, 0.8)",SCHEDULED:"rgba(146, 112, 202, 0.8)",RUNNING:"#409EFF",RESTARTING:"#C6E2FF",RECONCILING:"#41F3D8",SUSPENDED:"#67C23A",CANCELED:"#E6A23C",CANCELLING:"#E6A23C",FAILED:"#FF5656",SUCCESS:"#67C23A",FINISHED:"#67C23A",FAILLING:"#FCE2E2"},d={CREATED:"#8896B3",INITIALIZING:"rgba(146, 112, 202, 0.8)",SCHEDULED:"rgba(146, 112, 202, 0.8)",RUNNING:"#409EFF",CANCELED:"#E6A23C",FAILED:"#FF5656",SUCCESS:"#67C23A",SUSPENDED:"#67C23A",FINISHED:"#67C23A",OFFLINE:"#dcdfe6"},m={CREATED:"已创建",INITIALIZING:"已上线",SCHEDULED:"已上线",RUNNING:"执行中",CANCELED:"已取消",FAILED:"失败",SUCCESS:"成功",SUSPENDED:"成功",FINISHED:"成功",OFFLINE:"已下线"},g={waiting:"检查上游",termination:"终止检查上游",waiting_queue:"排队中",running:"运行中",up_for_retry:"等待重试",failed:"失败",success:"成功"},v={INITIALIZING:"初始化中",CREATED:"已创建",RUNNING:"运行中",FAILING:"失败中",CANCELLING:"取消中",RESTARTING:"重启中",RECONCILING:"调度中",FAILED:"已失败",CANCELED:"已下线",FINISHED:"已完成",SUSPENDED:"已停止"};function b(){return y.apply(this,arguments)}function y(){return y=l(a().mark((function t(){var e,n;return a().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(r["r"])();case 2:return e=t.sent,n=e.data,t.abrupt("return",n.list.map((function(t){return{label:t.description,value:t.regionAlias}})));case 5:case"end":return t.stop()}}),t)}))),y.apply(this,arguments)}var w=c?b():new Promise((function(t,e){t([{label:"AWS 美东",value:"ue1"},{label:"AWS 新加坡",value:"sg1"},{label:"华为 新加坡",value:"sg2"}])})),_=[{label:"P0",value:0},{label:"P1",value:1},{label:"P2",value:2},{label:"P3",value:3}],k={GENERAL:"一般",SENIOR:"紧急"};function D(t,e){var n="";return function(r){n&&clearTimeout(n),n=setTimeout((function(){t(r)}),e)}}function x(t){if(null==t)return null;var e=Array.isArray(t)?[]:{};for(var n in t)t.hasOwnProperty(n)&&("object"===o(t[n])?e[n]=x(t[n]):e[n]=t[n]);return e}var C=[{package:"awscli",version:"1.16.263"},{package:"backports.ssl-match-hostname",version:"3.5.0.1"},{package:"boto",version:"2.49.0"},{package:"boto3",version:"1.9.220"},{package:"botocore",version:"1.12.253"},{package:"certifi",version:"2020.12.5"},{package:"chardet",version:"3.0.4"},{package:"colorama",version:"0.4.1"},{package:"docutils",version:"0.15.2"},{package:"futures",version:"3.3.0"},{package:"idna",version:"2.10"},{package:"iniparse",version:"0.4"},{package:"ipaddress",version:"1.0.16"},{package:"jmespath",version:"0.9.5"},{package:"kitchen",version:"1.1.1"},{package:"pip",version:"20.3.3"},{package:"pyasn1",version:"0.4.8"},{package:"pycurl",version:"7.19.0"},{package:"pygobject",version:"3.22.0"},{package:"pygpgme",version:"0.3"},{package:"pyliblzma",version:"0.5.3"},{package:"python-dateutil",version:"2.8.1"},{package:"pyxattr",version:"0.5.1"},{package:"PyYAML",version:"5.1.2"},{package:"requests",version:"2.24.0"},{package:"rsa",version:"3.4.2"},{package:"s3transfer",version:"0.2.1"},{package:"setuptools",version:"0.9.8"},{package:"six",version:"1.15.0"},{package:"urlgrabber",version:"3.10"},{package:"urllib3",version:"1.25.11"},{package:"yum-metadata-parser",version:"1.1.4"}],S={sg2:"swr.ap-southeast-3.myhuaweicloud.com/shareit-bdp/airflow-business:script_task",ue1:"848318613114.dkr.ecr.us-east-1.amazonaws.com/bdp/airflow:script_task",sg1:"848318613114.dkr.ecr.ap-southeast-1.amazonaws.com/bdp/workflow:script_task"}},c03f:function(t,e,n){"use strict";n("7bd7")},c569:function(t,e,n){},c9f8:function(t,e,n){"use strict";n("5c24")},ca96:function(t,e,n){t.exports={globalFont:"Helvetica Neue,Helvetica,PingFang SC,Avenir,Segoe UI,Arial,sans-serif,Hiragino Sans GB,Microsoft YaHei",navbarHeight:"45px",menuText:"#445782",menuActiveText:"#3782ff",subMenuActiveText:"#3782ff",menuBg:"#f7f9ff",menuHover:"#dfebff",subMenuBg:"#1f2d3d",subMenuHover:"#dfebff",sideBarWidth:"244px"}},d3a9:function(t,e,n){},d4b9:function(t,e,n){"use strict";n("a95b")},d665:function(t,e,n){"use strict";n("f3e5")},d93c:function(t,e,n){t.exports={globalFont:"Helvetica Neue,Helvetica,PingFang SC,Avenir,Segoe UI,Arial,sans-serif,Hiragino Sans GB,Microsoft YaHei",navbarHeight:"45px",menuText:"#445782",menuActiveText:"#3782ff",subMenuActiveText:"#3782ff",menuBg:"#f7f9ff",menuHover:"#dfebff",subMenuBg:"#1f2d3d",subMenuHover:"#dfebff",sideBarWidth:"244px"}},d976:function(t,e,n){},dcc7:function(t,e,n){},dfc7:function(t,e,n){"use strict";n("5cac")},e46f:function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"wrapper",style:{height:t.chartConfigOptions.chartHeight+"px"}},[n("div",{staticClass:"container",attrs:{id:t.chartConfigOptions.chartId}}),t._v(" "),t.chartType?t._e():n("el-empty",{staticClass:"empty",attrs:{description:"暂无数据"}})],1)},i=[],a=n("917c"),o={data:function(){return{chart:null,chartOption:{id:"",autoFit:!0,chartHeight:300,padding:[20,20,40,60],axisX:"",axisY:""}}},methods:{initChart:function(){this.chart=null,this.chart=new a["a"]({container:this.chartOption.id,width:this.chartOption.chartWidth,height:this.chartOption.chartHeight,autoFit:this.chartOption.autoFit,padding:this.chartOption.padding})},setChartData:function(t){this.chart.data(t)},formatterValue:function(t){var e=t;return"number"===this.chartOption.axisY.format?e=t:"hundred"===this.chartOption.axisY.format?e=100*e+" %":"thousand"===this.chartOption.axisY.format&&(e=1e3*e+" ‰"),e},setChartOption:function(t){var e,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(t){};this.chart.clear(),this.chartOption.legend?this.chart.legend({position:"bottom",offsetY:"line"===t?8:4}):this.chart.legend(this.chartOption.legend),this.chart.scale(this.chartOption.axisX.value,{nice:!0,alias:this.chartOption.axisX.name}),this.chart.scale(this.chartOption.axisY.value,{nice:!0,alias:this.chartOption.axisY.name}),this.chart.axis(this.chartOption.axisX.value,{title:this.chartOption.axisX.name?{position:"center",offset:30}:null}),this.chart.axis(this.chartOption.axisY.value,{title:this.chartOption.axisY.name?{position:"center"}:null,label:{formatter:function(t){var e=t;return"number"===n.chartOption.axisY.format?e=t:"hundred"===n.chartOption.axisY.format?e=100*e+" %":"thousand"===n.chartOption.axisY.format&&(e=1e3*e+" ‰"),e.length>8?"".concat(e.slice(0,8),"..."):e}}}),this.chart.on("axis-label:mouseenter",(function(t){if(t.target.cfg.delegateObject.axis.cfg.field===n.chartOption.axisY.value){var e=document.getElementById("extension");if(!e){var r=document.createElement("div");r.id="extension",r.style.display="none",document.body.appendChild(r)}var i=document.querySelector("#extension");i.style.position="absolute",i.style.color="#333",i.style.background="#fff",i.style["font-size"]="12px",i.style.padding="5px",i.style.display="inline",i.style.border="1px solid #333",i.style["z-index"]="10000",i.innerText=n.formatterValue(t.target.cfg.delegateObject.item.name),document.body.onmousemove=function(t){var e=t.pageX-30,n=t.pageY+20;i.style.top=n+"px",i.style.left=e+"px"}}})),this.chart.on("axis-label:mouseleave",(function(t){var e=document.querySelector("#extension");e&&(e.style.display="none")})),"line"===t?(this.chart.tooltip({shared:!0,showCrosshairs:!0}),this.chart.line().position("".concat(this.chartOption.axisX.value,"*").concat(this.chartOption.axisY.value)).color("".concat(this.chartOption.dimension)).shape("smooth"),e=this.chart.point().position("".concat(this.chartOption.axisX.value,"*").concat(this.chartOption.axisY.value)).color("".concat(this.chartOption.dimension)).shape("circle")):"interval"===t||"stack"===t?(this.chart.tooltip({shared:!0,showMarkers:!1}),this.chart.interaction("active-region"),e=this.chart.interval().position("".concat(this.chartOption.axisX.value,"*").concat(this.chartOption.axisY.value)).adjust("stack").color("".concat(this.chartOption.group))):"polygon"===t&&(this.chart.axis(!1),this.chart.tooltip({showTitle:!1,showMarkers:!1,itemTpl:'<li style="list-style: none;"><span style="background-color:{color};" class="g2-tooltip-marker"></span>{name}<br/><span style="padding-left: 16px">value：{value}</span><br/><br/></li>'}),e=this.chart.polygon().position("x*y").color("name").tooltip("name*value",(function(t,e){return"hundred"===n.chartOption.format?e=100*e+" %":"thousand"===n.chartOption.format&&(e=1e3*e+" ‰"),{name:t,value:e}})).style({lineWidth:1,stroke:"#fff"}).label("name",{offset:0,style:{textBaseline:"middle"},content:function(t){if("root"!==t.name)return t.name}})),r(this.chart,e)},renderChart:function(){this.chart.render()}}},s=n("7104"),l=n.n(s),u=n("1f17");function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function f(t,e){var n="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=h(t))||e&&t&&"number"===typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return o=t.done,t},e:function(t){s=!0,a=t},f:function(){try{o||null==n.return||n.return()}finally{if(s)throw a}}}}function h(t,e){if(t){if("string"===typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function d(t,e,n){return e=m(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m(t){var e=g(t,"string");return"symbol"===c(e)?e:String(e)}function g(t,e){if("object"!==c(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==c(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var v=l.a.DataView,b={name:"Chart",mixins:[o],props:{data:{type:Object,default:function(){return{}}},chartConfig:{type:Object,default:function(){return{}}},chartConfigOptions:{type:Object,default:function(){return{chartHeight:300,autoFit:!0}}}},data:function(){return{chartOption:{id:this.chartConfigOptions.chartId,autoFit:!0,axisX:"",axisY:"",chartHeight:this.chartConfigOptions.chartHeight,padding:this.chartConfigOptions.padding||[]},chartType:!1}},computed:{chartData:function(){var t=this,e=this.data.result;return this.data.type&&e.forEach((function(e){Object.keys(e).forEach((function(n){var r=t.data.type.find((function(t){return t[n]}));r&&u["d"].includes(r[Object.values(r)[0]])&&(e[n]=Number(e[n]))})),t.data.type.length!==Object.keys(e).length&&t.data.type.forEach((function(t){!e[Object.keys(t)[0]]&&u["d"].includes(t[Object.keys(t)[0]])&&(e[Object.keys(t)[0]]=0)}))})),e}},watch:{chartConfig:{handler:function(t,e){Object.assign(this.chartOption,t);var n=["title","describe"],r=n.some((function(n){return t[n]!==e[n]}));r||this.setOption()},deep:!0}},mounted:function(){this.initChart(),Object.assign(this.chartOption,this.chartConfig),this.setOption()},methods:{customOption:function(t,e){var n=this.chartOption.type;"line"===n&&(this.chartOption.legend?t.legend({position:"bottom",offsetY:"line"===n?8:4,marker:function(t,e,n){return{symbol:"square",style:{fill:n.style.stroke}}}}):t.legend(this.chartOption.legend))},setOption:function(){var t=this,e=this.chartOption.type;if("polygon"===e){if(!this.chartOption.dimension||!this.chartOption.norm)return;var n=JSON.parse(JSON.stringify(this.chartData)),r=Array.from(new Set(n.map((function(e){return e[t.chartOption.dimension]})))),i=[];r.forEach((function(e){var r,a=(r={},d(r,t.chartOption.dimension,e),d(r,t.chartOption.norm,0),r);n.forEach((function(n){n[t.chartOption.dimension]===e&&(isNaN(Number(n[t.chartOption.norm]))?a[t.chartOption.norm]=a[t.chartOption.norm]+0:a[t.chartOption.norm]=a[t.chartOption.norm]+Number(n[t.chartOption.norm]))})),i.push(a)})),this.$emit("normNumChange",i.length);for(var a=0;a<i.length-1;a++)for(var o=0;o<i.length-1-a;o++)if(i[o+1][this.chartOption.norm]>i[o][this.chartOption.norm]){var s=[i[o+1],i[o]];i[o]=s[0],i[o+1]=s[1]}var l=null,u=this.chartOption.viewNum?this.chartOption.viewNum:i.length;if(l=i.slice(0,u),this.chartOption.viewNum&&this.chartOption.viewNum!==i.length){var c={},h=i.slice(u),p=0;h.forEach((function(e){isNaN(Number(e[t.chartOption.norm]))?p+=0:p+=Number(e[t.chartOption.norm])})),c[this.chartOption.dimension]="其他",c[this.chartOption.norm]=p,l.push(c)}var m={name:"root",children:l.map((function(e){return{name:e[t.chartOption.dimension],value:e[t.chartOption.norm]}}))},g=new v;g.source(m,{type:"hierarchy"}).transform({field:"value",type:"hierarchy.treemap",tile:"treemapResquarify"});var b,y=[],w=f(g.getAllNodes());try{for(w.s();!(b=w.n()).done;){var _=b.value;if("root"!==_.data.name){var k={name:_.data.name,x:_.x,y:_.y,value:_.data.value};y.push(k)}}}catch(L){w.e(L)}finally{w.f()}this.setChartData(y)}if("polygon"===e){if(!this.chartOption.dimension||!this.chartOption.norm)return}else{if(!this.chartOption.axisX.value||!this.chartOption.axisY.value)return;if(this.chartOption.group||this.chartOption.dimension){var D=Array.from(new Set(this.chartData.map((function(e){return e[t.chartOption.axisX.value]+""})))),x=[];D.forEach((function(e){var n=[];t.chartData.forEach((function(r){r[t.chartOption.axisX.value]!==e&&r[t.chartOption.axisX.value]!==Number(e)||n.push(r)}));var r=t.chartOption.group||t.chartOption.dimension,i=Array.from(new Set(n.map((function(t){return t[r]+""}))));i.forEach((function(e,i,a){var o=n.filter((function(t){return t&&t[r]===e}));if(o.length>0){var s=o.reduce((function(e,n){return e[t.chartOption.axisY.value]>n[t.chartOption.axisY.value]?e:n}));x.push(s)}}))})),x.sort((function(e,n){return isNaN(new Date(e[t.chartOption.axisX.value]).getTime())?e[t.chartOption.axisX.value]-n[t.chartOption.axisX.value]:new Date(e[t.chartOption.axisX.value]).getTime()-new Date(n[t.chartOption.axisX.value]).getTime()})),this.setChartData(x)}else{for(var C=[],S=[],O=this.chartData.length-1;O>=0;O--)C.includes(this.chartData[O][this.chartOption.axisX.value])||(C.push(this.chartData[O][this.chartOption.axisX.value]),S.push(this.chartData[O]));S.sort((function(e,n){return isNaN(new Date(e[t.chartOption.axisX.value]).getTime())?e[t.chartOption.axisX.value]-n[t.chartOption.axisX.value]:new Date(e[t.chartOption.axisX.value]).getTime()-new Date(n[t.chartOption.axisX.value]).getTime()})),this.setChartData(S)}}this.setChartOption(e,this.customOption),this.renderChart(),this.chartType=!0}}},y=b,w=(n("297d"),n("2877")),_=Object(w["a"])(y,r,i,!1,null,"5f9ef927",null);e["a"]=_.exports},e87d:function(t,e,n){},ea29:function(t,e,n){"use strict";n("d976")},ed77:function(t,e,n){t.exports={globalFont:"Helvetica Neue,Helvetica,PingFang SC,Avenir,Segoe UI,Arial,sans-serif,Hiragino Sans GB,Microsoft YaHei",navbarHeight:"45px",menuText:"#445782",menuActiveText:"#3782ff",subMenuActiveText:"#3782ff",menuBg:"#f7f9ff",menuHover:"#dfebff",subMenuBg:"#1f2d3d",subMenuHover:"#dfebff",sideBarWidth:"244px"}},ee29:function(t,e,n){"use strict";var r=n("e0d3"),i=n("9850"),a=n("deca"),o=n("861c"),s=n("3842"),l=n("8582"),u=n("89b6"),c=n("6d8b"),f=n("2355"),h=n("7837"),p=n("857d");function d(t){if(t){for(var e=[],n=0;n<t.length;n++)e.push(t[n].slice());return e}}function m(t,e){var n=t.label,r=e&&e.getTextGuideLine();return{dataIndex:t.dataIndex,dataType:t.dataType,seriesIndex:t.seriesModel.seriesIndex,text:t.label.style.text,rect:t.hostRect,labelRect:t.rect,align:n.style.align,verticalAlign:n.style.verticalAlign,labelLinePoints:d(r&&r.shape.points)}}var g=["align","verticalAlign","width","height","fontSize"],v=new l["b"],b=Object(r["m"])(),y=Object(r["m"])();function w(t,e,n){for(var r=0;r<n.length;r++){var i=n[r];null!=e[i]&&(t[i]=e[i])}}var _=["x","y","rotation"],k=function(){function t(){this._labelList=[],this._chartViewList=[]}return t.prototype.clearLabels=function(){this._labelList=[],this._chartViewList=[]},t.prototype._addLabel=function(t,e,n,r,a){var o=r.style,s=r.__hostTarget,l=s.textConfig||{},u=r.getComputedTransform(),c=r.getBoundingRect().plain();i["a"].applyTransform(c,c,u),u?v.setLocalTransform(u):(v.x=v.y=v.rotation=v.originX=v.originY=0,v.scaleX=v.scaleY=1),v.rotation=Object(p["a"])(v.rotation);var f,h=r.__hostTarget;if(h){f=h.getBoundingRect().plain();var d=h.getComputedTransform();i["a"].applyTransform(f,f,d)}var m=f&&h.getTextGuideLine();this._labelList.push({label:r,labelLine:m,seriesModel:n,dataIndex:t,dataType:e,layoutOption:a,computedLayoutOption:null,rect:c,hostRect:f,priority:f?f.width*f.height:0,defaultAttr:{ignore:r.ignore,labelGuideIgnore:m&&m.ignore,x:v.x,y:v.y,scaleX:v.scaleX,scaleY:v.scaleY,rotation:v.rotation,style:{x:o.x,y:o.y,align:o.align,verticalAlign:o.verticalAlign,width:o.width,height:o.height,fontSize:o.fontSize},cursor:r.cursor,attachedPos:l.position,attachedRot:l.rotation}})},t.prototype.addLabelsOfSeries=function(t){var e=this;this._chartViewList.push(t);var n=t.__model,r=n.get("labelLayout");(Object(c["v"])(r)||Object(c["D"])(r).length)&&t.group.traverse((function(t){if(t.ignore)return!0;var i=t.getTextContent(),a=Object(o["a"])(t);i&&!i.disableLabelLayout&&e._addLabel(a.dataIndex,a.dataType,n,i,r)}))},t.prototype.updateLayoutConfig=function(t){var e=t.getWidth(),n=t.getHeight();function r(t,e){return function(){Object(u["e"])(t,e)}}for(var i=0;i<this._labelList.length;i++){var a=this._labelList[i],o=a.label,l=o.__hostTarget,f=a.defaultAttr,h=void 0;h=Object(c["v"])(a.layoutOption)?a.layoutOption(m(a,l)):a.layoutOption,h=h||{},a.computedLayoutOption=h;var p=Math.PI/180;l&&l.setTextConfig({local:!1,position:null!=h.x||null!=h.y?null:f.attachedPos,rotation:null!=h.rotate?h.rotate*p:f.attachedRot,offset:[h.dx||0,h.dy||0]});var d=!1;if(null!=h.x?(o.x=Object(s["q"])(h.x,e),o.setStyle("x",0),d=!0):(o.x=f.x,o.setStyle("x",f.style.x)),null!=h.y?(o.y=Object(s["q"])(h.y,n),o.setStyle("y",0),d=!0):(o.y=f.y,o.setStyle("y",f.style.y)),h.labelLinePoints){var v=l.getTextGuideLine();v&&(v.setShape({points:h.labelLinePoints}),d=!1)}var y=b(o);y.needsUpdateLabelLine=d,o.rotation=null!=h.rotate?h.rotate*p:f.rotation,o.scaleX=f.scaleX,o.scaleY=f.scaleY;for(var w=0;w<g.length;w++){var _=g[w];o.setStyle(_,null!=h[_]?h[_]:f.style[_])}if(h.draggable){if(o.draggable=!0,o.cursor="move",l){var k=a.seriesModel;if(null!=a.dataIndex){var D=a.seriesModel.getData(a.dataType);k=D.getItemModel(a.dataIndex)}o.on("drag",r(l,k.getModel("labelLine")))}}else o.off("drag"),o.cursor=f.cursor}},t.prototype.layout=function(t){var e=t.getWidth(),n=t.getHeight(),r=Object(f["b"])(this._labelList),i=Object(c["n"])(r,(function(t){return"shiftX"===t.layoutOption.moveOverlap})),a=Object(c["n"])(r,(function(t){return"shiftY"===t.layoutOption.moveOverlap}));Object(f["c"])(i,0,e),Object(f["d"])(a,0,n);var o=Object(c["n"])(r,(function(t){return t.layoutOption.hideOverlap}));Object(f["a"])(o)},t.prototype.processLabelsOverall=function(){var t=this;Object(c["k"])(this._chartViewList,(function(e){var n=e.__model,r=e.ignoreLabelLineUpdate,i=n.isAnimationEnabled();e.group.traverse((function(e){if(e.ignore&&!e.forceLabelAnimation)return!0;var a=!r,o=e.getTextContent();!a&&o&&(a=b(o).needsUpdateLabelLine),a&&t._updateLabelLine(e,n),i&&t._animateLabels(e,n)}))}))},t.prototype._updateLabelLine=function(t,e){var n=t.getTextContent(),r=Object(o["a"])(t),i=r.dataIndex;if(n&&null!=i){var a=e.getData(r.dataType),s=a.getItemModel(i),l={},c=a.getItemVisual(i,"style");if(c){var f=a.getVisual("drawType");l.stroke=c[f]}var h=s.getModel("labelLine");Object(u["d"])(t,Object(u["a"])(s),l),Object(u["e"])(t,h)}},t.prototype._animateLabels=function(t,e){var n=t.getTextContent(),r=t.getTextGuideLine();if(n&&(t.forceLabelAnimation||!n.ignore&&!n.invisible&&!t.disableLabelAnimation&&!Object(a["d"])(t))){var i=b(n),s=i.oldLayout,l=Object(o["a"])(t),u=l.dataIndex,f={x:n.x,y:n.y,rotation:n.rotation},p=e.getData(l.dataType);if(s){n.attr(s);var d=t.prevStates;d&&(Object(c["q"])(d,"select")>=0&&n.attr(i.oldLayoutSelect),Object(c["q"])(d,"emphasis")>=0&&n.attr(i.oldLayoutEmphasis)),Object(a["h"])(n,f,e,u)}else if(n.attr(f),!Object(h["e"])(n).valueAnimation){var m=Object(c["M"])(n.style.opacity,1);n.style.opacity=0,Object(a["c"])(n,{style:{opacity:m}},e,u)}if(i.oldLayout=f,n.states.select){var g=i.oldLayoutSelect={};w(g,f,_),w(g,n.states.select,_)}if(n.states.emphasis){var v=i.oldLayoutEmphasis={};w(v,f,_),w(v,n.states.emphasis,_)}Object(h["a"])(n,u,p,e,e)}if(r&&!r.ignore&&!r.invisible){i=y(r),s=i.oldLayout;var k={points:r.shape.points};s?(r.attr({shape:s}),Object(a["h"])(r,{shape:k},e)):(r.setShape(k),r.style.strokePercent=0,Object(a["c"])(r,{style:{strokePercent:1}},e)),i.oldLayout=k}},t}(),D=k;n.d(e,"a",(function(){return C}));var x=Object(r["m"])();function C(t){t.registerUpdateLifecycle("series:beforeupdate",(function(t,e,n){var r=x(e).labelManager;r||(r=x(e).labelManager=new D),r.clearLabels()})),t.registerUpdateLifecycle("series:layoutlabels",(function(t,e,n){var r=x(e).labelManager;n.updatedSeries.forEach((function(t){r.addLabelsOfSeries(e.getViewOfSeriesModel(t))})),r.updateLayoutConfig(e),r.layout(e),r.processLabelsOverall()}))}},f3e5:function(t,e,n){},f4e1:function(t,e,n){"use strict";n("e87d")},f5b7:function(t,e,n){"use strict";n("a08d")},f5d4:function(t,e,n){},faa0:function(t,e,n){},ff6e:function(t,e,n){"use strict";n("faa0")}}]);