(window["webpackJsonp_datastudio-web"]=window["webpackJsonp_datastudio-web"]||[]).push([["chunk-6057d3c8"],{"1b1ce":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-card",{staticClass:"engine-config-list box-card-container"},[i("div",{staticClass:"search-condition-wrap"},[i("div",{staticClass:"tips"},[i("i",{staticClass:"el-icon-warning-outline"}),t._v("具有Zeus访问权限的用户，系统会默认分配Presto、Spark等相关引擎的权限；对于ClickHouse、Tidb、MySql等相关的引擎，需要管理员通过当前页面进行配置")]),t._v(" "),i("search-condition",{attrs:{label:""}},[i("el-input",{staticClass:"search-box",attrs:{placeholder:"请输入用户名、引擎",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.params.info,callback:function(e){t.$set(t.params,"info","string"===typeof e?e.trim():e)},expression:"params.info"}})],1),t._v(" "),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.search}},[t._v("查询")]),t._v(" "),i("el-button",{staticClass:"create",attrs:{type:"primary"},on:{click:t.addConfig}},[t._v("新建")])],1),t._v(" "),i("div",{staticClass:"table-wrap"},[i("table-page",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{"table-data":t.tableData,"column-data":t.columnData,"table-height":"calc(100vh - 230px)",total:t.total,"page-num":t.params.pageNum,"page-size":t.params.pageSize},on:{changePage:t.changePage}},[i("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(i){return t.edit(e.row)}}},[t._v("配置")]),t._v(" "),i("el-button",{staticClass:"global-color-cb",attrs:{type:"text",size:"mini"},on:{click:function(i){return t.deleteData(e.row)}}},[t._v("删除")])]}}])})],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"新增用户",width:"450px","close-on-click-modal":!1,visible:t.addDialogVisible},on:{"update:visible":function(e){t.addDialogVisible=e},close:t.closeDialog}},[i("el-form",{ref:"form",attrs:{model:t.form,"label-width":"100px",rules:t.rules}},[i("el-form-item",{attrs:{label:"用户名",prop:"name"}},[i("el-select",{staticStyle:{width:"250px"},attrs:{filterable:"",placeholder:"请选择"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}},t._l(t.users,(function(t){return i("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.addDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary",loading:t.featching},on:{click:t.add}},[t._v("确 定")])],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"引擎配置",width:"600px","close-on-click-modal":!1,visible:t.configDialogVisible},on:{"update:visible":function(e){t.configDialogVisible=e}}},[i("div",[i("div",[t._v("引擎分类以及名称")]),t._v(" "),i("div",{staticClass:"engine-box"},t._l(t.engineAuthList,(function(e,a){return i("div",{key:a,staticClass:"engine-item"},[i("div",{staticClass:"engine-item-title"},[t._v(t._s(a))]),t._v(" "),i("el-checkbox-group",{model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}},[t._l(e,(function(e,a){return[i("el-checkbox",{key:e.value,staticClass:"engine-item-option",attrs:{label:JSON.stringify(e)}},[t._v(t._s(e.label))]),i("br",{key:a})]}))],2)],1)})),0)]),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.configDialogVisible=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary",loading:t.featching},on:{click:t.submit}},[t._v("确 定")])],1)])],1)},n=[],s=i("88c9"),o=i("6041"),l=i("8cbe"),c={components:{SearchCondition:s["a"],TablePage:o["a"]},data:function(){return{loading:!1,tableData:[],columnData:[{prop:"name",label:"用户名",width:"120"},{prop:"engine",label:"已配置的引擎",width:"600",format:function(t){var e=JSON.parse(t.engine);return e=e.map((function(t){return t.label})),e.join(",")}}],total:0,params:{info:"",pageNum:1,pageSize:10},engineAuthList:{},users:[],featching:!1,addDialogVisible:!1,configDialogVisible:!1,form:{name:""},id:"",name:"",checkList:[],rules:{name:[{required:!0,message:"请选择用户!",trigger:"change"}]}}},created:function(){this.init()},methods:{init:function(){var t=this;Object(l["K"])().then((function(e){t.engineAuthList=e.data})),Object(l["O"])().then((function(e){t.users=e.data})),this.getList()},changePage:function(t){this.params.pageSize=t.pageSize,this.params.pageNum=t.pageNum,this.getList()},getList:function(){var t=this;this.loading=!0,Object(l["L"])(this.params).then((function(e){t.loading=!1,t.total=e.data.total,t.tableData=e.data.list}))},search:function(){this.params.pageNum=1,this.getList()},addConfig:function(){this.addDialogVisible=!0},closeDialog:function(){this.$refs.form&&this.$refs.form.resetFields()},add:function(){var t=this;this.$refs.form.validate((function(e){e&&(t.featching=!0,Object(l["g"])({name:t.form.name,engine:[]}).then((function(e){t.$message.success({message:"新增成功"}),t.addDialogVisible=!1,t.getList()})).finally((function(){t.featching=!1})))}))},edit:function(t){this.id=t.id,this.name=t.name;var e=JSON.parse(t.engine);this.checkList=e.map((function(t){return JSON.stringify(t)})),this.configDialogVisible=!0},submit:function(){var t=this,e=this.checkList.map((function(t){return JSON.parse(t)}));this.featching=!0,Object(l["Eb"])({id:this.id,name:this.name,engine:e}).then((function(e){t.$message.success({message:"配置成功!"}),t.configDialogVisible=!1,t.getList()})).finally((function(){t.featching=!1}))},deleteData:function(t){var e=this;this.$confirm("确定删除 ".concat(t.name," 的引擎配置?"),"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(l["E"])(t.id).then((function(t){e.$message({type:"success",message:"删除成功!"}),e.getList()}))})).catch((function(){}))}}},r=c,u=(i("cea6"),i("2877")),d=Object(u["a"])(r,a,n,!1,null,"09ca6120",null);e["default"]=d.exports},cea6:function(t,e,i){"use strict";i("ea15")},ea15:function(t,e,i){}}]);