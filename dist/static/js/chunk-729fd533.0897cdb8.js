(window["webpackJsonp_datastudio-web"]=window["webpackJsonp_datastudio-web"]||[]).push([["chunk-729fd533"],{"1f53":function(e,a,t){"use strict";t("a2dc")},a235:function(e,a,t){"use strict";t.r(a);var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("el-card",{staticClass:"audit-list box-card-container"},[t("div",{staticClass:"search-condition-wrap"},[t("search-condition",{attrs:{label:"Method"}},[t("el-input",{staticClass:"search-box",attrs:{placeholder:"请选择请求方法",clearable:""},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.search(a)}},model:{value:e.params.type,callback:function(a){e.$set(e.params,"type","string"===typeof a?a.trim():a)},expression:"params.type"}})],1),e._v(" "),t("search-condition",{attrs:{label:"UserId"}},[t("el-input",{staticClass:"search-box",attrs:{placeholder:"请输入用户ID",clearable:""},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.search(a)}},model:{value:e.params.userName,callback:function(a){e.$set(e.params,"userName","string"===typeof a?a.trim():a)},expression:"params.userName"}})],1),e._v(" "),t("search-condition",{attrs:{label:"Path"}},[t("el-input",{staticClass:"search-box",attrs:{placeholder:"请输入路径",clearable:""},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.search(a)}},model:{value:e.params.uri,callback:function(a){e.$set(e.params,"uri","string"===typeof a?a.trim():a)},expression:"params.uri"}})],1),e._v(" "),t("search-condition",{attrs:{label:"Params"}},[t("el-input",{staticClass:"search-box",attrs:{placeholder:"请输入参数",clearable:""},nativeOn:{keyup:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.search(a)}},model:{value:e.params.params,callback:function(a){e.$set(e.params,"params","string"===typeof a?a.trim():a)},expression:"params.params"}})],1),e._v(" "),t("search-condition",{attrs:{label:"Time"}},[t("el-date-picker",{staticClass:"search-box",staticStyle:{width:"360px"},attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"],"picker-options":e.pickerOptions},on:{change:e.changeTime},model:{value:e.timeRange,callback:function(a){e.timeRange=a},expression:"timeRange"}})],1),e._v(" "),t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.search}},[e._v("查询")]),e._v(" "),t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.exportData}},[e._v("导出")])],1),e._v(" "),t("div",{staticClass:"table-wrap"},[t("table-page",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{"table-data":e.data,"column-data":e.columnData,"table-height":"calc(100vh - 230px)",total:e.total,"page-num":e.params.pageNum,"page-size":e.params.pageSize},on:{changePage:e.changePage}})],1)])},s=[],n=t("88c9"),i=t("6041"),o=t("7258");function l(e){return o["b"].get("/ds_task/operate/page",{params:e})}function p(e){return o["b"].get("/ds_task/operate/dump",{params:e})}var c={components:{SearchCondition:n["a"],TablePage:i["a"]},data:function(){var e=this;return{params:{type:"",userName:"",uri:"",params:"",requestStartTime:"",requestEndTime:"",pageNum:1,pageSize:10},timeRange:[],pickerOptions:{disabledDate:function(e){return e.getTime()>new Date(new Date((new Date).toLocaleDateString()).getTime()+864e5-1)}},loading:!1,data:[],columnData:[{prop:"traceId",label:"TraceId",width:"150",tooltip:!0},{prop:"uri",label:"Path",width:"120",tooltip:!0},{prop:"type",label:"Method",width:"80"},{prop:"params",label:"Params",width:"150",longData:!0},{prop:"userName",label:"userId",width:"100"},{prop:"requestTime",label:"requestTime",width:"170",format:function(a){return e.$utils.parseTime(a.requestTime)}},{prop:"responseTime",label:"responseTime",width:"170",format:function(a){return e.$utils.parseTime(a.responseTime)}},{prop:"costTime",label:"costTime",width:"100"},{prop:"resultCode",label:"code",width:"80"},{prop:"resultMessage",label:"message",width:"120",tooltip:!0},{prop:"resultData",label:"data",width:"200",longData:!0}],total:0}},created:function(){this.init()},methods:{init:function(){this.getList()},getList:function(){var e=this;this.loading=!0,Object.keys(this.params).forEach((function(a){e.params[a]||delete e.params[a]})),l(this.params).then((function(a){var t=a.data;e.data=t.list,e.total=t.total})).finally((function(){e.loading=!1}))},reset:function(){this.params={type:"",userName:"",requestStartTime:"",requestEndTime:"",pageNum:1,pageSize:10},this.timeRange=[],this.getList()},search:function(){this.params.pageNum=1,this.getList()},exportData:function(){var e=this;p(this.params).then((function(a){var t=a.data;e.download(t)}))},download:function(e){var a=this;Promise.all([t.e("chunk-ce0ae100"),t.e("chunk-02cb73e9")]).then(t.bind(null,"05f2")).then((function(t){var r=["TraceId","Path","Methods","Params","UserId","requestTime","responseTime","costTime","code","message","data"],s=[{name:"traceId"},{name:"uri"},{name:"type"},{name:"params"},{name:"userName"},{name:"requestTime",isFormat:!0},{name:"responseTime",isFormat:!0},{name:"costTime"},{name:"resultCode"},{name:"resultMessage"},{name:"resultData"}],n=a.formatJson(s,e);t.export_json_to_excel({header:r,data:n,filename:"模板"})}))},formatJson:function(e,a){var t=this;return a.map((function(a){return e.map((function(e){return e.isFormat?t.$utils.parseTime(a[e.name]):a[e.name]}))}))},changePage:function(e){this.params.pageSize=e.pageSize,this.params.pageNum=e.pageNum,this.getList()},changeTime:function(e){this.params.requestStartTime=e[0],this.params.requestEndTime=e[1]}}},m=c,u=(t("1f53"),t("2877")),d=Object(u["a"])(m,r,s,!1,null,"73799d4e",null);a["default"]=d.exports},a2dc:function(e,a,t){}}]);