(window["webpackJsonp_datastudio-web"]=window["webpackJsonp_datastudio-web"]||[]).push([["chunk-1a7b8402"],{"27c2":function(t,e,n){},"5edf":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-card",{staticClass:"tenant-list box-card-container"},[n("div",{staticClass:"search-condition-wrap"},[n("search-condition",{attrs:{label:"组织架构名称"}},[n("el-input",{staticClass:"search-box",attrs:{placeholder:"请输入组织架构名称",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.search(e)}},model:{value:t.params.name,callback:function(e){t.$set(t.params,"name","string"===typeof e?e.trim():e)},expression:"params.name"}})],1),t._v(" "),n("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.getList}},[t._v("查询")]),t._v(" "),n("el-button",{staticClass:"create",attrs:{type:"primary"},on:{click:function(e){return t.addAndEdit("new")}}},[t._v("新建")])],1),t._v(" "),n("div",{staticClass:"table-wrap"},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"table",attrs:{data:t.tableData,"highlight-current-row":"","row-key":"id",border:"",lazy:"",load:t.load,"tree-props":{children:"children",hasChildren:"hasChildren"}},on:{"expand-change":t.expandChange}},[n("el-table-column",{attrs:{label:"组织架构名称",prop:"name",align:"left","min-width":"150px",fixed:"","show-overflow-tooltip":""}}),t._v(" "),n("el-table-column",{attrs:{label:"组织架构描述",prop:"description",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{label:"创建人",prop:"createBy",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{label:"负责人",prop:"director",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{label:"创建时间",prop:"createTime",align:"center","min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(t.getTime(e.row.createTime))+"\n        ")]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作人",prop:"createBy",align:"center"}}),t._v(" "),n("el-table-column",{attrs:{prop:"address",label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.addAndEdit("edit",e)}}},[t._v("编辑")]),t._v(" "),n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.addAndEdit("addItem",e)}}},[t._v("新建子组织")]),t._v(" "),n("el-popconfirm",{attrs:{"confirm-button-text":"确定","cancel-button-text":"取消",icon:"el-icon-info",title:"确定删除此组织架构？"},on:{confirm:function(n){return t.deleteItem(e)}}},[n("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[t._v("删除")])],1)]}}])})],1)],1),t._v(" "),n("add-edit-group",{attrs:{"dialog-data":t.dialogData},on:{updateList:t.updateList}})],1)},a=[],o=n("7e3c"),i=n("88c9"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("el-dialog",{staticClass:"custom-dialog",attrs:{title:"edit"===t.dialogData.type?"编辑组织架构":"新建组织",visible:t.dialogData.dialogVisible,width:"600px","close-on-click-modal":!1},on:{"update:visible":function(e){return t.$set(t.dialogData,"dialogVisible",e)}}},[n("el-form",{ref:"ruleForm",attrs:{model:t.ruleForm,rules:t.rules,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"组织名称",prop:"name"}},[n("el-input",{attrs:{placeholder:"请输入组织名称"},model:{value:t.ruleForm.name,callback:function(e){t.$set(t.ruleForm,"name",e)},expression:"ruleForm.name"}})],1),t._v(" "),n("el-form-item",{attrs:{label:"负责人",prop:"director"}},[n("el-select",{staticClass:"search-input",attrs:{placeholder:"请输入负责人，支持模糊搜索用户列表",size:"small",clearable:"",filterable:"",remote:"","allow-create":"","default-first-option":"","remote-method":t.remoteMethod,loading:t.ownerLoading,"popper-class":"custom-popper"},model:{value:t.ruleForm.director,callback:function(e){t.$set(t.ruleForm,"director",e)},expression:"ruleForm.director"}},t._l(t.ownerList,(function(e){return n("el-option",{key:e.shareId,attrs:{value:e.shareId,label:e.name}},[n("div",{staticStyle:{"max-width":"420px","word-break":"break-all"}},[t._v("("+t._s(e.staffId)+")-"+t._s(e.name)+t._s(e.deptFullPath?"-"+e.deptFullPath:""))])])})),1)],1),t._v(" "),n("el-form-item",{attrs:{label:"组织描述"}},[n("el-input",{attrs:{placeholder:"请输入组织描述",type:"textarea"},model:{value:t.ruleForm.description,callback:function(e){t.$set(t.ruleForm,"description",e)},expression:"ruleForm.description"}})],1)],1),t._v(" "),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.dialogData.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{type:"primary",loading:t.btnDisabled},on:{click:t.save}},[t._v("确 定")])],1)],1)},u=[],l=n("b199"),c=n("2f62");function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function p(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(Object(n),!0).forEach((function(e){b(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function b(t,e,n){return e=m(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m(t){var e=g(t,"string");return"symbol"===d(e)?e:String(e)}function g(t,e){if("object"!==d(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var h={name:"WinAddGroup",props:{dialogData:{type:Object,default:function(){}}},data:function(){return{ownerLoading:!1,ownerList:[],ruleForm:{name:"",director:"",description:""},rules:{name:[{required:!0,message:"请输入组织名称",trigger:["change","blur"]}]},btnDisabled:!1}},computed:p({},Object(c["c"])(["userInfo"])),watch:{"dialogData.dialogVisible":function(t){t&&("edit"===this.dialogData.type?(this.ruleForm.tenantId="",this.ruleForm.parentId="",this.ruleForm.id=this.dialogData.tableRow.id,this.ruleForm.name=this.dialogData.tableRow.name,this.ruleForm.director=this.dialogData.tableRow.director,this.ruleForm.description=this.dialogData.tableRow.description):(this.ruleForm.tenantId=this.dialogData.tableRow?this.dialogData.tableRow.tenantId:this.userInfo.tenantId,this.ruleForm.parentId=this.dialogData.tableRow?this.dialogData.tableRow.id:null,this.ruleForm.id="",this.ruleForm.name="",this.ruleForm.director="",this.ruleForm.description=""))}},methods:{remoteMethod:function(t){var e=this;""!==t?(this.ownerLoading=!0,Object(l["Y"])(t).then((function(t){e.ownerLoading=!1;var n=t.data;e.ownerList=n}))):this.ownerList=[]},save:function(){var t=this;this.$refs.ruleForm.validate((function(e){var n;e&&(t.btnDisabled=!0,n="edit"===t.dialogData.type?Object(o["G"])(t.ruleForm):Object(o["c"])(t.ruleForm),n.then((function(e){var n=e.data;t.dialogData.dialogVisible=!1,t.$message({type:"success",message:"edit"===t.dialogData.type?"编辑成功":"新建成功"}),"edit"===t.dialogData.type?(t.dialogData.tableRow.name=t.ruleForm.name,t.dialogData.tableRow.director=t.ruleForm.director,t.dialogData.tableRow.description=t.ruleForm.description):t.$emit("updateList",n)})).finally((function(){t.btnDisabled=!1})))}))}}},k=h,y=(n("c18b"),n("2877")),v=Object(y["a"])(k,s,u,!1,null,"3a98bee4",null),_=v.exports,w=n("ed08");n("54b3");function D(t){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D(t)}function O(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function j(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?O(Object(n),!0).forEach((function(e){F(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function F(t,e,n){return e=S(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function S(t){var e=x(t,"string");return"symbol"===D(e)?e:String(e)}function x(t,e){if("object"!==D(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==D(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var I={components:{SearchCondition:i["a"],addEditGroup:_},data:function(){return{dialogData:{dialogVisible:!1},loading:!1,tableData:[],rowArr:[],total:0,params:{name:"",pageNum:1,pageSize:1e3}}},computed:j({},Object(c["c"])(["userInfo"])),created:function(){this.getList()},methods:{getTime:function(t){return Object(w["parseTime"])(t,"{y}-{m}-{d} {h}:{i}:{s}")},getList:function(){var t=this;this.loading=!0;var e=Object.assign({},this.params,{userId:this.userInfo.id,tenantId:this.userInfo.tenantId});Object(o["k"])(e).then((function(e){var n=e.data;t.loading=!1,t.total=n.total,t.tableData=n.list})).catch((function(){t.loading=!1}))},load:function(t,e,n){var r=t.id,a=t.hierarchy;t.resolve=n;var i=this.rowArr.find((function(e){return e.id===t.id}));i||this.rowArr.push(t),Object(o["e"])({id:r,hierarchy:a}).then((function(t){n(t.data)}))},expandChange:function(t,e){t.expanded=e},addAndEdit:function(t,e){var n=this;this.dialogData.dialogVisible=!0,this.dialogData.type=t,e&&(this.dialogData.tableRow=e.row,this.rowArr.map((function(t){t.id===n.dialogData.tableRow.id&&(n.dialogData.tableRow.expanded=t.expanded,n.dialogData.tableRow.resolve=t.resolve)})))},updateList:function(t){"new"===this.dialogData.type?this.tableData.push(t):"addItem"===this.dialogData.type&&(this.dialogData.tableRow.expanded?this.load(this.dialogData.tableRow,{},this.dialogData.tableRow.resolve):this.$refs.table.store.loadOrToggle(this.dialogData.tableRow))},deleteItem:function(t){var e=this;Object(o["f"])({id:t.row.id}).then((function(n){e.$message({type:"success",message:"删除成功!"}),t.row.parentId?e.rowArr.map((function(n){n.id===t.row.parentId&&(1===e.$refs.table.store.states.lazyTreeNodeMap[t.row.parentId].length?e.$refs.table.store.loadOrToggle(n):e.load(n,{},n.resolve))})):e.tableData.splice(t.$index,1)}))}}},P=I,C=(n("c6e8"),Object(y["a"])(P,r,a,!1,null,"d6a853ec",null));e["default"]=C.exports},"71af":function(t,e,n){},b199:function(t,e,n){"use strict";n.d(e,"y",(function(){return o})),n.d(e,"W",(function(){return i})),n.d(e,"E",(function(){return s})),n.d(e,"p",(function(){return u})),n.d(e,"ab",(function(){return l})),n.d(e,"s",(function(){return c})),n.d(e,"r",(function(){return d})),n.d(e,"t",(function(){return f})),n.d(e,"Q",(function(){return p})),n.d(e,"T",(function(){return b})),n.d(e,"A",(function(){return m})),n.d(e,"O",(function(){return g})),n.d(e,"B",(function(){return h})),n.d(e,"q",(function(){return k})),n.d(e,"e",(function(){return y})),n.d(e,"g",(function(){return v})),n.d(e,"d",(function(){return _})),n.d(e,"ib",(function(){return w})),n.d(e,"n",(function(){return D})),n.d(e,"Y",(function(){return O})),n.d(e,"I",(function(){return j})),n.d(e,"H",(function(){return F})),n.d(e,"c",(function(){return S})),n.d(e,"hb",(function(){return x})),n.d(e,"m",(function(){return I})),n.d(e,"j",(function(){return P})),n.d(e,"f",(function(){return C})),n.d(e,"bb",(function(){return R})),n.d(e,"J",(function(){return L})),n.d(e,"F",(function(){return T})),n.d(e,"h",(function(){return E})),n.d(e,"db",(function(){return A})),n.d(e,"z",(function(){return $})),n.d(e,"R",(function(){return V})),n.d(e,"u",(function(){return z})),n.d(e,"D",(function(){return N})),n.d(e,"P",(function(){return q})),n.d(e,"w",(function(){return B})),n.d(e,"Z",(function(){return G})),n.d(e,"C",(function(){return M})),n.d(e,"eb",(function(){return J})),n.d(e,"a",(function(){return W})),n.d(e,"fb",(function(){return Y})),n.d(e,"cb",(function(){return H})),n.d(e,"G",(function(){return K})),n.d(e,"U",(function(){return Q})),n.d(e,"i",(function(){return U})),n.d(e,"k",(function(){return X})),n.d(e,"K",(function(){return Z})),n.d(e,"L",(function(){return tt})),n.d(e,"N",(function(){return et})),n.d(e,"M",(function(){return nt})),n.d(e,"b",(function(){return rt})),n.d(e,"l",(function(){return at})),n.d(e,"o",(function(){return ot})),n.d(e,"S",(function(){return it})),n.d(e,"gb",(function(){return st})),n.d(e,"X",(function(){return ut})),n.d(e,"v",(function(){return lt})),n.d(e,"V",(function(){return ct}));var r=n("7258"),a="/ds_task/task";function o(t){return r["b"].post("/ds_task/metadata/search",t,{timeout:12e4})}function i(){return r["b"].get("/ds_task/sysdict/getTemplateList")}function s(t){return r["b"].get("/ds_task/dict/list",{params:t})}function u(t){return r["b"].get("/ds_task/artifact/list",{params:t})}function l(t){return r["b"].get("/ds_task/artifactversion/list",{params:t})}function c(t){return r["b"].get("/ds_task/flinkcluster/list",{params:t})}function d(t){return r["b"].get("/ds_task/flinkcluster/auto",{params:t})}function f(t){return r["b"].get("/ds_task/flinkcluster/noauto",{params:t})}function p(t){return r["b"].get("".concat(a,"/get"),{params:t})}function b(t){return r["b"].get("".concat(a,"/page"),{params:t,timeout:6e4})}function m(t){return r["b"].post("/ds_task/metadata/getddl",t)}function g(t){return r["b"].get("".concat(a,"/getInsertSql"),{params:t,timeout:6e5})}function h(t){return r["b"].post("/ds_task/metadata/getdispalyddl",t)}function k(t){return r["b"].get("".concat(a,"/getChildDependencies"),{params:{id:t}})}function y(t){return r["b"].get("".concat(a,"/backfill"),{params:t})}function v(t){return r["b"].put("".concat(a,"/onlineAndOffline"),null,{params:t})}function _(t){return r["b"].post("".concat(a,"/add"),t)}function w(t){return r["b"].put("".concat(a,"/update"),t)}function D(t){return r["b"].delete("".concat(a,"/new/delete"),{params:t})}function O(t){return r["b"].get("/ds_task/user/list",{params:{name:t}})}function j(t){return r["b"].get("/ds_task/label/list",{params:{name:t}})}function F(t){return r["b"].get("/ds_task/label/get",{params:{id:t}})}function S(t){return r["b"].post("/ds_task/label/add",t)}function x(t){return r["b"].put("/ds_task/label/update",t)}function I(t){return r["b"].delete("/ds_task/label/delete",{params:{id:t}})}function P(t){return r["b"].patch("/ds_task/collect/add",null,{params:t})}function C(t){return r["b"].get("/ds_task/collect/cancel",{params:t})}function R(t){return r["b"].get("/ds_task/collect/my",{params:t})}function L(t){return r["b"].get("/ds_task/task/listforlabel",{params:{name:t}})}function T(t){return r["b"].get("/ds_task/task/iam",{params:t})}function E(t){return r["b"].post("/ds_task/task/check",t,{timeout:18e4})}function A(t){return r["b"].get("/ds_task/task/name/search",{params:{name:t}})}function $(t){return r["b"].get("/ds_task/task/backfillDateDetail",{params:t})}function V(t){return r["b"].get("/ds_task/task/last7",{params:t})}function z(t){return r["b"].get("/ds_task/user/getEffectiveCostList",{params:{name:t}})}function N(t){return r["b"].get("/ds_task/task/getGitSqlFile",{params:t})}function q(t){return r["b"].post("/ds_task/task/sqlTbls",t,{headers:{"Content-Type":"multipart/form-data"}})}function B(t){return r["b"].post("/ds_task/task/getCrontab",t)}function G(t){return r["b"].get("/ds_task/taskversion/pages",{params:t})}function M(){return r["b"].get("/ds_task/auditlog/type?module=task")}function J(t){return r["b"].get("/ds_task/taskversion/verionSwitch",{params:t})}function W(t){return r["b"].post("/ds_task/task/addAndStart",t)}function Y(t){return r["b"].post("/ds_task/task/updateAndStart",t)}function H(t){return r["b"].post("/ds_task/task/date/preview",t)}function K(t){return r["b"].post("/ds_task/task/mergeSmallFiles/jars",t)}function Q(t){return r["b"].post("/ds_task/task/getTasks",t)}function U(t){return r["b"].post("/ds_task/task/checkPath",t,{headers:{"Content-Type":"multipart/form-data"}})}function X(t){return r["b"].post("/ds_task/task/fastBackfill?taskId="+t.taskId,t)}function Z(t){return r["b"].get("/ds_task/task/renderContent",{params:t})}function tt(t){return r["b"].post("/ds_task/metadata/preview",t)}function et(t){return r["b"].get("/ds_task/actor/sources/page",{params:t})}function nt(t){return r["b"].get("/ds_task/taskfolder/listFolder",{params:t})}function rt(t){return r["b"].post("/ds_task/taskfolder/saveFolder",t)}function at(t){return r["b"].get("/ds_task/taskfolder/deleteFolder",{params:t})}function ot(t){return r["b"].post("/ds_task/taskfolder/editFolder",t)}function it(t){return r["b"].get("/ds_task/taskfolder/listTask",{params:t})}function st(t){return r["b"].post("/ds_task/taskfolder/updateTask",t)}function ut(t){return r["b"].get("/ds_task/wechatAlert/listById?id=".concat(t))}function lt(t){return r["b"].post("/pipeline/cron/get",t)}function ct(t){return r["b"].get("/ds_task/task/templateRendering",{params:t})}},c18b:function(t,e,n){"use strict";n("27c2")},c6e8:function(t,e,n){"use strict";n("71af")}}]);