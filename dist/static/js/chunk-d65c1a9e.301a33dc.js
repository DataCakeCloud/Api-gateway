(window["webpackJsonp_datastudio-web"]=window["webpackJsonp_datastudio-web"]||[]).push([["chunk-d65c1a9e"],{"19c7":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-card",{class:["left-tree","transition",e.isOpen?"":"close"]},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e.isOpen?n("span",[e._v("成本中心")]):e._e(),e._v(" "),n("span",{class:[e.isOpen?"el-icon-s-unfold":"el-icon-s-fold","close-btn","transition"],on:{click:e.handleOpen}})]),e._v(" "),n("ul",{class:["list",{"no-text":!e.isOpen}]},[e._l(e.list,(function(t,i){return[t.permission?n("li",{key:i,class:["item",{active:e.$route.name===t.name}],on:{click:function(n){return e.handleLink(t)}}},[n("svg-icon",{attrs:{"icon-class":t.icon}}),e._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:e.isOpen&&t.show,expression:"isOpen && item.show"}],staticClass:"text"},[e._v(e._s(t.text))])],1):e._e()]}))],2)])},s=[],a={name:"LeftTree",data:function(){return{isOpen:null===window.sessionStorage.getItem("costLeftTreeOpen")||JSON.parse(window.sessionStorage.getItem("costLeftTreeOpen")),list:[{name:"NewCostCenter",text:"首页",icon:"cost",show:!0,permission:!0},{name:"NewCostAnalysis",text:"成本分析",icon:"analysis",show:!0,permission:!0},{name:"NewCostBill",text:"账单",icon:"bill",show:!0,permission:!0},{name:"NewCostReport",text:"报告管理",icon:"report",show:!0,permission:!0},{name:"group",text:"业务架构配置",icon:"group",show:!0,permission:!0}]}},created:function(){},methods:{handleOpen:function(){var e=this;if(this.isOpen=!this.isOpen,this.isOpen)var t=setTimeout((function(n){e.list.forEach((function(e){e.show=!0})),clearTimeout(t)}),150);else this.list.forEach((function(e){e.show=!1}));window.sessionStorage.setItem("costLeftTreeOpen",this.isOpen)},handleLink:function(e){this.$router.push({name:e.name})}}},o=a,l=(n("669f"),n("2877")),r=Object(l["a"])(o,i,s,!1,null,"077742c5",null);t["a"]=r.exports},"405f":function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return r})),n.d(t,"f",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return p}));var i=n("7258");function s(e){return i["b"].post("/cost/home/request",e)}function a(e){return i["b"].post("/cost/listDictionary",e)}function o(e){return i["b"].post("/cost/report/del",e)}function l(e){return i["b"].post("/cost/report/save",e)}function r(e){return i["b"].post("/cost/report/saveAs",e)}function c(e){return i["b"].post("/cost/report/list",e)}function u(e){return i["b"].post("/cost/report/getById",e)}function p(e){return i["b"].post("/cost/report/history",e)}},"628f":function(e,t,n){},"669f":function(e,t,n){"use strict";n("7afd")},"76bd":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-card",{staticClass:"box-card-container"},[n("div",{staticClass:"box-content"},[n("LeftTree"),e._v(" "),n("div",{staticClass:"box-r"},[n("div",{staticClass:"r-t"},[n("el-form",{attrs:{inline:!0,model:e.params,"label-position":"left","label-width":"80px"}},[n("el-form-item",{attrs:{prop:"lessee",label:"报告名称"}},[n("el-input",{attrs:{placeholder:"请输入用户组名称"},model:{value:e.params.name,callback:function(t){e.$set(e.params,"name",t)},expression:"params.name"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary"}},[e._v("查询")])],1)],1)],1),e._v(" "),n("Table",{attrs:{body:e.body,loading:e.loading,params:e.params},on:{handleSizeChange:e.handleSizeChange,handleCurrentChange:e.handleCurrentChange,updateMultipleSelection:e.updateMultipleSelection,updateList:e.getReportList}})],1)],1)])},s=[],a=(n("ed08"),n("405f")),o=n("19c7"),l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e.body.length||e.loading?[e.multipleSelections.length?n("div",{staticClass:"ope-box"},[n("el-button",{attrs:{icon:"el-icon-delete",type:"text",loading:e.deleteLoading},on:{click:e.handleDelete}},[e._v("删除")]),e._v(" "),n("el-popover",{attrs:{placement:"top",width:"240"},model:{value:e.saveAsvisible,callback:function(t){e.saveAsvisible=t},expression:"saveAsvisible"}},[n("el-input",{attrs:{placeholder:"请输入报告名称"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}}),e._v(" "),n("div",{staticStyle:{"text-align":"right",margin:"10px 0 0 0"}},[n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(t){e.saveAsvisible=!1}}},[e._v("取消")]),e._v(" "),n("el-button",{attrs:{disabled:!e.name.length||e.saveAsLoading,loading:e.saveAsLoading,type:"primary",size:"mini"},on:{click:e.handleSaveAsConfirm}},[e._v("确定")])],1),e._v(" "),n("el-button",{attrs:{slot:"reference",icon:"el-icon-document-copy",type:"text"},slot:"reference"},[e._v("另存为")])],1)],1):e._e(),e._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.body,"highlight-current-row":"",border:"",height:"calc(100vh - 185px)"},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),n("el-table-column",{attrs:{label:"报告名称",prop:"name",align:"left","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("a",{staticClass:"cell-ellipsis",attrs:{href:"javascript:;"},on:{click:function(n){return e.handleLink(t.row)}}},[e._v(e._s(t.row.name))])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"创建人",prop:"createUser",align:"center","show-overflow-tooltip":""}}),e._v(" "),n("el-table-column",{attrs:{label:"创建时间",prop:"createTime",align:"center","min-width":"100"}}),e._v(" "),n("el-table-column",{attrs:{label:"账单日期",prop:"updateTime",align:"center","min-width":"100"}}),e._v(" "),n("el-table-column",{attrs:{label:"时间范围",prop:"timeRange",align:"center","min-width":"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e.getTimeRangeText(t.row.timeRange))+"\n        ")]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"时间粒度",prop:"dt",align:"center","min-width":"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e.getDateTypeText(t.row.dtType))+"\n        ")]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"分组依据",prop:"queryGroup",align:"center","min-width":"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(e.getQueryGroupText(t.row.queryGroup))+"\n        ")]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"筛选条件",prop:"filterStr",align:"center","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-tooltip",{attrs:{slot:"label",effect:"dark",content:t.row.filterStr,placement:"top"},slot:"label"},[n("div",{staticClass:"cell-ellipsis"},[e._v(e._s(t.row.filterStr))])])]}}])})],1),e._v(" "),n("el-pagination",{attrs:{"current-page":e.params.page,"page-sizes":[10,20,30,40],"page-size":e.params.limit,layout:"total, sizes, prev, pager, next, jumper",total:e.params.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})]:n("el-empty",{attrs:{description:"暂无数据"}})],2)},r=[],c={name:"",props:{body:{type:Array,default:function(){return[]}},loading:Boolean,params:{type:Object,default:function(){}}},data:function(){return{shortcuts:this.$t("cost.shortcuts"),dateTypeList:this.$t("cost.dateTypeList"),filterList:this.$t("cost.filterList"),multipleSelections:[],deleteLoading:!1,saveAsvisible:!1,saveAsLoading:!1,name:""}},methods:{getTimeRangeText:function(e){return this.shortcuts.find((function(t){return t.id===e}))["text"]},getDateTypeText:function(e){return this.dateTypeList.find((function(t){return t.value===e}))["name"]},getQueryGroupText:function(e){var t=this.filterList.find((function(t){return t.value===e}));if(t)return Object.keys(t).length&&t["name"]},handleSizeChange:function(e){this.$emit("handleSizeChange",e)},handleCurrentChange:function(e){this.$emit("handleCurrentChange",e)},handleSelectionChange:function(e){this.$emit("updateMultipleSelection",e),this.multipleSelections=e},handleSaveAsConfirm:function(){var e=this;if(this.multipleSelections.length>1)this.message({type:"warning",message:"另存为报告只能选择一项，请重新选择"});else{this.saveAsLoading=!0;var t={name:this.name,topParams:this.multipleSelections[0].topParams,queryGroup:this.multipleSelections[0].queryGroup,sideFilter:this.multipleSelections[0].sideFilter,timeRange:this.multipleSelections[0].timeRange,dtType:this.multipleSelections[0].dtType,filterStr:this.multipleSelections[0].filterStr};Object(a["h"])(t).then((function(t){e.saveAsLoading=!1,0===t.code&&(e.$message({type:"success",message:"另存为报告成功"}),e.$emit("updateList"))}))}},handleDelete:function(){var e=this;this.deleteLoading=!0;var t=this.multipleSelections.map((function(e){return e.id}));Object(a["c"])({ids:t}).then((function(t){e.deleteLoading=!1,e.$message({type:"success",message:"删除成功"}),e.$emit("updateList")}))},handleLink:function(e){this.$router.push({name:"NewCostAnalysis",query:{id:e.id}})}}},u=c,p=n("2877"),d=Object(p["a"])(u,l,r,!1,null,null,null),m=d.exports,h={name:"CostCenter",components:{LeftTree:o["a"],Table:m},data:function(){return{params:{name:"",page:1,limit:10,total:0},loading:!1,body:[],multipleSelection:[]}},created:function(){this.getReportList()},methods:{getReportList:function(){var e=this;this.loading=!0,Object(a["f"])(this.params).then((function(t){e.loading=!1,e.body=t.data,e.params.page=t.page,e.params.limit=t.limit,e.params.total=t.total}))},handleSizeChange:function(e){this.params.limit=e,this.getReportList()},handleCurrentChange:function(e){this.params.page=e,this.getReportList()},updateMultipleSelection:function(e){this.multipleSelection=e}}},f=h,g=(n("f41a"),Object(p["a"])(f,i,s,!1,null,"426a2530",null));t["default"]=g.exports},"7afd":function(e,t,n){},f41a:function(e,t,n){"use strict";n("628f")}}]);